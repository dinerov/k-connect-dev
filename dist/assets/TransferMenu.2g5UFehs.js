import{r as T,a as B,b as G,j as e,s,i as a,d as y,Q as le,R as Ge,U as q,g as K,D as Q,T as n,w as $,o as de,V as Ht,E as _e,H as ce,P as ee,k as te,L as Lt,l as U,O as X,J as Ke,af as Qe,A as et,K as Et,v as Dt,t as tt,m as re,F as $t,aE as Nt,a7 as ae,ap as rt,S as J,C as Vt,p as Ut,q as Jt,bo as E,I as at}from"./vendor-mui.08p3AH88.js";import{r as p,L as Yt,a as Te}from"./vendor-router.BRqU_Zs2.js";import{V as it}from"./thumbnails.CEJMDkxh.js";import{r as H,T as Be,b as ie,h as ot,L as qt}from"./index.CdVNWeFt.js";import{C as We}from"./Close.BG2YHWMj.js";import{H as Xt}from"./History.BL_2VNvs.js";import{g as L}from"./vendor-react.DF-_cTkv.js";import{a as oe}from"./vendor.CL98q8z6.js";import{a as Zt}from"./dateUtils.JaLtthGQ.js";import{D as He}from"./Delete.C47j6PO2.js";import{S as Gt}from"./Save.D4JlNQm5.js";import{M as Kt}from"./MoreVert.C0-1U5Ci.js";import{P as Qt}from"./Person.B_G_dVGx.js";import{S as nt}from"./Send.DjUSpM3V.js";var st,pe={};function er(){if(st)return pe;st=1;var t=T();Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var r=t(H()),i=B();return pe.default=(0,r.default)((0,i.jsx)("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99zM21 9l-3.99-4v3H10v2h7.01v3z"}),"SwapHoriz"),pe}const tr=L(er()),rr=s(a)(({theme:t})=>({position:"fixed",zIndex:1e3,backgroundColor:t.palette.mode==="light"?y(t.palette.background.paper,.95):t.palette.mode==="contrast"?"#101010":"#1A1A1A",borderRadius:8,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.25)",minWidth:180,padding:"6px 0",overflow:"hidden",animation:"fadeIn 0.15s ease-out",border:t.palette.mode==="light"?"1px solid rgba(0, 0, 0, 0.08)":"1px solid rgba(255, 255, 255, 0.1)","@keyframes fadeIn":{from:{opacity:0,transform:"scale(0.95)"},to:{opacity:1,transform:"scale(1)"}}})),ar=s(a)(({theme:t,disabled:r})=>({display:"flex",alignItems:"center",padding:"8px 16px",cursor:r?"not-allowed":"pointer",transition:"background-color 0.2s",userSelect:"none",color:t.palette.mode==="light"?t.palette.text.primary:"#E6E6E6",opacity:r?.5:1,"&:hover":{backgroundColor:r?"transparent":y(t.palette.primary.main,.12)}})),ir=s(a)(({theme:t})=>({marginRight:10,display:"flex",alignItems:"center",justifyContent:"center",width:22,height:22,color:t.palette.primary.main})),or=s(a)(({theme:t})=>({fontSize:14,color:t.palette.mode==="light"?t.palette.text.primary:"#E6E6E6"})),nr=({items:t,x:r,y:i,show:d,onClose:g})=>{G();const{themeSettings:w}=p.useContext(Be),c=p.useRef(null),[h,z]=p.useState({x:r,y:i});return p.useEffect(()=>{if(d&&c.current){const u=c.current.getBoundingClientRect(),v=window.innerWidth,j=window.innerHeight;let k=r,C=i;r+u.width>v&&(k=v-u.width),i+u.height>j&&(C=j-u.height),z({x:k,y:C})}},[d,r,i]),p.useEffect(()=>{const u=v=>{c.current&&!c.current.contains(v.target)&&g()};return d&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[d,g]),p.useEffect(()=>{const u=v=>{v.key==="Escape"&&g()};return d&&document.addEventListener("keydown",u),()=>{document.removeEventListener("keydown",u)}},[d,g]),d?e.jsx(rr,{ref:c,sx:{left:`${h.x}px`,top:`${h.y}px`},children:t.map(u=>e.jsxs(ar,{disabled:u.disabled,onClick:()=>{u.disabled||(u.onClick(),g())},children:[u.icon&&e.jsx(ir,{children:u.icon}),e.jsx(or,{children:u.label})]},u.id))}):null},lt=s(le)(({theme:t,active:r,isspecial:i,themecolor:d})=>({borderRadius:t.spacing(1.5),marginBottom:t.spacing(.5),padding:t.spacing(.7,1.3),backgroundColor:r?"rgba(255, 255, 255, 0.08)":"transparent",position:"relative",overflow:"hidden",transition:"all 0.25s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{backgroundColor:r?"rgba(255, 255, 255, 0.12)":"rgba(255, 255, 255, 0.05)",transform:"translateX(2px)"},"&::before":{content:'""',position:"absolute",left:0,top:"30%",height:"40%",width:r?"2px":"0px",backgroundColor:i?"#f44336":d||t.palette.primary.main,borderRadius:"0 2px 2px 0",transition:"width 0.2s ease"},"&:hover::before":{width:r?"2px":"1px"},[t.breakpoints.down("lg")]:{padding:t.spacing(.6,1.1),marginBottom:t.spacing(.4)},[t.breakpoints.down("md")]:{padding:t.spacing(.5,1),marginBottom:t.spacing(.3)}})),Le=s(Ge)(({theme:t,active:r,isspecial:i,themecolor:d})=>({minWidth:"32px",color:r?i?"#f44336":d||t.palette.primary.main:t.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)",transition:"all 0.25s ease","& .MuiSvgIcon-root":{fontSize:"1.15rem",transition:"transform 0.25s ease",filter:r?"drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1))":"none"},".MuiListItem-root:hover &":{color:r?i?"#f44336":d||t.palette.primary.main:t.palette.mode==="dark"?"rgba(255, 255, 255, 0.9)":"rgba(0, 0, 0, 0.9)","& .MuiSvgIcon-root":{transform:"scale(1.12)"}},[t.breakpoints.down("lg")]:{minWidth:"30px","& .MuiSvgIcon-root":{fontSize:"1.1rem"}},[t.breakpoints.down("md")]:{minWidth:"26px","& .MuiSvgIcon-root":{fontSize:"1rem"}}})),Ee=s(q)(({theme:t,active:r,isspecial:i,themecolor:d})=>({"& .MuiListItemText-primary":{fontWeight:r?500:400,fontSize:"0.85rem",color:r?i?"#f44336":d||t.palette.primary.main:t.palette.mode==="dark"?"rgba(255, 255, 255, 0.85)":"rgba(0, 0, 0, 0.85)",letterSpacing:r?"0.3px":"0.2px",transition:"all 0.25s ease",textShadow:r?"0 1px 2px rgba(0, 0, 0, 0.1)":"none"},".MuiListItem-root:hover & .MuiListItemText-primary":{letterSpacing:"0.3px"},[t.breakpoints.down("lg")]:{"& .MuiListItemText-primary":{fontSize:"0.8rem",letterSpacing:r?"0.25px":"0.15px"}},[t.breakpoints.down("md")]:{"& .MuiListItemText-primary":{fontSize:"0.75rem"}}})),sr=p.memo(({text:t,icon:r,path:i,active:d=!1,isSpecial:g=!1,themeColor:w,onClick:c,endIcon:h,endIconActive:z,component:u,nested:v=!1,target:j,rel:k,...C})=>{const m=i?{component:Yt,to:i,target:j,rel:k}:{onClick:c},R=v?{pl:2,borderRadius:f=>f.spacing(1.2),marginBottom:f=>f.spacing(.4),padding:f=>f.spacing(.6,1.2,.6,2)}:{};return e.jsx(lt,{button:!0,active:d?1:0,isspecial:g?"true":void 0,themecolor:w,...m,...C,sx:{...R,...C.sx},children:h&&!z?e.jsxs(a,{sx:{display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[r&&e.jsx(Le,{active:d?1:0,isspecial:g?"true":void 0,themecolor:w,children:r}),e.jsx(Ee,{primary:t,active:d?1:0,isspecial:g?"true":void 0,themecolor:w})]}),h]}):e.jsxs(e.Fragment,{children:[r&&e.jsx(Le,{active:d?1:0,isspecial:g?"true":void 0,themecolor:w,children:r}),e.jsx(Ee,{primary:t,active:d?1:0,isspecial:g?"true":void 0,themecolor:w}),h&&z]})})},(t,r)=>t.active===r.active&&t.path===r.path&&t.text===r.text&&t.isSpecial===r.isSpecial),lr=s(lt)(({theme:t,active:r,themecolor:i})=>({justifyContent:"space-between",paddingRight:t.spacing(1.5),marginTop:t.spacing(.5),"& .arrow-icon":{transition:"transform 0.3s ease",transform:r?"rotate(180deg)":"rotate(0deg)",color:r?i||t.palette.primary.main:t.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)"}})),dr=p.memo(({text:t,icon:r,active:i=!1,themeColor:d,onClick:g,arrowIcon:w,arrowUpIcon:c,arrowDownIcon:h,...z})=>{const u=i?c||w:h||w;return e.jsxs(lr,{button:!0,onClick:g,active:i?1:0,themecolor:d,...z,children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Le,{active:i?1:0,themecolor:d,children:r}),e.jsx(Ee,{primary:t,active:i?1:0,themecolor:d})]}),e.jsx(a,{className:"arrow-icon",children:u})]})},(t,r)=>t.active===r.active&&t.text===r.text&&t.onClick===r.onClick);var dt,xe={};function cr(){if(dt)return xe;dt=1;var t=T();Object.defineProperty(xe,"__esModule",{value:!0}),xe.default=void 0;var r=t(H()),i=B();return xe.default=(0,r.default)((0,i.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10h5v-2h-5c-4.34 0-8-3.66-8-8s3.66-8 8-8 8 3.66 8 8v1.43c0 .79-.71 1.57-1.5 1.57s-1.5-.78-1.5-1.57V12c0-2.76-2.24-5-5-5s-5 2.24-5 5 2.24 5 5 5c1.38 0 2.64-.56 3.54-1.47.65.89 1.77 1.47 2.96 1.47 1.97 0 3.5-1.6 3.5-3.57V12c0-5.52-4.48-10-10-10m0 13c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3"}),"AlternateEmail"),xe}const ct=L(cr()),pr=s(_e)(({theme:t})=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:t.spacing(2),background:t.palette.mode==="dark"?`linear-gradient(135deg, ${y("#121212",.9)} 0%, ${y("#1A1A1A",.85)} 100%)`:`linear-gradient(135deg, ${y("#f5f5f5",.9)} 0%, ${y("#FAFAFA",.85)} 100%)`,backdropFilter:"blur(10px)",borderBottom:`1px solid ${t.palette.divider}`})),xr=s(ce)(({theme:t})=>({padding:t.spacing(2),background:t.palette.mode==="dark"?y("#121212",.9):y("#FFFFFF",.9),backdropFilter:"blur(8px)","&::-webkit-scrollbar":{width:"4px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:t.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.2)",borderRadius:"4px"}})),hr=s(ee)(({theme:t})=>({display:"flex",alignItems:"center",padding:t.spacing(1.5),marginBottom:t.spacing(1),borderRadius:t.shape.borderRadius,background:t.palette.mode==="dark"?y(t.palette.background.paper,.4):y(t.palette.background.paper,.7),transition:"transform 0.2s ease",backdropFilter:"blur(4px)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.1)"}})),mr=s(ee)(({theme:t})=>({display:"flex",alignItems:"center",padding:t.spacing(1.5),marginBottom:t.spacing(2),borderRadius:t.shape.borderRadius,background:t.palette.mode==="dark"?y(t.palette.primary.dark,.1):y(t.palette.primary.light,.1),backdropFilter:"blur(4px)",border:`1px solid ${t.palette.mode,y(t.palette.primary.main,.2)}`,transition:"all 0.2s ease","&:hover":{boxShadow:`0 4px 12px ${y(t.palette.primary.main,.15)}`}})),ur=(t,r=15)=>t?t.length>r?t.substring(0,r)+"...":t:"",ne={},Me={};(()=>{try{const t=sessionStorage.getItem("usernameHistoryCache");t&&Object.assign(ne,JSON.parse(t));const r=sessionStorage.getItem("userDataCache");r&&Object.assign(Me,JSON.parse(r))}catch{}})();const gr=({username:t,onClose:r,open:i})=>{const[d,g]=p.useState(!0),[w,c]=p.useState(null),[h,z]=p.useState(null),[u,v]=p.useState({}),j=G(),k=K(j.breakpoints.down("sm"));p.useEffect(()=>{(async()=>{if(i&&t)try{g(!0),z(null);const m=t.toLowerCase(),R=Date.now(),f=3e5;let l;if(ne[m]&&R-ne[m].timestamp<f){l=ne[m].data,c(l);const M={};return l.users&&(Object.keys(l.users).forEach(x=>{Me[x]=l.users[x],M[x]=l.users[x]}),v(M)),void g(!1)}const b=await oe.get(`/api/username/history/${t}`);if(!b.data||!b.data.success)throw new Error(b.data?.message||"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u043E\u0431 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C\u0435");l=b.data.data,c(l),ne[m]={data:l,timestamp:R},l.users&&(Object.keys(l.users).forEach(M=>{Me[M]=l.users[M]}),v(l.users)),(()=>{try{sessionStorage.setItem("usernameHistoryCache",JSON.stringify(ne)),sessionStorage.setItem("userDataCache",JSON.stringify(Me))}catch{}})()}catch{z("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044E \u043E \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C\u0435")}finally{g(!1)}})()},[t,i]);const C=(m,R=!1,f="small")=>{const l=u[m],b=f==="small",M=b?24:36;return l?e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[l.photo?e.jsx(te,{src:l.photo,sx:{width:M,height:M,mr:.5}}):e.jsx(te,{sx:{width:M,height:M,mr:.5,fontSize:b?"0.8rem":"1rem",bgcolor:"primary.main"},children:l.name?.charAt(0)||l.username?.charAt(0)||"?"}),e.jsxs(Lt,{href:`/profile/${m}`,underline:"hover",color:"text.primary",sx:{fontWeight:"medium",display:"flex",alignItems:"center",maxWidth:b?70:120},children:[e.jsx(n,{noWrap:!0,sx:{maxWidth:b?60:100,display:"block",fontSize:b?"0.85rem":"1rem"},children:ur(l.username||l.name,b?10:15)}),l.is_verified&&e.jsx(it,{color:"primary",sx:{ml:.5,fontSize:b?"0.9rem":"1.1rem"}})]})]}):R?e.jsxs(n,{variant:"body2",fontWeight:"medium",children:["\u041F\u0435\u0440\u0432\u043E\u0435 \u043F\u0440\u0438\u043E\u0431\u0440\u0435\u0442\u0435\u043D\u0438\u0435: ID ",m]}):e.jsxs(n,{variant:"body2",fontWeight:"medium",children:["ID ",m]})};return e.jsxs(Q,{open:i,onClose:r,maxWidth:"xs",fullWidth:!0,fullScreen:k,PaperProps:{elevation:24,sx:{borderRadius:k?0:2,overflow:"hidden",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.4)",background:"transparent",maxHeight:k?"100%":"90vh"}},children:[e.jsxs(pr,{children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ct,{sx:{mr:1,color:"primary.main",fontSize:"1.5rem"}}),e.jsxs(n,{variant:"h6",sx:{fontWeight:"bold"},children:["@",t]})]}),e.jsx($,{size:"small",onClick:r,edge:"end",children:e.jsx(We,{fontSize:"small"})})]}),e.jsx(xr,{children:d?e.jsx(a,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(de,{size:30})}):h?e.jsx(n,{color:"error",sx:{p:2},children:h}):e.jsxs(e.Fragment,{children:[w?.current_owner_id&&e.jsxs(mr,{children:[C(w.current_owner_id,!1,"large"),e.jsx(a,{sx:{ml:1},children:e.jsx(n,{variant:"body2",color:"text.secondary",fontSize:"0.75rem",children:"\u0422\u0435\u043A\u0443\u0449\u0438\u0439 \u0432\u043B\u0430\u0434\u0435\u043B\u0435\u0446"})})]}),e.jsx(Ht,{sx:{my:2}}),e.jsxs(n,{variant:"subtitle1",sx:{fontWeight:"medium",mb:1.5,display:"flex",alignItems:"center"},children:[e.jsx(Xt,{sx:{mr:1,fontSize:"1.2rem",color:"primary.main"}}),"\u0418\u0441\u0442\u043E\u0440\u0438\u044F \u0432\u043B\u0430\u0434\u0435\u043D\u0438\u044F"]}),w?.ownership_history?.length>0?e.jsx(a,{sx:{mt:1},children:w.ownership_history.slice().reverse().map((m,R)=>e.jsxs(hr,{elevation:0,children:[e.jsx(tr,{sx:{mr:1.5,color:"primary.main"}}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(a,{sx:{display:"flex",alignItems:"center"},children:m.seller_id?e.jsxs(e.Fragment,{children:[C(m.seller_id),e.jsx(n,{sx:{mx:.5},children:"\u2192"}),C(m.buyer_id)]}):C(m.buyer_id,!0)}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(n,{variant:"caption",color:"text.secondary",children:Zt(m.timestamp)}),e.jsxs(n,{variant:"caption",sx:{fontWeight:"bold",color:"primary.main"},children:[m.price," \u0431\u0430\u043B\u043B\u043E\u0432"]})]})]})]},R))}):e.jsx(n,{variant:"body2",color:"text.secondary",sx:{p:1,textAlign:"center"},children:"\u0418\u0441\u0442\u043E\u0440\u0438\u044F \u0432\u043B\u0430\u0434\u0435\u043D\u0438\u044F \u043D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u043D\u0430"})]})})]})};var pt,he={};function br(){if(pt)return he;pt=1;var t=T();Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var r=t(H()),i=B();return he.default=(0,r.default)((0,i.jsx)("path",{d:"M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1m-1 9h-4v-7h4z"}),"Devices"),he}const xt=L(br());var ht,me={};function fr(){if(ht)return me;ht=1;var t=T();Object.defineProperty(me,"__esModule",{value:!0}),me.default=void 0;var r=t(H()),i=B();return me.default=(0,r.default)((0,i.jsx)("path",{d:"M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2zM4 6h16v10H4z"}),"Computer"),me}const vr=L(fr());var mt,ue={};function jr(){if(mt)return ue;mt=1;var t=T();Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=void 0;var r=t(H()),i=B();return ue.default=(0,r.default)((0,i.jsx)("path",{d:"M16 1H8C6.34 1 5 2.34 5 4v16c0 1.66 1.34 3 3 3h8c1.66 0 3-1.34 3-3V4c0-1.66-1.34-3-3-3m-2 20h-4v-1h4zm3.25-3H6.75V4h10.5z"}),"PhoneAndroid"),ue}const yr=L(jr());var ut,ge={};function wr(){if(ut)return ge;ut=1;var t=T();Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=void 0;var r=t(H()),i=B();return ge.default=(0,r.default)((0,i.jsx)("path",{d:"M20 18c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2zM4 6h16v10H4z"}),"Laptop"),ge}const kr=L(wr());var gt,be={};function Cr(){if(gt)return be;gt=1;var t=T();Object.defineProperty(be,"__esModule",{value:!0}),be.default=void 0;var r=t(H()),i=B();return be.default=(0,r.default)((0,i.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"ReportProblem"),be}const bt=L(Cr());oe.defaults.headers.delete["Content-Type"]="application/json";const Sr=Te.forwardRef(function(t,r){return e.jsx(Et,{direction:"up",ref:r,...t})}),ft=t=>{const r={color:"#d0bcff",filter:"drop-shadow(0px 0px 3px rgba(208, 188, 255, 0.3))"};switch(t.toLowerCase()){case"android":case"ios":return e.jsx(yr,{style:r});case"mac os":return e.jsx(kr,{style:r});case"windows":case"linux":return e.jsx(vr,{style:r});default:return e.jsx(xt,{style:r})}},Ir=t=>{if(!t||t==="\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E")return"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E";try{let r;if(t.includes("T")||t.includes("Z"))r=new Date(t);else if(t.includes(".")){const[h,z]=t.split(" "),[u,v,j]=h.split(".");r=new Date(`${j}-${v}-${u}T${z}Z`)}else r=new Date(t);const i=new Date-r,d=Math.floor(i/6e4),g=Math.floor(d/60),w=Math.floor(g/24);if(d<1)return"\u0422\u043E\u043B\u044C\u043A\u043E \u0447\u0442\u043E";if(d<60)return`${d} \u043C\u0438\u043D. \u043D\u0430\u0437\u0430\u0434`;if(g<24)return`${g} \u0447. \u043D\u0430\u0437\u0430\u0434`;if(w<7)return`${w} \u0434\u043D. \u043D\u0430\u0437\u0430\u0434`;const c={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return r.toLocaleString("ru-RU",c)}catch{return t}},zr=({open:t,onClose:r})=>{const i=G(),d=K(i.breakpoints.down("sm")),[g,w]=p.useState([]),[c,h]=p.useState(!1),[z,u]=p.useState(null),[v,j]=p.useState({open:!1,message:"",severity:"success"}),[k,C]=p.useState({open:!1,sessionId:null}),m=async()=>{h(!0),u(null);try{const l=await oe.get("/api/auth/sessions");l.data.success?w(l.data.sessions||[]):u(l.data.error||"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0441\u0435\u0441\u0441\u0438\u0438")}catch(l){u(l.response?.data?.error||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0441\u0435\u0441\u0441\u0438\u0439")}finally{h(!1)}};p.useEffect(()=>{t&&m()},[t]);const R=()=>{j({...v,open:!1})},f=g.find(l=>l.is_current);return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{open:t,TransitionComponent:Sr,keepMounted:!0,onClose:r,maxWidth:"sm",fullWidth:!0,fullScreen:d,PaperProps:{style:{borderRadius:d?0:16,backgroundColor:"#0A0A0A",color:"#fff",width:"100%",maxWidth:d?"100%":"600px"}},children:[e.jsxs(_e,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #222",backgroundColor:"#0F0F0F",py:2,px:d?2:3},children:[e.jsx(n,{variant:"h6",children:"\u041C\u043E\u0438 \u0441\u0435\u0441\u0441\u0438\u0438"}),e.jsx($,{edge:"end",color:"inherit",onClick:r,"aria-label":"close",children:e.jsx(We,{})})]}),e.jsx(ce,{sx:{p:0,backgroundColor:"#0F0F0F",pb:0,overflowX:"hidden"},children:c?e.jsx(a,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(de,{color:"secondary"})}):z?e.jsxs(a,{sx:{p:3,textAlign:"center"},children:[e.jsx(bt,{color:"error",fontSize:"large"}),e.jsx(n,{color:"error",sx:{mt:1},children:z}),e.jsx(U,{variant:"outlined",color:"secondary",onClick:m,sx:{mt:2},children:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C"})]}):e.jsxs(e.Fragment,{children:[f&&e.jsxs(a,{sx:{mb:2,px:1},children:[e.jsx(n,{variant:"subtitle1",sx:{p:2,pb:1,fontWeight:"bold"},children:"\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u0441\u0435\u0441\u0441\u0438\u044F"}),e.jsx(X,{disablePadding:!0,children:e.jsxs(le,{sx:{backgroundColor:"rgba(208, 188, 255, 0.08)",mb:1,mx:1,borderRadius:2,position:"relative","&::after":{content:'""',position:"absolute",width:8,height:8,borderRadius:"50%",backgroundColor:"#4caf50",right:16,top:16}},children:[e.jsx(Ge,{sx:{minWidth:{xs:36,sm:56}},children:ft(f.device)}),e.jsx(q,{primary:e.jsxs(a,{component:"span",sx:{display:"flex",alignItems:"center"},children:[e.jsx(n,{variant:"body1",component:"span",sx:{color:"#d0bcff"},children:f.browser}),e.jsx(ie,{fontSize:"small",sx:{ml:1,color:"#4caf50"}})]}),secondary:e.jsxs(n,{variant:"body2",sx:{color:"#B0B0B0"},children:[f.device," \u2022 \u0410\u043A\u0442\u0438\u0432\u043D\u043E \u0441\u0435\u0439\u0447\u0430\u0441"]})})]})})]}),e.jsxs(n,{variant:"subtitle1",sx:{p:2,pb:1,fontWeight:"bold"},children:["\u0412\u0441\u0435 \u0441\u0435\u0441\u0441\u0438\u0438 ",g.length>0&&`(${g.length})`]}),g.length===0?e.jsx(a,{sx:{p:3,textAlign:"center"},children:e.jsx(n,{color:"text.secondary",children:"\u041D\u0435\u0442 \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0445 \u0441\u0435\u0441\u0441\u0438\u0439"})}):e.jsx(X,{disablePadding:!0,sx:{maxHeight:d?"calc(100vh - 260px)":"400px",overflowY:"auto",overflowX:"hidden",pb:0,"&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#111"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#333",borderRadius:"4px"}},children:g.map(l=>e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:l.is_current?"rgba(208, 188, 255, 0.08)":"transparent",mx:2,mb:1,borderRadius:2,px:2,py:1,"&:hover":{backgroundColor:"rgba(208, 188, 255, 0.05)"}},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",width:"calc(100% - 40px)"},children:[e.jsx(a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",minWidth:{xs:36,sm:48}},children:ft(l.device)}),e.jsxs(a,{sx:{ml:1,width:"calc(100% - 48px)"},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[e.jsx(n,{variant:"body1",sx:{color:(l.browser,"#d0bcff")},children:l.browser}),l.is_current&&e.jsx(n,{variant:"caption",sx:{ml:1,px:1,py:.5,borderRadius:1,backgroundColor:"rgba(208, 188, 255, 0.15)",color:"#d0bcff"},children:"\u0422\u0435\u043A\u0443\u0449\u0430\u044F"})]}),e.jsxs(n,{variant:"body2",sx:{color:"#B0B0B0",whiteSpace:"normal",wordBreak:"break-word",fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:[l.device," \u2022 ",l.ip_address," \u2022 ",Ir(l.last_activity)]})]})]}),!l.is_current&&e.jsx($,{size:"small","aria-label":"delete",onClick:()=>{return b=l.id,void C({open:!0,sessionId:b});var b},sx:{color:"#ff5252",width:32,height:32,"&:hover":{backgroundColor:"rgba(208, 188, 255, 0.08)"}},children:e.jsx(He,{fontSize:d?"small":"medium"})})]},l.id))})]})}),e.jsxs(Ke,{sx:{justifyContent:"space-between",p:2,pt:3,backgroundColor:"#0F0F0F",borderTop:"1px solid #222",position:d?"sticky":"relative",bottom:0,width:"100%"},children:[e.jsx(U,{onClick:r,variant:"outlined",sx:{borderColor:"rgba(208, 188, 255, 0.3)",color:"#fff","&:hover":{borderColor:"#d0bcff"}},disabled:c,children:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C"}),e.jsx(U,{onClick:async()=>{try{h(!0);const l=await fetch("/api/auth/sessions",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete_all:!0})}),b=await l.json();b.success?(j({open:!0,message:"\u0412\u0441\u0435 \u0434\u0440\u0443\u0433\u0438\u0435 \u0441\u0435\u0441\u0441\u0438\u0438 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u044B",severity:"success"}),m()):j({open:!0,message:b.error||"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u0435\u0441\u0441\u0438\u0438",severity:"error"})}catch(l){j({open:!0,message:l.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u0441\u0435\u0441\u0441\u0438\u0439",severity:"error"})}finally{h(!1),C({open:!1,sessionId:null})}},variant:"contained",startIcon:e.jsx(He,{}),disabled:c||g.length<=1,sx:{backgroundColor:"rgba(208, 188, 255, 0.1)",color:"#d0bcff",boxShadow:"0 4px 12px rgba(208, 188, 255, 0.1)",border:"1px solid rgba(208, 188, 255, 0.3)","&:hover":{backgroundColor:"rgba(208, 188, 255, 0.2)"}},children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044C \u0432\u0441\u0435 \u0441\u0435\u0441\u0441\u0438\u0438"})]})]}),e.jsxs(Q,{open:k.open,onClose:()=>C({open:!1,sessionId:null}),"aria-labelledby":"alert-dialog-title",PaperProps:{style:{borderRadius:16,backgroundColor:"#0F0F0F",color:"#fff"}},children:[e.jsx(_e,{id:"alert-dialog-title",sx:{borderBottom:"1px solid #222"},children:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F"}),e.jsx(ce,{sx:{pt:3},children:e.jsx(n,{children:"\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044C \u044D\u0442\u0443 \u0441\u0435\u0441\u0441\u0438\u044E? \u0423\u0441\u0442\u0440\u043E\u0439\u0441\u0442\u0432\u043E \u0431\u0443\u0434\u0435\u0442 \u043E\u0442\u043A\u043B\u044E\u0447\u0435\u043D\u043E \u043E\u0442 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430."})}),e.jsxs(Ke,{sx:{borderTop:"1px solid #222"},children:[e.jsx(U,{onClick:()=>C({open:!1,sessionId:null}),sx:{color:"#fff"},children:"\u041E\u0442\u043C\u0435\u043D\u0430"}),e.jsx(U,{onClick:()=>(async l=>{try{h(!0);const b=await fetch(`/api/auth/sessions/${l}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),M=await b.json();M.success?(j({open:!0,message:"\u0421\u0435\u0441\u0441\u0438\u044F \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u0430",severity:"success"}),m()):j({open:!0,message:M.error||"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u0435\u0441\u0441\u0438\u044E",severity:"error"})}catch(b){j({open:!0,message:b.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u0441\u0435\u0441\u0441\u0438\u0438",severity:"error"})}finally{h(!1),C({open:!1,sessionId:null})}})(k.sessionId),variant:"contained",sx:{backgroundColor:"rgba(208, 188, 255, 0.1)",color:"#d0bcff",border:"1px solid rgba(208, 188, 255, 0.3)","&:hover":{backgroundColor:"rgba(208, 188, 255, 0.2)"}},autoFocus:!0,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044C \u0441\u0435\u0441\u0441\u0438\u044E"})]})]}),e.jsx(Qe,{open:v.open,autoHideDuration:6e3,onClose:R,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{marginBottom:d?"70px":"10px",zIndex:9999},children:e.jsx(et,{onClose:R,severity:v.severity,sx:{width:"100%",backgroundColor:v.severity==="success"?"rgb(41, 33, 58)":"#271919",color:v.severity==="success"?"#d0bcff":"#fff",border:v.severity==="success"?"1px solid rgb(71, 55, 110)":"none"},children:v.message})})]})};var vt,fe={};function Rr(){if(vt)return fe;vt=1;var t=T();Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var r=t(H()),i=B();return fe.default=(0,r.default)((0,i.jsx)("path",{d:"M18 20H4V6h9V4H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-9h-2zm-7.79-3.17-1.96-2.36L5.5 18h11l-3.54-4.71zM20 4V1h-2v3h-3c.01.01 0 2 0 2h3v2.99c.01.01 2 0 2 0V6h3V4z"}),"AddPhotoAlternateOutlined"),fe}const jt=L(Rr());var yt,ve={};function _r(){if(yt)return ve;yt=1;var t=T();Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=void 0;var r=t(H()),i=B();return ve.default=(0,r.default)((0,i.jsx)("path",{d:"m12 3 .01 10.55c-.59-.34-1.27-.55-2-.55C7.79 13 6 14.79 6 17s1.79 4 4.01 4S14 19.21 14 17V7h4V3zm-1.99 16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"}),"MusicNoteOutlined"),ve}const je=L(_r());var wt,ye={};function Wr(){if(wt)return ye;wt=1;var t=T();Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=void 0;var r=t(H()),i=B();return ye.default=(0,r.default)((0,i.jsx)("path",{d:"M14 10H3v2h11zm0-4H3v2h11zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2zM3 16h7v-2H3z"}),"PlaylistAdd"),ye}const Mr=L(Wr());var kt,we={};function Ar(){if(kt)return we;kt=1;var t=T();Object.defineProperty(we,"__esModule",{value:!0}),we.default=void 0;var r=t(H()),i=B();return we.default=(0,r.default)((0,i.jsx)("path",{d:"M7 11v2h10v-2zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"RemoveCircleOutline"),we}const De=L(Ar()),Pr=s(Q)(({theme:t})=>({"&&":{"& .MuiDialog-paper":{[t.breakpoints.down("sm")]:{borderRadius:"0 !important",maxWidth:"100% !important",maxHeight:"100% !important",width:"100% !important",height:"100% !important",margin:"0 !important"},[t.breakpoints.up("sm")]:{borderRadius:`${t.spacing(2)}px !important`,maxWidth:"800px !important",maxHeight:"80vh !important",width:"800px !important",height:"80vh !important",margin:"40px auto !important"},backgroundColor:t.palette.mode==="light"?t.palette.background.paper:t.palette.mode==="contrast"?"#101010":"#121212",backgroundImage:"none !important",overflow:"hidden !important"}}})),Fr=s(_e)(({theme:t})=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:t.spacing(2,3),borderBottom:`1px solid ${t.palette.divider}`,color:t.palette.mode==="light"?t.palette.text.primary:"#fff"})),Or=s(a)(({theme:t})=>({width:"100%",aspectRatio:"1/1",borderRadius:t.spacing(2),border:`2px dashed ${t.palette.divider}`,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease",backgroundColor:t.palette.mode==="light"?y(t.palette.grey[300],.3):t.palette.mode==="contrast"?"rgba(0, 0, 0, 0.4)":"rgba(0, 0, 0, 0.3)","&:hover":{backgroundColor:t.palette.mode==="light"?y(t.palette.grey[300],.5):t.palette.mode==="contrast"?"rgba(0, 0, 0, 0.6)":"rgba(0, 0, 0, 0.5)",borderColor:t.palette.primary.main}})),Tr=s(a)(({theme:t})=>({width:"100%",aspectRatio:"1/1",borderRadius:t.spacing(2),overflow:"hidden",position:"relative",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"})),Ct=s(re)(({theme:t})=>({marginBottom:t.spacing(2),"& .MuiOutlinedInput-root":{borderRadius:t.spacing(3),backgroundColor:t.palette.mode==="light"?y(t.palette.grey[300],.2):t.palette.mode==="contrast"?"rgba(255, 255, 255, 0.03)":"rgba(255, 255, 255, 0.05)"}})),Ae=s(le)(({theme:t,selected:r,isPlaying:i})=>({borderRadius:t.spacing(1),marginBottom:t.spacing(.5),padding:t.spacing(1,1.5),backgroundColor:i?y(t.palette.primary.main,t.palette.mode==="light"?.15:.25):r?y(t.palette.primary.main,t.palette.mode==="light"?.08:.16):"transparent","&:hover":{backgroundColor:i?y(t.palette.primary.main,t.palette.mode==="light"?.2:.3):t.palette.mode==="light"?y(t.palette.grey[300],.3):y(t.palette.common.white,.08)}})),Pe=s(te)(({theme:t})=>({width:36,height:36,borderRadius:t.spacing(1)})),Br=s(a)(({theme:t})=>({overflow:"auto",maxHeight:"calc(100% - 48px)",padding:t.spacing(0,3,3,3),"&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{backgroundColor:t.palette.mode==="light"?y(t.palette.grey[300],.3):y(t.palette.common.white,.05),borderRadius:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:t.palette.mode==="light"?y(t.palette.grey[500],.4):y(t.palette.common.white,.2),borderRadius:"3px"}})),ke=s(U)(({theme:t})=>({borderRadius:t.spacing(3),padding:t.spacing(1,3),textTransform:"none",boxShadow:"none"})),Hr=s(a)(({theme:t})=>({display:"flex",alignItems:"center",justifyContent:"center",color:t.palette.primary.main,marginRight:t.spacing(1),animation:"pulse 1.5s infinite ease-in-out","@keyframes pulse":{"0%":{opacity:.6},"50%":{opacity:1},"100%":{opacity:.6}}})),Lr=({open:t,onClose:r,playlist:i=null,onSave:d,onAddTracks:g,onRemoveTrack:w,onDelete:c,isLoading:h=!1,nowPlaying:z=null})=>{const u=G(),{themeSettings:v}=p.useContext(Be),j=K(u.breakpoints.down("sm")),k=K("(max-width:360px)"),[C,m]=p.useState(0),[R,f]=p.useState(""),[l,b]=p.useState(""),[M,x]=p.useState(!0),[_,A]=p.useState(null),[W,O]=p.useState(""),[S,P]=p.useState([]),[D,Y]=p.useState(""),[V,Ve]=p.useState([]),[se,Ue]=p.useState([]),[Je,Ye]=p.useState(!1),[ze,Re]=p.useState({open:!1,message:"",severity:"success"}),N=!!i;p.useEffect(()=>{t&&i?(f(i.name||""),b(i.description||""),x(i.is_public!==!1),O(i.cover_url||i.cover_image||""),Ue(i.tracks||[]),P([])):t&&(f(""),b(""),x(!0),A(null),O(""),P([]),Ue([])),m(0)},[t,i]);const qe=o=>{const I=o.target.files[0];if(I){A(I);const F=new FileReader;F.onloadend=()=>{O(F.result)},F.readAsDataURL(I)}},Xe=p.useCallback(async o=>{if(!o||o.length<2)Ve([]);else{Ye(!0);try{const I=await fetch(`/api/music/search?query=${encodeURIComponent(o)}`),F=await I.json();Ve(F||[])}catch{Re({open:!0,message:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043F\u043E\u0438\u0441\u043A\u0435 \u0442\u0440\u0435\u043A\u043E\u0432",severity:"error"})}finally{Ye(!1)}}},[]);p.useEffect(()=>{const o=setTimeout(()=>{Xe(D)},300);return()=>clearTimeout(o)},[D,Xe]);const Fe=o=>{P(I=>I.some(F=>F.id===o.id)?I.filter(F=>F.id!==o.id):[...I,o])},Ze=()=>{Re({...ze,open:!1})};return e.jsxs(Pr,{open:t,onClose:r,fullScreen:!1,maxWidth:!1,fullWidth:!1,children:[e.jsxs(Fr,{children:[e.jsx(n,{variant:"h6",sx:{fontWeight:600},children:N?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442":"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442"}),e.jsx($,{edge:"end",color:"inherit",onClick:r,"aria-label":"close",children:e.jsx(We,{})})]}),N&&e.jsxs(Dt,{value:C,onChange:(o,I)=>m(I),indicatorColor:"primary",textColor:"primary",variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider"},children:[e.jsx(tt,{label:"\u041F\u043B\u0435\u0439\u043B\u0438\u0441\u0442"}),e.jsx(tt,{label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0442\u0440\u0435\u043A\u0438"})]}),h?e.jsx(a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px"},children:e.jsx(de,{})}):e.jsxs(Br,{children:[(!N||C===0)&&e.jsxs(a,{sx:{mt:2},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:j?"column":"row",gap:3,alignItems:"flex-start"},children:[e.jsx(a,{sx:{width:j?"100%":"200px",flexShrink:0,position:"relative"},children:W?e.jsxs(Tr,{children:[e.jsx("img",{src:W,alt:"Playlist cover",style:{width:"100%",height:"100%",objectFit:"cover"}}),e.jsxs($,{sx:{position:"absolute",bottom:8,right:8,backgroundColor:"rgba(0,0,0,0.5)",color:"#fff","&:hover":{backgroundColor:"rgba(0,0,0,0.7)"}},component:"label",children:[e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:qe}),e.jsx(jt,{})]})]}):e.jsxs(Or,{component:"label",children:[e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:qe}),e.jsx(jt,{sx:{fontSize:40,color:u.palette.primary.main,mb:1}}),e.jsx(n,{variant:"body2",align:"center",children:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0431\u043B\u043E\u0436\u043A\u0443 \u0434\u043B\u044F \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442\u0430"})]})}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(re,{fullWidth:!0,label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442\u0430",variant:"outlined",value:R,onChange:o=>f(o.target.value),margin:"normal",required:!0,sx:{mb:2}}),e.jsx(re,{fullWidth:!0,label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435",variant:"outlined",value:l,onChange:o=>b(o.target.value),margin:"normal",multiline:!0,rows:3,sx:{mb:2}}),e.jsx($t,{control:e.jsx(Nt,{checked:M,onChange:o=>x(o.target.checked),color:"primary"}),label:"\u041F\u0443\u0431\u043B\u0438\u0447\u043D\u044B\u0439 \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442",sx:{mt:1}})]})]}),N&&se.length>0&&e.jsxs(a,{sx:{mt:4},children:[e.jsxs(n,{variant:"h6",sx:{fontWeight:600,mb:2},children:["\u0422\u0440\u0435\u043A\u0438 \u0432 \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442\u0435 (",se.length,")"]}),e.jsx(ee,{variant:"outlined",sx:{borderRadius:o=>o.breakpoints.down("sm")?o.spacing(1):o.spacing(2),overflow:"hidden",maxHeight:"400px",mx:1},children:e.jsx(X,{sx:{overflow:"auto",maxHeight:"100%"},children:se.map((o,I)=>{const F=(Z=>z&&z.id===Z.id)(o);return e.jsxs(Ae,{divider:I!==se.length-1,isPlaying:F,sx:{"&:hover":{backgroundColor:F?u.palette.mode==="dark"?"rgba(208, 188, 255, 0.2)":"rgba(208, 188, 255, 0.3)":u.palette.mode==="dark"?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.03)"}},children:[e.jsx(a,{sx:{display:"flex",alignItems:"center",width:"24px",mr:1,flexShrink:0},children:F?e.jsx(Hr,{children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:[e.jsx("rect",{x:"4",y:"4",width:"3",height:"16",rx:"1.5",children:e.jsx("animate",{attributeName:"height",from:"16",to:"6",dur:"0.6s",begin:"0s",repeatCount:"indefinite",values:"16;6;16",keyTimes:"0;0.5;1"})}),e.jsx("rect",{x:"10.5",y:"4",width:"3",height:"16",rx:"1.5",children:e.jsx("animate",{attributeName:"height",from:"6",to:"16",dur:"0.6s",begin:"0.1s",repeatCount:"indefinite",values:"6;16;6",keyTimes:"0;0.5;1"})}),e.jsx("rect",{x:"17",y:"4",width:"3",height:"16",rx:"1.5",children:e.jsx("animate",{attributeName:"height",from:"16",to:"6",dur:"0.6s",begin:"0.2s",repeatCount:"indefinite",values:"16;6;16",keyTimes:"0;0.5;1"})})]})}):e.jsx(n,{variant:"body2",color:"text.secondary",children:I+1})}),e.jsx(ae,{sx:{minWidth:50},children:e.jsx(Pe,{src:o.cover_path,alt:o.title,children:e.jsx(je,{})})}),e.jsx(q,{primary:o.title,secondary:o.artist,primaryTypographyProps:{noWrap:!0,fontWeight:500,title:o.title,color:F?"primary":"inherit"},secondaryTypographyProps:{noWrap:!0,title:o.artist},sx:{mr:1}}),e.jsx(rt,{children:e.jsx($,{edge:"end",size:"small",onClick:()=>{return Z=o.id,void w(i.id,Z);var Z},children:e.jsx(De,{})})})]},o.id)})})})]}),!N&&S.length>0&&e.jsxs(a,{sx:{mt:3},children:[e.jsxs(n,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:["\u0412\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 \u0442\u0440\u0435\u043A\u0438 (",S.length,")"]}),e.jsx(ee,{variant:"outlined",sx:{borderRadius:o=>o.breakpoints.down("sm")?o.spacing(1):o.spacing(2),overflow:"hidden",mx:1},children:e.jsx(X,{sx:{maxHeight:"200px",overflow:"auto"},children:S.map(o=>e.jsxs(Ae,{divider:!0,children:[e.jsx(ae,{sx:{minWidth:50},children:e.jsx(Pe,{src:o.cover_path,alt:o.title,children:e.jsx(je,{})})}),e.jsx(q,{primary:o.title,secondary:o.artist,primaryTypographyProps:{noWrap:!0,title:o.title},secondaryTypographyProps:{noWrap:!0,title:o.artist},sx:{mr:1}}),e.jsx(rt,{children:e.jsx($,{edge:"end",size:"small",onClick:()=>Fe(o),children:e.jsx(De,{})})})]},o.id))})})]}),!N&&e.jsxs(a,{sx:{mt:3},children:[e.jsx(n,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0442\u0440\u0435\u043A\u0438"}),e.jsx(Ct,{fullWidth:!0,placeholder:"\u041F\u043E\u0438\u0441\u043A \u0442\u0440\u0435\u043A\u043E\u0432...",value:D,onChange:o=>Y(o.target.value),InputProps:{startAdornment:e.jsx(ot,{sx:{color:"text.secondary",mr:1}})}}),e.jsx(ee,{variant:"outlined",sx:{borderRadius:o=>o.breakpoints.down("sm")?o.spacing(1):o.spacing(2),overflow:"hidden",mx:1},children:Je?e.jsx(X,{children:[1,2,3].map((o,I)=>e.jsxs(le,{divider:!0,children:[e.jsx(ae,{children:e.jsx(J,{variant:"rectangular",width:42,height:42,sx:{borderRadius:1}})}),e.jsx(q,{primary:e.jsx(J,{width:"70%"}),secondary:e.jsx(J,{width:"40%"})})]},I))}):V.length>0?e.jsx(X,{sx:{maxHeight:"300px",overflow:"auto"},children:V.map(o=>{const I=S.some(F=>F.id===o.id);return e.jsxs(Ae,{divider:!0,selected:I,onClick:()=>Fe(o),sx:{cursor:"pointer"},children:[e.jsx(ae,{children:e.jsx(Pe,{src:o.cover_path,alt:o.title,children:e.jsx(je,{})})}),e.jsx(q,{primary:o.title,secondary:o.artist,primaryTypographyProps:{noWrap:!0},secondaryTypographyProps:{noWrap:!0}}),I&&e.jsx(ie,{color:"primary",sx:{mr:2}})]},o.id)})}):D.length>0?e.jsx(a,{sx:{p:3,textAlign:"center"},children:e.jsx(n,{color:"text.secondary",children:"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E"})}):e.jsx(a,{sx:{p:3,textAlign:"center"},children:e.jsx(n,{color:"text.secondary",children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u0430\u043F\u0440\u043E\u0441 \u0434\u043B\u044F \u043F\u043E\u0438\u0441\u043A\u0430 \u0442\u0440\u0435\u043A\u043E\u0432"})})})]}),C===0&&e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[N&&e.jsx(ke,{variant:"outlined",color:"error",onClick:()=>{window.confirm("\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u043E\u0442 \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442?")&&c(i.id)},startIcon:e.jsx(He,{}),fullWidth:j,children:j?k?"":"\u0423\u0434\u0430\u043B.":"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442"}),e.jsxs(a,{sx:{ml:"auto",display:"flex",gap:2},children:[e.jsx(ke,{variant:"outlined",onClick:r,children:j?k?"":"\u041E\u0442\u043C.":"\u041E\u0442\u043C\u0435\u043D\u0430"}),e.jsx(ke,{variant:"contained",color:"primary",onClick:async()=>{if(!R.trim())return void Re({open:!0,message:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442\u0430 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E",severity:"error"});const o=new FormData;if(o.append("name",R),o.append("description",l),o.append("is_public",M.toString()),_&&o.append("cover",_),!N){const I=S.map(F=>F.id);o.append("track_ids",JSON.stringify(I))}d(o,N?i.id:null)},startIcon:e.jsx(Gt,{}),disabled:!R.trim(),children:N?j?k?"":"\u0421\u043E\u0445\u0440.":"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C":j?k?"":"\u0421\u043E\u0437\u0434.":"\u0421\u043E\u0437\u0434\u0430\u0442\u044C"})]})]})]}),N&&C===1&&e.jsxs(a,{sx:{mt:2},children:[e.jsx(Ct,{fullWidth:!0,placeholder:"\u041F\u043E\u0438\u0441\u043A \u0442\u0440\u0435\u043A\u043E\u0432 \u0434\u043B\u044F \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F...",value:D,onChange:o=>Y(o.target.value),InputProps:{startAdornment:e.jsx(ot,{sx:{color:"text.secondary",mr:1}})}}),e.jsx(ee,{variant:"outlined",sx:{borderRadius:o=>o.breakpoints.down("sm")?o.spacing(1):o.spacing(2),overflow:"hidden",mx:1},children:Je?e.jsx(X,{children:[1,2,3].map((o,I)=>e.jsxs(le,{divider:!0,children:[e.jsx(ae,{children:e.jsx(J,{variant:"rectangular",width:42,height:42,sx:{borderRadius:1}})}),e.jsx(q,{primary:e.jsx(J,{width:"70%"}),secondary:e.jsx(J,{width:"40%"})})]},I))}):V.length>0?e.jsx(X,{sx:{maxHeight:"400px",overflow:"auto"},children:V.map(o=>{const I=S.some(Oe=>Oe.id===o.id),F=(Z=o.id,se.some(Oe=>Oe.id===Z));var Z;return e.jsxs(Ae,{divider:!0,selected:I,onClick:()=>!F&&Fe(o),sx:{cursor:F?"default":"pointer",opacity:F?.6:1},children:[e.jsx(ae,{children:e.jsx(Pe,{src:o.cover_path,alt:o.title,children:e.jsx(je,{})})}),e.jsx(q,{primary:o.title,secondary:o.artist,primaryTypographyProps:{noWrap:!0},secondaryTypographyProps:{noWrap:!0}}),F?e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mr:2},children:"\u0423\u0436\u0435 \u0432 \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442\u0435"}):I&&e.jsx(ie,{color:"primary",sx:{mr:2}})]},o.id)})}):D.length>0?e.jsx(a,{sx:{p:3,textAlign:"center"},children:e.jsx(n,{color:"text.secondary",children:"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E"})}):e.jsx(a,{sx:{p:3,textAlign:"center"},children:e.jsx(n,{color:"text.secondary",children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u0430\u043F\u0440\u043E\u0441 \u0434\u043B\u044F \u043F\u043E\u0438\u0441\u043A\u0430 \u0442\u0440\u0435\u043A\u043E\u0432"})})}),S.length>0&&e.jsxs(n,{variant:"body2",color:"primary",sx:{mb:2},children:["\u0412\u044B\u0431\u0440\u0430\u043D\u043E \u0442\u0440\u0435\u043A\u043E\u0432: ",S.length]}),e.jsxs(a,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(ke,{variant:"outlined",onClick:()=>{m(0),P([])},children:j?k?"":"\u041E\u0442\u043C.":"\u041E\u0442\u043C\u0435\u043D\u0430"}),e.jsx(ke,{variant:"contained",color:"primary",onClick:()=>{if(S.length===0)return void Re({open:!0,message:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0440\u0435\u043A\u0438 \u0434\u043B\u044F \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F",severity:"info"});const o=S.map(I=>I.id);g(i.id,o),P([]),m(0)},startIcon:e.jsx(Mr,{}),disabled:S.length===0,children:j?k?"":"\u0414\u043E\u0431\u0430\u0432.":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 \u0442\u0440\u0435\u043A\u0438"})]})]})]}),e.jsx(Qe,{open:ze.open,autoHideDuration:6e3,onClose:Ze,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(et,{onClose:Ze,severity:ze.severity,variant:"filled",sx:{width:"100%"},children:ze.message})})]})};var St,Ce={};function Er(){if(St)return Ce;St=1;var t=T();Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.default=void 0;var r=t(H()),i=B();return Ce.default=(0,r.default)((0,i.jsx)("path",{d:"M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82"}),"PlayArrowRounded"),Ce}const Dr=L(Er());var It,Se={};function $r(){if(It)return Se;It=1;var t=T();Object.defineProperty(Se,"__esModule",{value:!0}),Se.default=void 0;var r=t(H()),i=B();return Se.default=(0,r.default)((0,i.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"}),"Public"),Se}const zt=L($r()),Rt=s(Vt)(({theme:t,active:r})=>({backgroundColor:r?t.palette.mode==="dark"||t.palette.mode==="contrast"?y(t.palette.primary.dark,.8):y(t.palette.primary.light,.2):t.palette.mode==="light"?y(t.palette.background.paper,.9):t.palette.mode==="contrast"?"#101010":"#121212",borderRadius:t.spacing(1.2),boxShadow:t.shadows[3],transition:"all 0.2s ease",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",position:"relative",border:r?`1px solid ${t.palette.primary.main}`:t.palette.mode==="light"?"1px solid rgba(0, 0, 0, 0.08)":"1px solid rgba(255, 255, 255, 0.05)","&:hover":{transform:"translateY(-3px)",boxShadow:t.shadows[5],"& .media-overlay":{opacity:1}}})),_t=s(a)(({theme:t})=>({position:"relative",paddingTop:"100%",backgroundColor:t.palette.mode==="light"?y(t.palette.grey[300],.5):t.palette.mode==="contrast"?"#080808":"#0A0A0A"})),Nr=s("img")(({theme:t})=>({position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",transition:"transform 0.3s ease"})),Vr=s(a)(({theme:t})=>({position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.4)",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,transition:"opacity 0.3s ease"})),Ur=s(Ut)(({theme:t})=>({flexGrow:1,display:"flex",flexDirection:"column",padding:t.spacing(.8,1),backgroundColor:t.palette.mode==="light"?t.palette.background.paper:t.palette.mode==="contrast"?"#101010":"#121212",color:t.palette.mode==="light"?t.palette.text.primary:"#fff"})),Jr=s(a)(({theme:t})=>({display:"flex",flexDirection:"column",gap:t.spacing(.25),marginTop:t.spacing(.5)})),Yr=s(a)(({theme:t})=>({display:"flex",alignItems:"center",gap:t.spacing(.5),borderRadius:t.spacing(.75),padding:t.spacing(.15,.3),backgroundColor:t.palette.mode==="light"?y(t.palette.grey[300],.5):t.palette.mode==="contrast"?"#151515":"#1E1E1E"})),qr=s("img")(({theme:t})=>({width:15,height:15,borderRadius:t.spacing(.2),objectFit:"cover"})),Xr=s(a)(({theme:t,isPublic:r})=>({position:"absolute",top:t.spacing(.75),right:t.spacing(.75),backgroundColor:r?y(t.palette.success.main,.8):y(t.palette.text.secondary,.5),color:"#fff",borderRadius:"50%",padding:t.spacing(.25),width:18,height:18,display:"flex",alignItems:"center",justifyContent:"center",zIndex:2}));s($)(({theme:t})=>({backgroundColor:"rgba(255, 255, 255, 0.9)",color:t.palette.mode==="dark"?"#000":t.palette.primary.main,"&:hover":{backgroundColor:"#fff",transform:"scale(1.05)"},transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)"})),s(n)(({theme:t,compact:r})=>({fontWeight:600,fontSize:r?"0.8rem":"0.9rem",lineHeight:1.2,letterSpacing:"0.1px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",marginBottom:t.spacing(.2),color:t.palette.mode==="light"?t.palette.text.primary:"#fff"})),s(n)(({theme:t,compact:r})=>({fontSize:r?"0.7rem":"0.75rem",color:t.palette.mode==="light"?t.palette.text.secondary:"rgba(255, 255, 255, 0.7)",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical"})),s($)(({theme:t})=>({position:"absolute",top:t.spacing(.5),right:t.spacing(.5),padding:4,backgroundColor:"rgba(0, 0, 0, 0.5)",color:"#fff",opacity:0,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"},transition:"all 0.2s ease",".PlaylistCard-root:hover &":{opacity:1}})),s(a)(({theme:t})=>({position:"absolute",bottom:t.spacing(1.5),left:t.spacing(1.5),right:t.spacing(1.5),display:"flex",gap:t.spacing(.8)})),s(te)(({theme:t})=>({width:24,height:24,borderRadius:t.spacing(.5),border:"1px solid "+(t.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),boxShadow:"0 1px 3px rgba(0, 0, 0, 0.2)"})),s(Jt)(({theme:t})=>({position:"absolute",top:t.spacing(1),left:t.spacing(1),backgroundColor:"rgba(0, 0, 0, 0.5)",color:"#fff",fontSize:"0.7rem",height:24,"& .MuiChip-icon":{color:"inherit",marginLeft:t.spacing(.5),fontSize:"1rem"}}));const Wt=({compact:t})=>e.jsx(Rt,{compact:t,children:e.jsxs(a,{sx:{p:t?1:1.5},children:[e.jsx(_t,{children:e.jsx(J,{variant:"rectangular",width:"100%",height:"100%",animation:"wave",sx:{borderRadius:r=>r.spacing(1),aspectRatio:"1/1"}})}),e.jsxs(a,{sx:{pt:1.5},children:[e.jsx(J,{width:"80%",height:24,animation:"wave"}),e.jsx(J,{width:"60%",height:20,animation:"wave"})]})]})}),Zr=Te.memo(({id:t,name:r,description:i,coverImage:d,tracksCount:g,previewTracks:w,owner:c,isPublic:h,active:z,onClick:u,onMoreClick:v,isLoading:j=!1})=>{const k=G(),C=p.useCallback(m=>{v&&v(m)},[v]);return j?e.jsx(Wt,{}):e.jsxs(Rt,{active:z,onClick:()=>u&&u(t),children:[e.jsxs(_t,{children:[h!==void 0&&e.jsx(Xr,{isPublic:h,children:h?e.jsx(zt,{sx:{fontSize:12}}):e.jsx(qt,{sx:{fontSize:12}})}),e.jsx(Nr,{src:d||"/static/uploads/system/playlist_placeholder.jpg",alt:r}),e.jsx(Vr,{className:"media-overlay",children:e.jsx($,{size:"small",sx:{color:"#fff",backgroundColor:y(k.palette.primary.main,.8),"&:hover":{backgroundColor:k.palette.primary.main,transform:"scale(1.1)"},transition:"all 0.2s ease",width:32,height:32},children:e.jsx(Dr,{fontSize:"small"})})})]}),e.jsxs(Ur,{children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(a,{sx:{flex:1,overflow:"hidden"},children:[e.jsx(n,{variant:"body2",component:"h3",noWrap:!0,sx:{fontWeight:600,mb:.25},children:r||"My Playlist"}),c&&e.jsxs(n,{variant:"caption",color:"text.secondary",sx:{display:"flex",alignItems:"center",gap:.25,mb:.25},children:[e.jsx(Qt,{fontSize:"inherit"}),c.name||c.username||"Unknown User"]}),g!==void 0&&e.jsxs(n,{variant:"caption",color:"text.secondary",children:[g," ",g===1?"\u0442\u0440\u0435\u043A":g>1&&g<5?"\u0442\u0440\u0435\u043A\u0430":"\u0442\u0440\u0435\u043A\u043E\u0432"]})]}),e.jsx($,{size:"small",onClick:m=>{m.stopPropagation(),C(m)},sx:{ml:.5,p:.5},children:e.jsx(Kt,{fontSize:"small"})})]}),w&&w.length>0&&e.jsx(Jr,{children:w.slice(0,3).map((m,R)=>e.jsxs(Yr,{children:[e.jsx(qr,{src:m.cover_path||"/static/uploads/system/album_placeholder.jpg",alt:m.title}),e.jsx(n,{variant:"caption",noWrap:!0,sx:{flex:1,fontSize:"0.7rem"},children:m.title})]},m.id||R))})]})]})}),Gr=p.memo(Zr),Kr=s(a)(({theme:t})=>({marginBottom:t.spacing(4)})),Mt=s(a)(({theme:t})=>({display:"flex",overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},"-ms-overflow-style":"none",paddingBottom:t.spacing(1),gap:t.spacing(2),paddingRight:t.spacing(2),WebkitOverflowScrolling:"touch"})),At=s(a)(({theme:t,width:r})=>({flexShrink:0,width:r})),Qr=({title:t,subtitle:r,playlists:i=[],loading:d=!1,skeletonCount:g=6,onPlaylistClick:w,onPlaylistPlay:c,onPlaylistMoreClick:h,compact:z=!1,spacing:u=2,...v})=>{const j=G(),{themeSettings:k}=p.useContext(Be),C=K(j.breakpoints.down("sm")),m=K(j.breakpoints.between("sm","md"));if(!d&&i.length===0)return null;let R="20%";return C?R="40%":m&&(R="30%"),d?e.jsx(Mt,{children:Array.from(new Array(g)).map((f,l)=>e.jsx(At,{width:R,children:e.jsx(Wt,{})},`skeleton-${l}`))}):e.jsxs(Kr,{...v,children:[t&&e.jsx(n,{variant:"h6",sx:{mb:1,fontWeight:700},children:t}),r&&e.jsx(n,{variant:"body2",sx:{mb:2,opacity:.7},children:r}),i.length>0?e.jsx(Mt,{children:i.map(f=>e.jsx(At,{width:R,children:e.jsx(Gr,{id:f.id,name:f.name,description:f.description,coverImage:f.cover_image,tracksCount:f.tracks_count,previewTracks:f.preview_tracks,owner:f.owner,isPublic:f.is_public,isOwner:f.is_owner,onClick:()=>w&&w(f.id),onMoreClick:l=>h&&h(l,f)})},f.id))}):e.jsx(n,{variant:"body2",color:"text.secondary",align:"center",children:"\u041D\u0435\u0442 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B\u0445 \u043F\u043B\u0435\u0439\u043B\u0438\u0441\u0442\u043E\u0432"})]})};s(a)(({theme:t})=>({backgroundColor:"rgba(28, 28, 32, 0.4)",backdropFilter:"blur(10px)",borderRadius:"16px",padding:t.spacing(2),border:"1px solid rgba(255, 255, 255, 0.03)",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",transition:"all 0.2s ease-in-out","&:hover":{boxShadow:"0 3px 12px rgba(0, 0, 0, 0.12)",backgroundColor:"rgba(30, 30, 36, 0.5)"},[t.breakpoints.down("sm")]:{padding:t.spacing(1.5)}})),s(a)(({theme:t,active:r})=>({display:"flex",alignItems:"center",cursor:"pointer",padding:"4px 10px",borderRadius:"20px",transition:"all 0.2s ease",backgroundColor:r?"rgba(140, 82, 255, 0.08)":"rgba(255, 255, 255, 0.03)","&:hover":{backgroundColor:r?"rgba(140, 82, 255, 0.15)":"rgba(255, 255, 255, 0.06)",transform:"translateY(-1px)"},[t.breakpoints.down("sm")]:{padding:"3px 8px"}})),s(a)(({theme:t})=>({position:"relative",borderRadius:"12px",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.05)",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.1)",cursor:"pointer",display:"inline-block",maxWidth:"280px","&:hover":{"& .zoom-icon":{opacity:1}},[t.breakpoints.down("sm")]:{maxWidth:"240px"}})),s(n)(({theme:t})=>({whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word",color:t.palette.text.primary,lineHeight:1.5,marginBottom:t.spacing(1.5),marginTop:t.spacing(.5),fontSize:"0.9rem",[t.breakpoints.down("sm")]:{fontSize:"0.85rem"}})),s(a)(({theme:t})=>({backgroundColor:"rgba(32, 32, 36, 0.4)",backdropFilter:"blur(5px)",borderRadius:"14px",padding:t.spacing(1.5,2),marginBottom:t.spacing(1),border:"1px solid rgba(255, 255, 255, 0.03)",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.08)",transition:"all 0.2s ease-in-out","&:hover":{boxShadow:"0 3px 12px rgba(0, 0, 0, 0.12)",backgroundColor:"rgba(35, 35, 40, 0.5)"},[t.breakpoints.down("sm")]:{padding:t.spacing(1.25)}})),s(a)(({theme:t})=>({backgroundColor:"rgba(255, 255, 255, 0.03)",borderRadius:"8px",padding:t.spacing(1,1.5),marginBottom:t.spacing(1),borderLeft:"3px solid rgba(140, 82, 255, 0.5)"})),s(a)(({theme:t,active:r})=>({display:"flex",alignItems:"center",cursor:"pointer",padding:"3px 8px",borderRadius:"12px",transition:"all 0.2s ease",backgroundColor:r?"rgba(140, 82, 255, 0.12)":"rgba(255, 255, 255, 0.04)","&:hover":{backgroundColor:r?"rgba(140, 82, 255, 0.2)":"rgba(255, 255, 255, 0.08)",transform:"translateY(-1px)"}})),s(a)(({theme:t})=>({position:"relative",borderRadius:"10px",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.05)",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.1)",cursor:"pointer",display:"inline-block",maxWidth:"280px","&:hover":{"& .zoom-icon":{opacity:1}},[t.breakpoints.down("sm")]:{maxWidth:"240px"}})),s(re)(({theme:t})=>({"& .MuiOutlinedInput-root":{backgroundColor:"rgba(32, 32, 36, 0.6)",backdropFilter:"blur(5px)",borderRadius:"14px",border:"1px solid rgba(255, 255, 255, 0.05)","& .MuiOutlinedInput-notchedOutline":{borderColor:"transparent"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(140, 82, 255, 0.3)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(140, 82, 255, 0.5)"}}})),s(a)(({theme:t})=>({marginTop:t.spacing(1),position:"relative","& img":{width:"100%",maxHeight:"150px",objectFit:"cover",borderRadius:"12px"}})),s(a)(({theme:t})=>({backgroundColor:"rgba(255, 255, 255, 0.03)",borderRadius:"8px",padding:t.spacing(1,1.5),marginBottom:t.spacing(1),borderLeft:"3px solid rgba(140, 82, 255, 0.5)"})),s(re)(({theme:t})=>({"& .MuiOutlinedInput-root":{backgroundColor:"rgba(32, 32, 36, 0.6)",backdropFilter:"blur(5px)",borderRadius:"14px",border:"1px solid rgba(255, 255, 255, 0.05)","& .MuiOutlinedInput-notchedOutline":{borderColor:"transparent"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(140, 82, 255, 0.3)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(140, 82, 255, 0.5)"}}})),s(a)(({theme:t})=>({marginTop:t.spacing(1),position:"relative","& img":{width:"100%",maxHeight:"150px",objectFit:"cover",borderRadius:"12px"}})),s(n)(({theme:t})=>({marginBottom:t.spacing(3),display:"flex",alignItems:"center",gap:t.spacing(1),fontWeight:600,color:t.palette.text.primary,fontSize:"1.25rem",[t.breakpoints.down("sm")]:{marginBottom:t.spacing(1.5),fontSize:"1rem"}})),s(a)(({theme:t})=>({padding:t.spacing(4),textAlign:"center",backgroundColor:"rgba(255, 255, 255, 0.02)",borderRadius:"16px",border:"1px dashed rgba(255, 255, 255, 0.1)",[t.breakpoints.down("sm")]:{padding:t.spacing(2)}})),s(a)(({theme:t})=>({display:"flex",flexDirection:"column",gap:t.spacing(3),[t.breakpoints.down("sm")]:{gap:t.spacing(1.5)}})),s(a)(({theme:t})=>({marginTop:t.spacing(.5),marginLeft:t.spacing(4),paddingLeft:t.spacing(2),borderLeft:"2px solid rgba(140, 82, 255, 0.2)",paddingTop:t.spacing(1),paddingBottom:t.spacing(1),[t.breakpoints.down("sm")]:{marginLeft:t.spacing(.5),paddingLeft:t.spacing(.5)}})),s(Q)(({theme:t})=>({"& .MuiDialog-paper":{backgroundColor:"rgba(32, 32, 36, 0.8)",backdropFilter:"blur(20px)",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.2)",width:"100%",maxWidth:"400px",borderRadius:"16px",border:"1px solid rgba(100, 90, 140, 0.1)","&:before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,borderRadius:"16px",background:"linear-gradient(145deg, rgba(30, 30, 30, 0.6), rgba(20, 20, 20, 0.75))",backdropFilter:"blur(30px)",zIndex:-1}}}));var Pt,Ie={};function ea(){if(Pt)return Ie;Pt=1;var t=T();Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.default=void 0;var r=t(H()),i=B();return Ie.default=(0,r.default)((0,i.jsx)("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4z"}),"ArrowRightAlt"),Ie}const ta=L(ea()),ra=E(Q)(({theme:t})=>({"& .MuiDialog-paper":{backgroundColor:"rgba(12, 12, 14, 0.95)",backdropFilter:"blur(10px)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",borderRadius:r=>r.fullScreen?0:12,overflow:"hidden",maxWidth:500}})),Ft=E(a)(()=>({background:"linear-gradient(45deg, #d079f3, #5e1c876b)",padding:"20px",position:"relative",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center"})),Ot=E(te)(({theme:t})=>({backgroundColor:"rgba(255,255,255,0.1)",color:"#fff",width:46,height:46,fontSize:20,marginBottom:12,"& svg":{fontSize:24}})),$e=E(a)(()=>({marginBottom:24})),Ne=E(re)(({theme:t})=>({"& .MuiOutlinedInput-root":{backgroundColor:"rgba(20, 20, 20, 0.4)",backdropFilter:"blur(5px)",borderRadius:8,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255,255,255,0.2)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#555555"}},"& .MuiInputLabel-root":{color:"rgba(255,255,255,0.7)","&.Mui-focused":{color:"#999999"}},"& .MuiOutlinedInput-input":{color:"#fff"},"& .MuiFormHelperText-root":{marginLeft:2,marginTop:8}})),aa=E(a)(()=>({backgroundColor:"rgba(20, 20, 20, 0.4)",backdropFilter:"blur(5px)",borderRadius:8,marginBottom:24,maxHeight:200,overflow:"auto"}));E(a)(()=>({padding:"10px 16px",display:"flex",alignItems:"center",cursor:"pointer","&:hover":{backgroundColor:"rgba(40, 40, 40, 0.4)"}}));const ia=E(te)(()=>({width:32,height:32,fontSize:14,marginRight:12,backgroundColor:"#444444"})),Tt=E(a)(()=>({padding:24,display:"flex",justifyContent:"space-between",borderTop:"1px solid rgba(54, 54, 54, 0.68)",background:"rgba(10, 10, 10, 0.8)"})),oa=E(U)(()=>({color:"rgba(255,255,255,0.7)","&:hover":{backgroundColor:"rgba(40, 40, 40, 0.4)"}})),Bt=E(U)(()=>({backgroundImage:"linear-gradient(90deg, #6b5d97, #827095)",color:"white",padding:"8px 24px","&:hover":{opacity:.9},"&:disabled":{color:"rgba(255,255,255,0.5)",backgroundImage:"none",backgroundColor:"rgba(40, 40, 40, 0.4)"}})),na=E(a)(({theme:t,decoration:r})=>{const i=r?.background?.includes("linear-gradient"),d=r?.background?.includes("/"),g=r?.background?.startsWith("#"),w=g&&(c=>{if(!c||!c.startsWith("#"))return!1;const h=c.replace("#","");return(299*parseInt(h.substr(0,2),16)+587*parseInt(h.substr(2,2),16)+114*parseInt(h.substr(4,2),16))/1e3>128})(r?.background);return{display:"flex",alignItems:"center",padding:t.spacing(1.5),borderRadius:t.spacing(2),marginBottom:t.spacing(1),backgroundColor:t.palette.background.paper,position:"relative",overflow:"hidden",background:r?.background?d?`url(${r.background})`:r.background:t.palette.background.paper,backgroundSize:d?"cover":"auto",backgroundPosition:d?"center":"auto",color:w?"rgba(0, 0, 0, 0.87)":t.palette.text.primary,"& .MuiTypography-root":{color:w?"rgba(0, 0, 0, 0.87)":"inherit"},"& .MuiTypography-colorTextSecondary":{color:w?"rgba(0, 0, 0, 0.6)":t.palette.text.secondary},"&:hover":{backgroundColor:y(t.palette.background.paper,.8),cursor:"pointer"},"&::before":i?{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:r.background,opacity:.15,zIndex:0}:{}}}),sa=E("img")({position:"absolute",right:0,height:"max-content",maxHeight:60,opacity:1,pointerEvents:"none",zIndex:1}),la=({open:t,onClose:r,userPoints:i,onSuccess:d})=>{const g=G(),w=K(g.breakpoints.down("sm")),[c,h]=p.useState({username:"",amount:"",message:"",recipient_id:null}),[z,u]=p.useState({}),[v,j]=p.useState({loading:!1,exists:!1,suggestions:[]}),[k,C]=p.useState(!1),[m,R]=p.useState(!1),[f,l]=p.useState(null),b=p.useRef(null);p.useEffect(()=>()=>{b.current&&clearTimeout(b.current)},[]),p.useEffect(()=>{t||b.current&&(clearTimeout(b.current),b.current=null)},[t]);const M=x=>{if(!x||isNaN(x))return{commission:0,total:0,recipientAmount:0};const _=parseInt(x),A=Math.floor(.1*_);return{commission:A,total:_,recipientAmount:_-A}};return e.jsx(ra,{open:t,onClose:()=>{k||(m&&R(!1),r())},maxWidth:"sm",fullWidth:!0,fullScreen:w,children:m?e.jsxs(e.Fragment,{children:[e.jsxs(Ft,{children:[e.jsx(Ot,{sx:{backgroundColor:"rgba(76, 175, 80, 0.2)",color:"#4CAF50",width:60,height:60},children:e.jsx(ie,{sx:{fontSize:32}})}),e.jsx(n,{variant:"h5",sx:{color:"white",fontWeight:700,mb:1},children:"\u041F\u0435\u0440\u0435\u0432\u043E\u0434 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D"}),e.jsxs(n,{variant:"body2",sx:{color:"rgba(255,255,255,0.7)",maxWidth:"80%"},children:["\u0411\u0430\u043B\u043B\u044B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043F\u0435\u0440\u0435\u0432\u0435\u0434\u0435\u043D\u044B \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044E ",f?.recipient]})]}),e.jsxs(ce,{sx:{p:3,bgcolor:"rgba(10, 10, 10, 0.8)"},children:[e.jsxs(a,{sx:{p:3,bgcolor:"rgba(40, 40, 40, 0.4)",borderRadius:2,mb:3,border:"1px solid rgba(60, 60, 60, 0.4)"},children:[e.jsx(n,{variant:"subtitle1",sx:{color:"rgba(255,255,255,0.7)",mb:2},children:"\u0414\u0435\u0442\u0430\u043B\u0438 \u0442\u0440\u0430\u043D\u0437\u0430\u043A\u0446\u0438\u0438"}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(n,{variant:"body2",sx:{color:"rgba(255,255,255,0.7)"},children:"\u0421\u0443\u043C\u043C\u0430 \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430"}),e.jsxs(n,{variant:"body1",sx:{fontWeight:"bold"},children:[f?.amount," \u0431\u0430\u043B\u043B\u043E\u0432"]})]}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(n,{variant:"body2",sx:{color:"rgba(255,255,255,0.7)"},children:"\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C"}),e.jsx(n,{variant:"body1",children:f?.recipient})]}),e.jsxs(a,{sx:{mt:4,mb:1},children:[e.jsx(n,{variant:"subtitle2",sx:{color:"#4CAF50",mb:2},children:"\u0411\u0430\u043B\u0430\u043D\u0441 \u043F\u043E\u0441\u043B\u0435 \u043E\u043F\u0435\u0440\u0430\u0446\u0438\u0438"}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(a,{children:[e.jsx(n,{variant:"caption",sx:{color:"rgba(255,255,255,0.5)"},children:"\u0414\u043E \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430"}),e.jsx(n,{variant:"h6",children:f?.previousBalance})]}),e.jsx(ta,{sx:{color:"rgba(255,255,255,0.3)",mx:2}}),e.jsxs(a,{sx:{textAlign:"right"},children:[e.jsx(n,{variant:"caption",sx:{color:"rgba(255,255,255,0.5)"},children:"\u041F\u043E\u0441\u043B\u0435 \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430"}),e.jsx(n,{variant:"h6",sx:{color:"#AAAAAA"},children:f?.newBalance})]})]})]})]}),f?.dataUrl&&e.jsx(a,{sx:{textAlign:"center",mb:2},children:e.jsx(U,{component:"a",href:f.dataUrl,download:`receipt-${Date.now()}.pdf`,variant:"outlined",sx:{borderColor:"rgba(255,255,255,0.2)",color:"white","&:hover":{borderColor:"rgba(255,255,255,0.4)",backgroundColor:"rgba(255,255,255,0.05)"}},children:"\u0421\u043A\u0430\u0447\u0430\u0442\u044C \u043A\u0432\u0438\u0442\u0430\u043D\u0446\u0438\u044E"})})]}),e.jsx(Tt,{children:e.jsx(Bt,{onClick:()=>{R(!1),r()},fullWidth:!0,children:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Ft,{children:[e.jsx(Ot,{children:e.jsx(nt,{})}),e.jsx(n,{variant:"h5",sx:{color:"white",fontWeight:700,mb:1},children:"\u041F\u0435\u0440\u0435\u0432\u043E\u0434 \u0431\u0430\u043B\u043B\u043E\u0432"}),e.jsx(n,{variant:"body2",sx:{color:"rgba(255,255,255,0.7)",maxWidth:"80%"},children:"\u041C\u0433\u043D\u043E\u0432\u0435\u043D\u043D\u044B\u0439 \u043F\u0435\u0440\u0435\u0432\u043E\u0434 \u0431\u0430\u043B\u043B\u043E\u0432 \u0434\u0440\u0443\u0433\u043E\u043C\u0443 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044E \u043F\u043B\u0430\u0442\u0444\u043E\u0440\u043C\u044B"})]}),e.jsxs(ce,{sx:{p:3,bgcolor:"rgba(10, 10, 10, 0.8)"},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:4},children:[e.jsx(n,{variant:"subtitle2",sx:{color:"rgba(255,255,255,0.7)"},children:"\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u0434\u043B\u044F \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430"}),e.jsxs(n,{variant:"h6",fontWeight:"bold",sx:{color:"#AAAAAA"},children:[i," \u0431\u0430\u043B\u043B\u043E\u0432"]})]}),e.jsx($e,{children:e.jsx(Ne,{label:"\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C",fullWidth:!0,variant:"outlined",value:c.username,onChange:x=>{const _=x.target.value;var A;h(W=>({...W,username:_})),_.trim()?(A=_.trim(),j(W=>({...W,loading:!0})),b.current&&clearTimeout(b.current),b.current=setTimeout(()=>{const W=`/api/search/recipients?query=${encodeURIComponent(A)}`;oe.get(W).then(O=>{if(O.data&&O.data.users&&O.data.users.length>0){const S=O.data.users.find(P=>P.username.toLowerCase()===A.toLowerCase());h(S?P=>({...P,recipient_id:S.id}):P=>({...P,recipient_id:null})),j(P=>({...P,loading:!1,exists:!!S,suggestions:O.data.users.slice(0,3)}))}else j(S=>({...S,loading:!1,exists:!1,suggestions:[]})),h(S=>({...S,recipient_id:null}))}).catch(O=>{j(S=>({...S,loading:!1,exists:!1,suggestions:[]})),h(S=>({...S,recipient_id:null}))})},300)):(b.current&&(clearTimeout(b.current),b.current=null),j(W=>({...W,loading:!1,exists:!1,suggestions:[]})),h(W=>({...W,recipient_id:null})))},error:!!z.username,helperText:z.username,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043C\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F",InputProps:{endAdornment:e.jsxs(Te.Fragment,{children:[v.loading&&e.jsx(de,{size:20,color:"inherit"}),v.exists&&!v.loading&&e.jsx(ie,{sx:{color:"#4CAF50"}}),c.username&&!v.loading&&e.jsx(at,{position:"end",children:e.jsx($,{edge:"end",onClick:()=>{b.current&&(clearTimeout(b.current),b.current=null),h(x=>({...x,username:"",recipient_id:null})),j(x=>({...x,loading:!1,exists:!1,suggestions:[]}))},children:e.jsx(We,{fontSize:"small"})})})]})}})}),v.suggestions.length>0&&!v.exists&&e.jsxs(aa,{children:[e.jsx(a,{sx:{p:2,pb:1},children:e.jsx(n,{variant:"subtitle2",sx:{color:"rgba(255,255,255,0.6)",fontSize:"0.85rem"},children:"\u041F\u043E\u0445\u043E\u0436\u0438\u0435 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438"})}),v.suggestions.map(x=>e.jsxs(na,{decoration:x.decoration,onClick:()=>{return _=x.username,A=x.id,h(W=>({...W,username:_,recipient_id:A})),void j(W=>({...W,loading:!1,exists:!0,suggestions:[]}));var _,A},children:[x.decoration?.item_path&&(()=>{const[_,...A]=x.decoration.item_path.split(";"),W=A.reduce((O,S)=>{const[P,D]=S.split(":").map(Y=>Y.trim());if(P==="height"){const Y=parseInt(D);return{...O,[P]:Y/2+"px"}}return{...O,[P]:D}},{});return e.jsx(sa,{src:_,alt:"decoration",style:W})})(),e.jsxs(a,{sx:{position:"relative",zIndex:2,display:"flex",alignItems:"center",width:"100%"},children:[e.jsx(ia,{src:x.photo?`/static/uploads/avatar/${x.id}/${x.photo}`:void 0,alt:x.username,children:x.username.charAt(0).toUpperCase()}),e.jsxs(a,{sx:{flex:1},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(n,{variant:"subtitle1",sx:{fontWeight:"bold"},children:x.name}),x.verification_status==="verified"&&e.jsx(it,{sx:{fontSize:16,ml:.5,color:"#D0BCFF"}})]}),e.jsxs(n,{variant:"body2",color:"text.secondary",children:["@",x.username]})]})]})]},x.id))]}),v.exists&&c.recipient_id&&e.jsxs(a,{sx:{p:2,mb:3,bgcolor:"rgba(40, 40, 40, 0.4)",backdropFilter:"blur(5px)",borderRadius:2,border:"1px solid rgba(60, 60, 60, 0.4)",display:"flex",alignItems:"center"},children:[e.jsx(ie,{sx:{color:"#4CAF50",mr:1}}),e.jsxs(n,{variant:"body2",children:["\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D: ",e.jsx("strong",{children:c.username})]})]}),e.jsxs($e,{children:[e.jsx(Ne,{label:"\u0421\u0443\u043C\u043C\u0430 \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430",fullWidth:!0,variant:"outlined",type:"number",value:c.amount,onChange:x=>{const _=x.target.value;(_===""||/^\d+$/.test(_))&&(h(A=>({...A,amount:_})),u(A=>({...A,amount:""})))},error:!!z.amount,helperText:z.amount,InputProps:{endAdornment:e.jsx(at,{position:"end",children:"\u0431\u0430\u043B\u043B\u043E\u0432"})}}),c.amount&&!z.amount&&e.jsxs(a,{sx:{mt:2,p:2,bgcolor:"rgba(0,0,0,0.2)",borderRadius:1},children:[e.jsx(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"\u0414\u0435\u0442\u0430\u043B\u0438 \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430:"}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(n,{variant:"body2",color:"text.secondary",children:"\u0421\u0443\u043C\u043C\u0430 \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430:"}),e.jsxs(n,{variant:"body2",color:"text.primary",children:[c.amount," \u0431\u0430\u043B\u043B\u043E\u0432"]})]}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(n,{variant:"body2",color:"text.secondary",children:"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F (10%):"}),e.jsxs(n,{variant:"body2",color:"error",children:["-",M(c.amount).commission," \u0431\u0430\u043B\u043B\u043E\u0432"]})]}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(n,{variant:"body2",color:"text.secondary",children:"\u041F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044C \u043F\u043E\u043B\u0443\u0447\u0438\u0442:"}),e.jsxs(n,{variant:"body2",color:"success.main",children:[M(c.amount).recipientAmount," \u0431\u0430\u043B\u043B\u043E\u0432"]})]}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(n,{variant:"body2",color:"text.secondary",children:"\u0412\u0430\u0448 \u0431\u0430\u043B\u0430\u043D\u0441 \u043F\u043E\u0441\u043B\u0435 \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430:"}),e.jsxs(n,{variant:"body2",color:"text.primary",children:[i-M(c.amount).total," \u0431\u0430\u043B\u043B\u043E\u0432"]})]})]})]}),e.jsx($e,{children:e.jsx(Ne,{label:"\u0421\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 (\u043D\u0435\u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E)",fullWidth:!0,variant:"outlined",value:c.message,onChange:x=>h(_=>({..._,message:x.target.value})),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0434\u043B\u044F \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F",multiline:!0,rows:2})}),z.general&&e.jsx(a,{sx:{p:2,mb:2,bgcolor:"rgba(50, 20, 20, 0.4)",backdropFilter:"blur(5px)",borderRadius:2,border:"1px solid rgba(70, 20, 20, 0.4)"},children:e.jsx(n,{variant:"body2",color:"error",children:z.general})})]}),e.jsxs(Tt,{children:[e.jsx(oa,{onClick:r,disabled:k,children:"\u041E\u0442\u043C\u0435\u043D\u0430"}),e.jsx(Bt,{onClick:async()=>{const x={};if(c.username||(x.username="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043C\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F"),c.recipient_id||(x.username="\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D"),c.amount)if(isNaN(c.amount)||parseInt(c.amount)<=0)x.amount="\u0421\u0443\u043C\u043C\u0430 \u0434\u043E\u043B\u0436\u043D\u0430 \u0431\u044B\u0442\u044C \u043F\u043E\u043B\u043E\u0436\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C \u0447\u0438\u0441\u043B\u043E\u043C";else{const{total:P}=M(c.amount);P>i&&(x.amount="\u041D\u0435\u0434\u043E\u0441\u0442\u0430\u0442\u043E\u0447\u043D\u043E \u0431\u0430\u043B\u043B\u043E\u0432 \u0434\u043B\u044F \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430")}else x.amount="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043C\u043C\u0443 \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430";if(Object.keys(x).length>0)return void u(x);if(k)return;u({}),C(!0);const _=parseInt(c.amount),{commission:A,total:W,recipientAmount:O}=M(_),S=i-W;try{const P=await oe.post("/api/user/transfer-points",{recipient_username:c.username,recipient_id:c.recipient_id,amount:_,message:c.message});try{const D=new Date,Y=`TR-${Date.now().toString().slice(-8)}`,V=await oe.post("/api/user/generate-receipt",{transaction_data:{transactionId:Y,amount:_,commission:A,total:W,recipientAmount:O,recipientUsername:c.username,senderUsername:P.data.sender_username||"\u0412\u044B",date:D.toISOString()}});V.data&&V.data.success&&(l({dataUrl:`data:application/pdf;base64,${V.data.pdf_data}`,filePath:V.data.file_path,amount:_,commission:A,total:W,recipientAmount:O,recipient:c.username,previousBalance:i,newBalance:S}),R(!0),d&&d({newBalance:S,previousBalance:i,amount:_,commission:A,total:W,recipientAmount:O}))}catch{R(!0),d&&d({newBalance:S,previousBalance:i,amount:_,commission:A,total:W,recipientAmount:O})}h({username:"",amount:"",message:"",recipient_id:null}),C(!1)}catch(P){u({general:P.response?.data?.error||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0435 \u0431\u0430\u043B\u043B\u043E\u0432"}),C(!1)}},disabled:!v.exists||!c.recipient_id||v.loading||!c.amount||k,startIcon:k?e.jsx(de,{size:20,color:"inherit"}):e.jsx(nt,{}),children:k?"\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0435 \u043F\u0435\u0440\u0435\u0432\u043E\u0434\u0430...":"\u041F\u0435\u0440\u0435\u0432\u0435\u0441\u0442\u0438 \u0431\u0435\u0437\u043E\u043F\u0430\u0441\u043D\u043E"})]})]})})};export{ct as A,nr as C,xt as D,dr as M,sr as N,zt as P,bt as R,zr as S,la as T,gr as U,De as a,je as b,Qr as c,Lr as d};

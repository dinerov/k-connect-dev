{"version":3,"file":"SharePreviewTest.DCb1dVxj.js","sources":["../../src/components/SharePreviewTest.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n  Box,\n  Typography,\n  TextField,\n  Button,\n  Paper,\n  Container,\n  Card,\n  CardContent,\n  CardMedia,\n  Divider,\n  List,\n  ListItem,\n  ListItemText\n} from '@mui/material';\n\n/**\n * Компонент для тестирования предпросмотра ссылок в K-Connect\n * Позволяет увидеть, как будут выглядеть ссылки в мессенджерах и соцсетях\n */\nconst SharePreviewTest = () => {\n  const [url, setUrl] = useState('');\n  const [previewData, setPreviewData] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const handleUrlChange = (e) => {\n    setUrl(e.target.value);\n  };\n\n  const fetchPreviewData = async () => {\n    if (!url) return;\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      \n      \n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      \n      const isRelative = !url.startsWith('http');\n      const fullUrl = isRelative \n        ? `${window.location.origin}${url.startsWith('/') ? '' : '/'}${url}` \n        : url;\n      \n      \n      const urlObj = new URL(fullUrl);\n      const path = urlObj.pathname;\n      \n      \n      let type = 'website';\n      let title = 'K-Connect';\n      let description = 'Социальная сеть от независимого разработчика';\n      let image = '/icon-512.png';\n      \n      if (path.includes('/post/')) {\n        type = 'article';\n        title = 'Пост пользователя';\n        description = 'Интересный пост в социальной сети K-Connect';\n        image = '/static/images/post_preview.jpg';\n      } else if (path.includes('/profile/')) {\n        type = 'profile';\n        const username = path.split('/').pop();\n        title = `Профиль @${username}`;\n        description = `Профиль пользователя ${username} в K-Connect`;\n        image = '/static/images/profile_preview.jpg';\n      } else if (path.includes('/music')) {\n        type = 'music';\n        title = 'Музыка в K-Connect';\n        description = 'Слушайте музыку в социальной сети K-Connect';\n        image = '/static/images/music_preview.jpg';\n      }\n      \n      setPreviewData({\n        url: fullUrl,\n        title,\n        description,\n        image,\n        type\n      });\n    } catch (err) {\n      console.error('Ошибка при получении данных для предпросмотра:', err);\n      setError('Не удалось получить данные для предпросмотра. Проверьте URL и попробуйте снова.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Container maxWidth=\"md\">\n      <Box sx={{ my: 4 }}>\n        <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n          Тестирование предпросмотра ссылок\n        </Typography>\n        \n        <Typography variant=\"body1\" paragraph>\n          Введите URL страницы K-Connect, чтобы увидеть, как она будет отображаться при шаринге в мессенджерах и соцсетях.\n        </Typography>\n        \n        <Box sx={{ display: 'flex', mb: 3 }}>\n          <TextField\n            fullWidth\n            label=\"URL страницы\"\n            value={url}\n            onChange={handleUrlChange}\n            placeholder=\"Например: /post/123 или /profile/username\"\n            variant=\"outlined\"\n            sx={{ mr: 2 }}\n          />\n          <Button\n            variant=\"contained\"\n            onClick={fetchPreviewData}\n            disabled={!url || loading}\n          >\n            {loading ? 'Загрузка...' : 'Проверить'}\n          </Button>\n        </Box>\n        \n        {error && (\n          <Typography color=\"error\" sx={{ mb: 2 }}>\n            {error}\n          </Typography>\n        )}\n        \n        {previewData && (\n          <Box>\n            <Typography variant=\"h6\" gutterBottom>\n              Превью ссылки:\n            </Typography>\n            \n            <Paper sx={{ mb: 3, overflow: 'hidden' }}>\n              <Box sx={{ p: 2, bgcolor: '#f5f5f5' }}>\n                <Typography variant=\"caption\" color=\"textSecondary\">\n                  Так будет выглядеть ссылка при шаринге:\n                </Typography>\n              </Box>\n              \n              <Card sx={{ display: 'flex', flexDirection: { xs: 'column', sm: 'row' }, border: '1px solid #eee' }}>\n                <CardMedia\n                  component=\"img\"\n                  sx={{ \n                    width: { xs: '100%', sm: 200 },\n                    height: { xs: 200, sm: 'auto' }\n                  }}\n                  image={previewData.image}\n                  alt={previewData.title}\n                />\n                <CardContent sx={{ flex: '1 0 auto' }}>\n                  <Typography variant=\"subtitle2\" color=\"textSecondary\" gutterBottom>\n                    {new URL(previewData.url).hostname}\n                  </Typography>\n                  <Typography variant=\"h6\" component=\"div\">\n                    {previewData.title}\n                  </Typography>\n                  <Typography variant=\"body2\" color=\"textSecondary\" sx={{ mt: 1 }}>\n                    {previewData.description}\n                  </Typography>\n                </CardContent>\n              </Card>\n            </Paper>\n            \n            <Typography variant=\"h6\" gutterBottom>\n              Мета-теги:\n            </Typography>\n            \n            <Paper>\n              <List>\n                <ListItem divider>\n                  <ListItemText\n                    primary=\"Заголовок (og:title)\"\n                    secondary={previewData.title}\n                  />\n                </ListItem>\n                <ListItem divider>\n                  <ListItemText\n                    primary=\"Описание (og:description)\"\n                    secondary={previewData.description}\n                  />\n                </ListItem>\n                <ListItem divider>\n                  <ListItemText\n                    primary=\"Изображение (og:image)\"\n                    secondary={previewData.image}\n                  />\n                </ListItem>\n                <ListItem divider>\n                  <ListItemText\n                    primary=\"URL (og:url)\"\n                    secondary={previewData.url}\n                  />\n                </ListItem>\n                <ListItem>\n                  <ListItemText\n                    primary=\"Тип (og:type)\"\n                    secondary={previewData.type}\n                  />\n                </ListItem>\n              </List>\n            </Paper>\n          </Box>\n        )}\n      </Box>\n    </Container>\n  );\n};\n\nexport default SharePreviewTest; "],"names":["SharePreviewTest","url","setUrl","useState","previewData","setPreviewData","loading","setLoading","error","setError","Container","maxWidth","children","jsxs","Box","sx","my","jsx","Typography","variant","component","gutterBottom","paragraph","display","mb","TextField","fullWidth","label","value","onChange","e","target","placeholder","mr","Button","onClick","async","Promise","resolve","setTimeout","fullUrl","startsWith","window","location","origin","path","URL","pathname","type","title","description","image","includes","username","split","pop","err","disabled","color","Paper","overflow","p","bgcolor","Card","flexDirection","xs","sm","border","CardMedia","width","height","alt","CardContent","flex","hostname","mt","List","ListItem","divider","ListItemText","primary","secondary"],"mappings":"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"}
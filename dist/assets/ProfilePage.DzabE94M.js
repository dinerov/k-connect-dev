import{j as e,i as o,r as De,a as Re,T as l,o as xe,b as Mt,g as At,s as T,w as G,ae as Tt,a0 as Lt,D as Ge,E as Je,J as Bt,l as le,k as ce,C as Pt,h as qe,G as J,P as he,a3 as se,q as Fe,v as Ht,t as We,af as Ke,A as Ee,ag as Ot,ah as Ut,ai as Se,m as Vt}from"./vendor-mui.08p3AH88.js";import{r as s,e as Yt,u as Nt,L as ae,a as Xt}from"./vendor-router.BRqU_Zs2.js";import{A as Qe,m as et,a as ee}from"./vendor.CL98q8z6.js";import{i as Q,r as Me,A as Ie,j as Zt,T as Gt,W as tt,P as Jt,c as qt,k as Kt,D as Qt,l as er}from"./index.CdVNWeFt.js";import{a as tr}from"./dateUtils.JaLtthGQ.js";import{A as rr,U as sr}from"./TransferMenu.2g5UFehs.js";import{V as ar}from"./index.CJUnh1z7.js";import{P as or}from"./PersonRemove.3f-UhM3t.js";import{C as ge}from"./Close.BG2YHWMj.js";import{L as rt,C as st}from"./Cake.Ds5sEyJA.js";import{L as ir}from"./Link.BmVIpf9S.js";import{M as Ae}from"./MusicNote.D4Jp3FIY.js";import{P as at,I as ot,M as nr}from"./PostSkeleton.NxbnrqQw.js";import{g as Te}from"./vendor-react.DF-_cTkv.js";import{D as lr}from"./Diamond.CBNwN0TB.js";import{C as it}from"./Chat.cmss1gek.js";import{B as cr}from"./Block.CDlxe_qq.js";import{P as we,V as dr}from"./Post.MP7_w9C7.js";import{A as pr}from"./Add.BKfOzMjp.js";import{V as nt,a as lt}from"./VolumeOff.CdPtQMO_.js";import{D as xr}from"./Delete.C47j6PO2.js";import{V as ct}from"./Visibility.Bq_lujd_.js";import"./thumbnails.CEJMDkxh.js";import"./History.BL_2VNvs.js";import"./Save.D4JlNQm5.js";import"./MoreVert.C0-1U5Ci.js";import"./Person.B_G_dVGx.js";import"./Send.DjUSpM3V.js";import"./SimpleImageViewer.DCWkQqHX.js";import"./Share.BKyVThZF.js";import"./imageUtils.BkCfy0de.js";import"./PlayArrow.GqmCGL4o.js";import"./Pause.r8mC42rq.js";import"./Edit.6-hI7nty.js";import"./Photo.tXKr-C4h.js";const ur=({tabIndex:a,children:i,containerSx:h={}})=>e.jsx(o,{sx:{position:"relative",overflow:"hidden",...h},children:e.jsx(Qe,{mode:"wait",initial:!1,children:e.jsx(et.div,{initial:{opacity:.95},animate:{opacity:1},exit:{opacity:.95},transition:{type:"tween",duration:.12,ease:"easeInOut"},children:i},a)})});var dt,ve={};function hr(){if(dt)return ve;dt=1;var a=De();Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=void 0;var i=a(Me()),h=Re();return ve.default=(0,i.default)((0,h.jsx)("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 16H5V8h14zM7 10h5v5H7z"}),"Today"),ve}const gr=Te(hr());var pt,_e={};function mr(){if(pt)return _e;pt=1;var a=De();Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=void 0;var i=a(Me()),h=Re();return _e.default=(0,i.default)((0,h.jsx)("path",{d:"M16 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8zM7 7h5v2H7zm10 10H7v-2h10zm0-4H7v-2h10zm-2-4V5l4 4z"}),"Feed"),_e}const xt=Te(mr()),br=({userId:a,statusColor:i})=>{const[h,t]=s.useState([]),[k,_]=s.useState(null),[R,f]=s.useState(!0),[z,M]=s.useState(!1),[S,w]=s.useState(!0),[A,v]=s.useState(1),[E,U]=s.useState(null),H=s.useRef(),X=s.useRef(!0),B=s.useRef(!1),{isAuthenticated:m}=s.useContext(Ie),y=window.location.pathname.includes("/profile/");s.useEffect(()=>(X.current=!0,()=>{X.current=!1}),[]);const F=s.useCallback(async I=>{if(!y||!I)return null;try{const n=await ee.get(`/api/profile/pinned_post/${I}`);return X.current&&n.data&&n.data.id?(_(n.data),n.data):(_(null),null)}catch{return _(null),null}},[y]),W=s.useCallback(async(I=1,n=null)=>{if(!B.current)try{B.current=!0,I===1?f(!0):M(!0),y&&I===1&&n&&await F(n);const c=await ee.get(`/api/profile/${a}/posts`,{params:{page:I,per_page:10},forceRefresh:!0});if(!X.current)return;if(c.data.posts&&Array.isArray(c.data.posts)){const b=c.data.posts;t(I===1?b:$=>[...Array.isArray($)?$:[],...b]),w(c.data.has_next)}else I===1&&t([]),w(!1)}catch(c){X.current&&(c.response&&c.response.status===401?U("\u0414\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430 \u043F\u043E\u0441\u0442\u043E\u0432 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u0430 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u044F"):U("\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u043F\u043E\u0441\u0442\u043E\u0432"))}finally{X.current&&(f(!1),M(!1),B.current=!1)}},[a,y,F]);s.useEffect(()=>{const I=async n=>{const{postId:c,isPinned:b}=n.detail;if(b){const $=h.find(P=>P.id===c);$&&_($)}else k&&k.id===c&&_(null);await F(),await W(1)};return window.addEventListener("post-pinned-state-changed",I),()=>{window.removeEventListener("post-pinned-state-changed",I)}},[F,W,h,k]),s.useEffect(()=>{if(a){v(1),t([]),_(null),w(!0);const I=window.location.pathname.split("/profile/")[1];W(1,I)}return()=>{H.current&&H.current.disconnect()}},[a,W]);const V=s.useCallback(I=>{R||z||!S||(H.current&&H.current.disconnect(),H.current=new IntersectionObserver(n=>{n[0].isIntersecting&&S&&!B.current&&v(c=>c+1)},{threshold:.5}),I&&H.current.observe(I))},[R,z,S]);s.useEffect(()=>{A>1&&W(A)},[A,W]);const Y=(I,n)=>{n?(t(c=>c.map(b=>b.id.toString()===I.toString()?n:b)),k&&k.id.toString()===I.toString()&&_(n)):(t(c=>c.filter(b=>b.id.toString()!==I.toString())),k&&k.id.toString()===I.toString()&&_(null))};return s.useEffect(()=>{const I=n=>{const c=n.detail;c&&c.user_id===parseInt(a)&&t(b=>[c,...b])};return window.addEventListener("post_created",I),()=>{window.removeEventListener("post_created",I)}},[a]),R&&h.length===0?e.jsx(o,{sx:{mt:2},children:[1,2,3].map((I,n)=>e.jsx(at,{},n))}):E?e.jsxs(o,{sx:{textAlign:"center",py:4,px:3,bgcolor:"background.paper",borderRadius:2,display:"flex",flexDirection:"column",alignItems:"center",gap:1},children:[e.jsx(xt,{sx:{fontSize:40,color:"text.secondary",mb:1}}),e.jsx(l,{variant:"h6",color:"text.primary",gutterBottom:!0,children:E==="\u0414\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430 \u043F\u043E\u0441\u0442\u043E\u0432 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u0430 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u044F"?"\u0414\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430 \u043F\u043E\u0441\u0442\u043E\u0432 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u0430 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u044F":"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430"}),e.jsx(l,{variant:"body1",color:"text.secondary",sx:{maxWidth:400},children:E==="\u0414\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430 \u043F\u043E\u0441\u0442\u043E\u0432 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u0430 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u044F"?"\u0412\u043E\u0439\u0434\u0438\u0442\u0435 \u0432 \u0430\u043A\u043A\u0430\u0443\u043D\u0442, \u0447\u0442\u043E\u0431\u044B \u043F\u0440\u043E\u0441\u043C\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044C \u043F\u043E\u0441\u0442\u044B \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439":E})]}):h.length!==0||R||k?e.jsxs(o,{sx:{mt:.5},children:[k&&e.jsx(o,{sx:{position:"relative"},children:e.jsx(we,{post:k,onDelete:Y,showActions:!0,isPinned:!0,statusColor:i})}),h.map((I,n)=>h.length===n+1?e.jsx(o,{ref:V,children:e.jsx(we,{post:I,onDelete:Y,showActions:!0,statusColor:i})},I.id):e.jsx(we,{post:I,onDelete:Y,showActions:!0,statusColor:i},I.id)),z&&e.jsx(o,{sx:{display:"flex",justifyContent:"center",my:2},children:e.jsx(xe,{size:24})}),!S&&h.length>5&&e.jsx(o,{sx:{textAlign:"center",py:2,mt:2},children:e.jsx(l,{variant:"body2",color:"text.secondary",children:"\u0412\u0441\u0435 \u043F\u043E\u0441\u0442\u044B \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B"})})]}):e.jsxs(o,{sx:{textAlign:"center",py:4,px:3,bgcolor:"background.paper",borderRadius:2,display:"flex",flexDirection:"column",alignItems:"center",gap:1},children:[e.jsx(xt,{sx:{fontSize:40,color:"text.secondary",mb:1}}),e.jsx(l,{variant:"h6",color:"text.primary",gutterBottom:!0,children:m?"\u0417\u0434\u0435\u0441\u044C \u043F\u043E\u043A\u0430 \u043F\u0443\u0441\u0442\u043E":"\u0414\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430 \u043F\u043E\u0441\u0442\u043E\u0432 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u0430 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u044F"}),e.jsx(l,{variant:"body1",color:"text.secondary",sx:{maxWidth:400},children:m?"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u0435\u0449\u0435 \u043D\u0435 \u0441\u043E\u0437\u0434\u0430\u043B \u043D\u0438 \u043E\u0434\u043D\u043E\u0433\u043E \u043F\u043E\u0441\u0442\u0430":"\u0412\u043E\u0439\u0434\u0438\u0442\u0435 \u0432 \u0430\u043A\u043A\u0430\u0443\u043D\u0442, \u0447\u0442\u043E\u0431\u044B \u043F\u0440\u043E\u0441\u043C\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044C \u043F\u043E\u0441\u0442\u044B \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439"})]})},fr=({userId:a})=>{const[i,h]=s.useState([]),[t,k]=s.useState(!0),[_,R]=s.useState(!1),[f,z]=s.useState(!0),[M,S]=s.useState(1),[w,A]=s.useState(null),v=s.useRef(),E=s.useRef(!0),U=s.useRef(!1);s.useEffect(()=>(E.current=!0,()=>{E.current=!1}),[]);const H=s.useCallback(async(m=1)=>{if(!U.current)try{U.current=!0,m===1?k(!0):R(!0);const y=await ee.get(`/api/profile/${a}/wall`,{params:{page:m,per_page:10}});if(!E.current)return;y.data.posts&&Array.isArray(y.data.posts)?(h(m===1?y.data.posts:F=>[...F,...y.data.posts]),z(y.data.has_next)):(m===1&&h([]),z(!1))}catch{E.current&&(m===1&&h([]),A("\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0437\u0430\u043F\u0438\u0441\u0435\u0439 \u0441\u0442\u0435\u043D\u044B"))}finally{E.current&&(k(!1),R(!1),U.current=!1)}},[a]);s.useEffect(()=>(a&&(S(1),h([]),z(!0),H(1)),()=>{v.current&&v.current.disconnect()}),[a,H]);const X=s.useCallback(m=>{t||_||!f||(v.current&&v.current.disconnect(),v.current=new IntersectionObserver(y=>{y[0].isIntersecting&&f&&!U.current&&S(F=>F+1)},{threshold:.5}),m&&v.current.observe(m))},[t,_,f]);s.useEffect(()=>{M>1&&H(M)},[M,H]);const B=(m,y)=>{h(y?F=>F.map(W=>W.id.toString()===m.toString()?y:W):F=>F.filter(W=>W.id.toString()!==m.toString()))};return s.useEffect(()=>{const m=y=>{const F=y.detail;F.type==="stena"&&F.recipient_id===parseInt(a)&&h(W=>[F,...W])};return window.addEventListener("post_created",m),()=>{window.removeEventListener("post_created",m)}},[a]),t&&i.length===0?e.jsx(o,{sx:{mt:2},children:[1,2,3].map((m,y)=>e.jsx(at,{},y))}):w?e.jsx(o,{sx:{textAlign:"center",py:3,bgcolor:"background.paper",borderRadius:2,mt:2},children:e.jsx(l,{color:"error",children:w})}):i.length!==0||t?e.jsxs(o,{sx:{mt:.5},children:[i.map((m,y)=>i.length===y+1?e.jsx(o,{ref:X,children:e.jsx(we,{post:m,onDelete:B,showActions:!0})},m.id):e.jsx(we,{post:m,onDelete:B,showActions:!0},m.id)),_&&e.jsx(o,{sx:{display:"flex",justifyContent:"center",my:2},children:e.jsx(xe,{size:24})}),!f&&i.length>5&&e.jsx(o,{sx:{textAlign:"center",py:2,mt:2},children:e.jsx(l,{variant:"body2",color:"text.secondary",children:"\u0412\u0441\u0435 \u0437\u0430\u043F\u0438\u0441\u0438 \u0441\u0442\u0435\u043D\u044B \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B"})})]}):e.jsx(o,{sx:{textAlign:"center",py:6,bgcolor:"background.paper",borderRadius:2,mt:2},children:e.jsx(l,{variant:"h6",color:"text.secondary",children:"\u041D\u0430 \u0441\u0442\u0435\u043D\u0435 \u043F\u043E\u043A\u0430 \u043D\u0435\u0442 \u0437\u0430\u043F\u0438\u0441\u0435\u0439"})})};var ut,Ce={};function yr(){if(ut)return Ce;ut=1;var a=De();Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.default=void 0;var i=a(Me()),h=Re();return Ce.default=(0,i.default)((0,h.jsx)("path",{d:"M17 7h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c1.65 0 3 1.35 3 3s-1.35 3-3 3h-3c-.55 0-1 .45-1 1s.45 1 1 1h3c2.76 0 5-2.24 5-5s-2.24-5-5-5m-9 5c0 .55.45 1 1 1h6c.55 0 1-.45 1-1s-.45-1-1-1H9c-.55 0-1 .45-1 1m2 3H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h3c.55 0 1-.45 1-1s-.45-1-1-1H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h3c.55 0 1-.45 1-1s-.45-1-1-1"}),"LinkRounded"),Ce}const jr=Te(yr()),ht=async a=>{if(a)return Q.post(`/api/stories/${a}/view`)},gt=async a=>{if(a)return Q.delete(`/api/stories/${a}`)},mt=async(a,i)=>{if(a&&i)return Q.post(`/api/stories/${a}/reaction`,{emoji:i})},wr=["\u2764\uFE0F","\u{1F602}","\u{1F62E}","\u{1F622}","\u{1F525}"],vr=T(o)(({theme:a})=>({position:"absolute",left:"50%",bottom:"10%",transform:"translateX(-50%)",display:"flex",gap:12,zIndex:20,background:"rgba(30,30,30,0.95)",borderRadius:24,padding:"8px 16px",boxShadow:"0 2px 12px rgba(0,0,0,0.18)",alignItems:"center",maxWidth:"90%",backdropFilter:"blur(8px)",border:"1px solid rgba(255,255,255,0.1)"})),_r=T(G)(({theme:a,selected:i})=>({fontSize:28,transition:"transform 0.25s cubic-bezier(.4,2,.6,1)",transform:i?"translateY(-18px) scale(1.25)":"none",filter:i?"drop-shadow(0 4px 12px rgba(0,0,0,0.25))":"none",background:i?"rgba(255,255,255,0.08)":"none",border:i?`2px solid ${a.palette.primary.main}`:"none",zIndex:i?2:1,color:i?a.palette.primary.main:"inherit","&:hover":{background:"rgba(255,255,255,0.12)",transform:"translateY(-8px) scale(1.1)"}})),Cr=T(o)(({theme:a})=>({position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",zIndex:1300,display:"flex",alignItems:"center",justifyContent:"center",[a.breakpoints.up("sm")]:{backgroundColor:"rgba(0, 0, 0, 0.85)"}})),kr=T(o)(({theme:a,$isMobile:i})=>({width:i?"100vw":"auto",height:i?"100vh":"auto",display:"flex",flexDirection:"column",position:"relative",borderRadius:16,overflow:"hidden",background:"rgba(0,0,0,0.95)",minWidth:i?"100vw":420,minHeight:i?"100vh":0,maxWidth:i?"100vw":420,maxHeight:i?"100vh":"90vh",aspectRatio:i?void 0:"9/16"})),bt=T(o)(({theme:a,imageUrl:i})=>({position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:`url(${i})`,backgroundSize:"cover",backgroundPosition:"center",filter:"blur(20px)",transform:"scale(1.05)",zIndex:-1,opacity:1})),Sr=T(o)(({theme:a})=>({display:"flex",gap:4,padding:16,position:"absolute",top:0,left:0,right:0,zIndex:10})),Ir=T(o)(({theme:a,progress:i})=>({flex:1,height:2,backgroundColor:"rgba(255, 255, 255, 0.3)",borderRadius:2,overflow:"hidden","&::after":{content:'""',display:"block",height:"100%",width:`${i}%`,backgroundColor:a.palette.primary.main,transition:"width 0.1s linear"}})),zr=T(o)(({theme:a})=>({flex:1,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",zIndex:1,height:"100%",maxHeight:"100%",overflow:"hidden"})),$r=T("img")(({theme:a})=>({width:"100%",height:"100%",objectFit:"contain",position:"relative",zIndex:1,maxWidth:"100%",maxHeight:"100%"})),Dr=T("video")(({theme:a})=>({width:"100%",height:"100%",objectFit:"contain",position:"relative",zIndex:1,maxWidth:"100%",maxHeight:"100%"})),ft=T(o)(({theme:a})=>({position:"absolute",bottom:16,right:16,display:"flex",alignItems:"center",gap:1,zIndex:5,backgroundColor:"rgba(0, 0, 0, 0.5)",padding:"4px 8px",borderRadius:"20px",backdropFilter:"blur(4px)",maxHeight:"calc(100% - 32px)"}));T(G)(({theme:a})=>({position:"absolute",top:"50%",transform:"translateY(-50%)",color:"white",backgroundColor:"rgba(0, 0, 0, 0.3)",zIndex:5,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.5)"}}));const Rr=T(o)(({theme:a})=>({position:"absolute",top:0,left:0,right:0,padding:16,display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:10})),Fr=T(o)(({theme:a})=>({display:"flex",alignItems:"center",gap:1,zIndex:1,maxWidth:"calc(100% - 80px)"})),Wr=T(ce)(({theme:a})=>({width:32,height:32,border:`2px solid ${a.palette.primary.main}`,flexShrink:0})),yt=T(o)(({theme:a})=>({position:"absolute",top:0,bottom:0,width:"50%",zIndex:2,cursor:"pointer",height:"100%"})),Er=(a,i)=>{let h;if(i)h=new Date(i);else{if(!a)return"";h=new Date(1e3*a)}if(isNaN(h.getTime()))return"";const t=new Date().getTime()-h.getTime(),k=36e5;return t<0?"\u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043C":t<6e4?"\u0442\u043E\u043B\u044C\u043A\u043E \u0447\u0442\u043E":t<k?`${Math.floor(t/6e4)}\u043C`:t<864e5?`${Math.floor(t/k)}\u0447`:h.toLocaleString(void 0,{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},Mr=({open:a,onClose:i,storyId:h})=>{const[t,k]=s.useState(!1),[_,R]=s.useState([]);return s.useEffect(()=>{a&&(k(!0),(async f=>{if(!f)return[];const z=await Q.get(`/api/stories/${f}/reactions`);return z.data&&z.data.reactions?z.data.reactions:[]})(h).then(f=>{R(f)}).finally(()=>k(!1)))},[a,h]),e.jsxs(Ge,{open:a,onClose:i,maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{background:"rgba(24, 24, 28, 0.98)",backdropFilter:"blur(8px)",boxShadow:"0 4px 32px rgba(0,0,0,0.25)"}},children:[e.jsxs(Je,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:"\u0420\u0435\u0430\u043A\u0446\u0438\u0438 \u043D\u0430 \u0438\u0441\u0442\u043E\u0440\u0438\u044E"}),e.jsx(o,{sx:{flex:1}}),e.jsx(G,{onClick:i,children:e.jsx(ge,{})})]}),e.jsx(o,{sx:{px:2,pt:1},children:t?e.jsx(o,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(xe,{})}):_.length===0?e.jsx(l,{color:"text.secondary",align:"center",sx:{py:4},children:"\u041D\u0435\u0442 \u0440\u0435\u0430\u043A\u0446\u0438\u0439"}):e.jsx(o,{children:_.map(f=>e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2,py:1},children:[e.jsx(ce,{src:f.photo?`/static/uploads/avatar/${f.user_id}/${f.photo}`:void 0}),e.jsxs(o,{children:[e.jsx(l,{sx:{fontWeight:500},children:f.name||f.username}),e.jsxs(l,{variant:"caption",color:"text.secondary",children:["@",f.username]})]}),e.jsx(o,{sx:{ml:"auto",fontSize:22},children:f.emoji})]},f.user_id+f.emoji))})}),e.jsx(o,{sx:{height:8}})]})},Ar=({userStories:a,currentUserIndex:i,setCurrentUserIndex:h,onClose:t,currentUserId:k,onStoryDeleted:_,isMuted:R,onToggleSound:f,isMobile:z,onStoryViewed:M,onNextUser:S})=>{const[w,A]=s.useState([]),[v,E]=s.useState(0),[U,H]=s.useState(0),[X,B]=s.useState(!1),m=s.useRef(null),y=s.useRef(null),F=Mt();s.useRef(new Set);const{user:W}=Zt(),V=At(F.breakpoints.down("sm")),Y=s.useRef(new Set),[I,n]=s.useState(null),[c,b]=s.useState(!1),[$,P]=s.useState(!1),[L,q]=s.useState(null),[te,Z]=s.useState(null),[oe,re]=s.useState(!1),[me,de]=s.useState(!1),ie=s.useRef(),pe=s.useRef();s.useEffect(()=>{const x=a?.user?.id,D=a?.stories?.length;ie.current!==x||pe.current!==D?(A(a.stories||[]),E(0),H(0),ie.current=x,pe.current=D):a&&a.stories&&A(a.stories)},[a]),s.useEffect(()=>{var x;return w.length>0&&v<w.length&&((x=w[v].id)&&(Y.current.has(x)||(Y.current.add(x),M?.(x))),ne()),()=>{m.current&&clearInterval(m.current)}},[v,w]);const ne=()=>{m.current&&clearInterval(m.current),H(0);const x=w[v]?.media_url?.match(/\.(mp4|webm|mov)$/i),D=x?1e3*(y.current?.duration||5):5e3;m.current=setInterval(()=>{H(K=>K>=100?(clearInterval(m.current),be(),0):K+100/(D/100))},100)},be=()=>{v<w.length-1?E(x=>x+1):S?S():t()},ue=x=>{const{clientX:D}=x,{left:K,width:fe}=x.currentTarget.getBoundingClientRect();D-K<fe/2?v>0&&E(Be=>Be-1):be()},d=()=>{m.current&&clearInterval(m.current),t()};if(s.useEffect(()=>{b(!1)},[v,w]),s.useEffect(()=>{w.length>0&&v<w.length&&w[v]?.media_url&&c&&n(w[v].media_url)},[c,v,w]),s.useEffect(()=>{P(!1),Z(null),re(!1),w[v]&&w[v].user_reaction?q(w[v].user_reaction):q(null)},[v,w]),!w.length)return null;const u=w[v],p=a?.user||{},g=u?.media_url?.match(/\.(jpg|jpeg|png|gif|webp)$/i)?"image":u?.media_url?.match(/\.(mp4|mov|webm)$/i)?"video":null,C=W?.id===p.id;return e.jsxs(Cr,{onClick:d,children:[e.jsxs(kr,{$isMobile:V||z,onClick:x=>x.stopPropagation(),children:[e.jsx(Sr,{children:w.map((x,D)=>e.jsx(Ir,{progress:D===v?U:D<v?100:0},D))}),e.jsxs(Rr,{children:[e.jsxs(Fr,{children:[e.jsx(Wr,{src:p.photo?`/static/uploads/avatar/${p.id}/${p.photo}`:void 0,alt:p.name||"User"}),e.jsxs(o,{sx:{overflow:"hidden"},children:[e.jsx(l,{variant:"subtitle1",color:"white",sx:{fontWeight:600,lineHeight:1.2,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:p.name||p.username||"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C"}),e.jsx(l,{variant:"caption",color:"rgba(255, 255, 255, 0.7)",sx:{lineHeight:1.2,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:Er(u?.created_at_unix,u?.created_at_utc)})]})]}),e.jsxs(o,{children:[W?.id===p.id&&e.jsx(G,{onClick:x=>{x.stopPropagation(),B(!0)},sx:{color:"white",mr:1},children:e.jsx(xr,{})}),e.jsx(G,{onClick:x=>{x.stopPropagation(),d()},sx:{color:"white"},children:e.jsx(ge,{})})]})]}),e.jsxs(zr,{sx:{position:"relative"},children:[I&&e.jsx(bt,{style:{backgroundImage:`url(${I})`,opacity:c?0:1,zIndex:0,transition:"opacity 0.3s"}}),u?.media_url&&e.jsx(bt,{style:{backgroundImage:`url(${u.media_url})`,opacity:c?1:0,zIndex:1,transition:"opacity 0.3s"},children:e.jsx("img",{src:u.media_url,style:{display:"none"},onLoad:()=>b(!0),alt:"preload"})}),e.jsx(yt,{style:{left:0},onClick:ue}),e.jsx(yt,{style:{right:0,left:"auto"},onClick:ue}),g==="image"?e.jsxs(e.Fragment,{children:[e.jsx($r,{src:u?.media_url,alt:"Story",onLoad:ne}),e.jsxs(ft,{children:[e.jsx(ct,{sx:{color:"white",fontSize:"1rem"}}),e.jsx(l,{variant:"caption",sx:{color:"white",fontSize:"0.75rem",ml:.5},children:u?.view_count||0})]})]}):g==="video"?e.jsxs(e.Fragment,{children:[e.jsx(Dr,{ref:y,src:u?.media_url,loop:!0,autoPlay:!0,playsInline:!0,muted:R,onLoadedData:ne}),e.jsxs(ft,{children:[e.jsx(ct,{sx:{color:"white",fontSize:"1rem"}}),e.jsx(l,{variant:"caption",sx:{color:"white",fontSize:"0.75rem",ml:.5},children:u?.view_count||0}),e.jsx(G,{onClick:f,sx:{color:"white","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"},width:32,height:32,padding:0},children:R?e.jsx(nt,{fontSize:"small"}):e.jsx(lt,{fontSize:"small"})})]})]}):null,e.jsxs(o,{sx:{position:"absolute",left:"50%",bottom:24,transform:"translateX(-50%)",zIndex:20},children:[e.jsx(G,{onClick:C?()=>de(!0):x=>{x.stopPropagation(),P(D=>!D),Z(x.currentTarget)},sx:{fontSize:28,background:L?"rgba(255,255,255,0.08)":"rgba(30,30,30,0.7)",border:L?`2px solid ${F.palette.primary.main}`:"none",color:L?F.palette.primary.main:"inherit",transition:"all 0.2s",boxShadow:L?"0 2px 12px rgba(0,0,0,0.18)":"none"},children:L||"\u{1F60A}"}),!C&&e.jsx(Tt,{open:$,anchorEl:te,placement:"top",transition:!0,disablePortal:!0,children:({TransitionProps:x})=>e.jsx(Lt,{...x,timeout:200,children:e.jsx(vr,{children:wr.map(D=>e.jsx(_r,{selected:L===D,onClick:()=>(async K=>{if(!oe){re(!0);try{L===K?(await mt(u.id,K),q(null)):(await mt(u.id,K),q(K)),P(!1)}finally{re(!1)}}})(D),disabled:oe,children:D},D))})})})]})]})]}),e.jsxs(Ge,{open:X,onClose:()=>B(!1),children:[e.jsx(Je,{children:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0438\u0441\u0442\u043E\u0440\u0438\u044E?"}),e.jsxs(Bt,{children:[e.jsx(le,{onClick:()=>B(!1),color:"primary",children:"\u041E\u0442\u043C\u0435\u043D\u0430"}),e.jsx(le,{onClick:async()=>{try{const x=w[v].id;await gt(x),B(!1);const D=w.filter((K,fe)=>fe!==v);D.length===0?(_&&_(x),t()):(A(D),v>=D.length&&E(D.length-1),_&&_(x)),window.dispatchEvent(new CustomEvent("show-error",{detail:{message:"\u0418\u0441\u0442\u043E\u0440\u0438\u044F \u0443\u0434\u0430\u043B\u0435\u043D\u0430",shortMessage:"\u0423\u0434\u0430\u043B\u0435\u043D\u043E",notificationType:"success",animationType:"pill"}}))}catch{window.dispatchEvent(new CustomEvent("show-error",{detail:{message:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u0438\u0441\u0442\u043E\u0440\u0438\u0438",shortMessage:"\u041E\u0448\u0438\u0431\u043A\u0430",notificationType:"error",animationType:"pill"}}))}},color:"error",variant:"contained",children:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"})]})]}),e.jsx(Mr,{open:me,onClose:()=>de(!1),storyId:u?.id})]})},jt=T(Pt)(({theme:a})=>({borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.03)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:a.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.1)":"1px solid rgba(0, 0, 0, 0.1)",marginBottom:0})),Tr=T(o)(({theme:a})=>({display:"flex",gap:2,overflowX:"auto",padding:"16px","&::-webkit-scrollbar":{height:"0px",display:"none"},"&::-webkit-scrollbar-thumb":{backgroundColor:"transparent"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},msOverflowStyle:"none",scrollbarWidth:"none"})),wt=T(o)(({theme:a,hasStory:i})=>({display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer",position:"relative","&:hover":{transform:"scale(1.02)",transition:"transform 0.2s ease"}})),Lr=T(o)(({theme:a})=>({width:64,height:64,borderRadius:"50%",overflow:"hidden",border:`2px solid ${a.palette.primary.main}`,background:a.palette.background.paper,"&::before":{content:'""',position:"absolute",top:-2,left:-2,right:-2,bottom:-2,borderRadius:"50%",zIndex:-1}})),Br=T(G)(({theme:a})=>({width:64,height:64,border:`2px solid ${a.palette.primary.main}`,backgroundColor:a.palette.background.paper,"&:hover":{backgroundColor:"rgba(208, 188, 255, 0.1)"}}));T(o)(({theme:a})=>({position:"absolute",bottom:16,left:0,right:0,display:"flex",justifyContent:"center",gap:16,zIndex:100}));const Pr=({userIdentifier:a=null})=>{const{stories:i,loading:h,loadStories:t,setStories:k}=function(n=null){const[c,b]=s.useState([]),[$,P]=s.useState(!1),[L,q]=s.useState(null);return{stories:c,loading:$,error:L,loadStories:s.useCallback(async()=>{P(!0),q(null);try{const te=n?await(async Z=>{const oe=await Q.get(`/api/stories/user/${Z}`);return oe.data&&oe.data.stories?[oe.data]:[]})(n):await(async()=>{const Z=await Q.get("/api/stories/feed");return Z.data&&Z.data.stories?Z.data.stories:[]})();b(te)}catch(te){q(te)}finally{P(!1)}},[n]),setStories:b}}(a),{publish:_}=function(){const[n,c]=s.useState(!1),[b,$]=s.useState(null);return{publish:s.useCallback(async P=>{c(!0),$(null);try{return await(async q=>{const te=new FormData;return te.append("media",q),(await Q.post("/api/stories",te,{headers:{"Content-Type":"multipart/form-data"}})).data})(P)}catch(L){throw $(L),L}finally{c(!1)}},[]),view:s.useCallback(async P=>{try{await ht(P)}catch{}},[]),remove:s.useCallback(async P=>{c(!0),$(null);try{await gt(P)}catch(L){throw $(L),L}finally{c(!1)}},[]),actionLoading:n,actionError:b}}(),[R,f]=s.useState(null),[z,M]=s.useState(null),[S,w]=s.useState(null),[A,v]=s.useState(!0),[E,U]=s.useState(!1),[H,X]=s.useState(new Set),B=s.useRef(null),m=s.useRef(null),{user:y}=s.useContext(Ie);if(!(a||y&&y.account_type==="user"))return null;const F=a===y?.id;s.useEffect(()=>{const n=()=>{U(window.matchMedia("(max-width: 600px)").matches)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),s.useEffect(()=>{if(!E||!m.current)return;const n=b=>{b.target.volume>0&&v(!1)},c=m.current;return c.addEventListener("volumechange",n),()=>{c.removeEventListener("volumechange",n)}},[E]),s.useEffect(()=>{t()},[t]),s.useEffect(()=>{i&&i.length!==0&&X(()=>{const n=new Set;return i.forEach(c=>{c.stories.forEach(b=>{b.view_count>0&&n.add(b.id)})}),n})},[i&&i.length>0]);const W=s.useMemo(()=>i&&i.length!==0?i.flatMap(n=>n.stories.map(c=>({...c,user:n.user}))).sort((n,c)=>{const b=n.view_count>0;if(b!==c.view_count>0)return b?1:-1;const $=new Date(n.created_at_utc||n.created_at);return new Date(c.created_at_utc||c.created_at)-$}):[],[i]),V=()=>{M(null),w(null),B.current&&(B.current.value="")},Y=n=>{n.stopPropagation(),v(!A)},I=z?.type.startsWith("video")?"video":"image";return h?e.jsx(jt,{children:e.jsxs(o,{sx:{p:2,display:"flex",alignItems:"center"},children:[e.jsx(xe,{size:20,sx:{mr:2}}),e.jsx(l,{variant:"h6",sx:{fontSize:"1.1rem"},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430..."})]})}):h||F||i&&i.length!==0?e.jsxs(e.Fragment,{children:[e.jsxs(jt,{children:[e.jsxs(Tr,{children:[e.jsx("input",{type:"file",ref:B,onChange:n=>{const c=n.target.files[0];c&&(M(c),w(URL.createObjectURL(c)))},accept:"image/*,video/*",style:{display:"none"}}),F&&e.jsx(wt,{children:e.jsx(Br,{onClick:()=>{B.current?.click()},children:e.jsx(pr,{color:"primary"})})}),W.map(n=>e.jsx(wt,{onClick:()=>(c=>{const b=W.findIndex($=>$.id===c);f(b)})(n.id),children:e.jsx(Lr,{children:n.preview_url?e.jsx(o,{component:"img",src:n.preview_url,alt:"story preview",sx:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(o,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent"},children:e.jsx(dr,{sx:{color:"primary.main",fontSize:32}})})})},n.id))]}),z&&S&&e.jsx(o,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:2e3,background:"rgba(0,0,0,0.9)",display:"flex",alignItems:"center",justifyContent:"center"},onClick:V,children:e.jsxs(o,{onClick:n=>n.stopPropagation(),sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative",borderRadius:2,overflow:"hidden",maxWidth:400,maxHeight:600},children:[e.jsx(o,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:`url(${S})`,backgroundSize:"cover",backgroundPosition:"center",filter:"blur(20px)",transform:"scale(1.05)",zIndex:-1,opacity:1}}),e.jsxs(o,{sx:{position:"absolute",top:0,left:0,right:0,padding:2,display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:10},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,zIndex:1,maxWidth:"calc(100% - 80px)"},children:[e.jsx(ce,{src:y?.photo?`/static/uploads/avatar/${y.id}/${y.photo}`:void 0,alt:y?.name||"You",sx:{width:32,height:32,border:n=>`2px solid ${n.palette.primary.main}`,flexShrink:0}}),e.jsx(o,{sx:{overflow:"hidden"},children:e.jsx(l,{variant:"subtitle1",color:"white",sx:{fontWeight:600,lineHeight:1.2,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:y?.name||"\u0412\u0430\u0448\u0430 \u0438\u0441\u0442\u043E\u0440\u0438\u044F"})})]}),e.jsx(G,{onClick:n=>{n.stopPropagation(),V()},sx:{color:"white",zIndex:1},children:e.jsx(ge,{})})]}),e.jsx(o,{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:I==="image"?e.jsx(o,{component:"img",src:S,alt:"preview",sx:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",position:"relative",zIndex:1}}):e.jsxs(e.Fragment,{children:[e.jsx(o,{component:"video",ref:m,src:S,loop:!0,autoPlay:!0,playsInline:!0,muted:A,sx:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",position:"relative",zIndex:1}}),e.jsx(o,{sx:{position:"absolute",bottom:16,right:16,display:"flex",alignItems:"center",gap:1,zIndex:1e3},children:e.jsx(G,{onClick:Y,sx:{color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"},width:32,height:32,padding:0},children:A?e.jsx(nt,{fontSize:"small"}):e.jsx(lt,{fontSize:"small"})})})]})}),e.jsxs(o,{sx:{position:"absolute",bottom:16,left:0,right:0,display:"flex",justifyContent:"center",gap:2,zIndex:100},children:[e.jsx(le,{variant:"contained",color:"primary",onClick:n=>{n.stopPropagation(),(async()=>{if(z)try{await _(z),await t(),V()}catch{alert("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0438\u0441\u0442\u043E\u0440\u0438\u0438")}})()},children:"\u041E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u0442\u044C"}),e.jsx(le,{variant:"outlined",color:"secondary",onClick:n=>{n.stopPropagation(),V()},children:"\u041E\u0442\u043C\u0435\u043D\u0430"})]})]})})]}),R!==null&&W[R]&&e.jsx(Ar,{userStories:{user:W[R].user,stories:[W[R]]},currentUserIndex:0,setCurrentUserIndex:f,onClose:()=>{f(null)},currentUserId:W[R]?.user?.id,onStoryDeleted:n=>{k(c=>{const b=c.map(($,P)=>P!==R?$:{...$,stories:$.stories.filter(L=>L.id!==n)}).filter($=>$.stories.length>0);return b.length>0&&(!b[R]||b[R].stories.length===0)?f($=>$<b.length?$:null):b.length===0&&f(null),b})},isMuted:A,onToggleSound:Y,isMobile:E,onStoryViewed:async n=>{X(c=>new Set([...c,n]));try{await ht(n),k(c=>c.map(b=>({...b,stories:b.stories.map($=>$.id===n?{...$,view_count:($.view_count||0)+1}:$)})))}catch{}},onNextUser:()=>{R<W.length-1?f(R+1):f(null)}})]}):null},Hr=T(Vt)(({theme:a})=>({"& .MuiInputBase-root":{background:a.palette.mode==="dark"?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0.03)",backdropFilter:"blur(5px)",borderRadius:"12px",border:a.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.05)":"1px solid rgba(0, 0, 0, 0.05)",fontSize:"0.95rem",padding:a.spacing(1,1.5),color:a.palette.text.primary,transition:"all 0.3s ease","&:hover":{borderColor:"rgba(208, 188, 255, 0.3)",background:a.palette.mode==="dark"?"rgba(0, 0, 0, 0.25)":"rgba(0, 0, 0, 0.05)"},"&.Mui-focused":{borderColor:"rgba(208, 188, 255, 0.5)",boxShadow:"0 0 0 2px rgba(208, 188, 255, 0.1)"}},"& .MuiOutlinedInput-notchedOutline":{border:"none"},width:"100%"})),Or=T(o)(({theme:a})=>({display:"flex",justifyContent:"space-between",padding:a.spacing(1.5,0,0),borderTop:"1px solid rgba(255, 255, 255, 0.05)",marginTop:a.spacing(1.5)})),Ur=T(le)(({theme:a})=>({borderRadius:"18px",textTransform:"none",fontSize:"0.6rem",fontWeight:600,boxShadow:"0 2px 8px rgba(124, 77, 255, 0.25)",padding:a.spacing(.4,1.5),background:a.palette.mode==="dark"?"linear-gradient(90deg, rgb(180 163 220) 0%, rgb(177 161 216) 100%)":"linear-gradient(90deg, rgb(124 77 255) 0%, rgb(148 108 255) 100%)",color:a.palette.mode==="dark"?"#000":"#fff","&:hover":{boxShadow:"0 4px 12px rgba(124, 77, 255, 0.35)"},"&.Mui-disabled":{background:a.palette.mode==="dark"?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.05)",color:a.palette.mode==="dark"?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.3)"}})),vt=({onPostCreated:a,postType:i="post",recipientId:h=null})=>{const{user:t}=s.useContext(Ie),{playTrack:k,currentTrack:_,isPlaying:R,togglePlay:f}=s.useContext(Kt),[z,M]=s.useState(""),[S,w]=s.useState([]),[A,v]=s.useState(""),[E,U]=s.useState([]),[H,X]=s.useState(!1),[B,m]=s.useState(""),y=s.useRef(null),[F,W]=s.useState(!1),[V,Y]=s.useState({open:!1,message:""}),[I,n]=s.useState(!1),[c,b]=s.useState([]),[$,P]=s.useState({open:!1,message:"",severity:"error"}),[L,q]=s.useState({open:!1,message:"",timeRemaining:0}),[te,Z]=s.useState(!1),[oe,re]=s.useState(""),me=157286400,de=52428800,ie=["image/jpeg","image/png","image/gif","image/webp","image/heic","image/heif"],pe=["video/mp4","video/webm","video/quicktime","video/x-msvideo","video/x-matroska"];s.useEffect(()=>{B&&m("")},[z,S,c,B]);const ne=s.useRef(0),be=d=>{if(!d.length)return;const u=Array.from(d).filter(C=>{const x=ie.includes(C.type),D=pe.includes(C.type);return!(!x&&!D&&(window.dispatchEvent(new CustomEvent("showError",{detail:{message:`\u041D\u0435\u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043C\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u0444\u0430\u0439\u043B\u0430: ${C.name}. \u0420\u0430\u0437\u0440\u0435\u0448\u0435\u043D\u044B \u0442\u043E\u043B\u044C\u043A\u043E \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F (JPEG, PNG, GIF, WEBP) \u0438 \u0432\u0438\u0434\u0435\u043E (MP4, WEBM, MOV, AVI, MKV)`,severity:"error"}})),1))});if(u.length===0)return;const p=u.filter(C=>ie.includes(C.type)),g=u.filter(C=>pe.includes(C.type));if(A==="video"&&p.length>0)Y({open:!0,message:"\u041D\u0435\u043B\u044C\u0437\u044F \u043F\u0440\u0438\u043A\u0440\u0435\u043F\u0438\u0442\u044C \u0444\u043E\u0442\u043E \u0438 \u0432\u0438\u0434\u0435\u043E \u043E\u0434\u043D\u043E\u0432\u0440\u0435\u043C\u0435\u043D\u043D\u043E"});else if(A==="image"&&g.length>0)Y({open:!0,message:"\u041D\u0435\u043B\u044C\u0437\u044F \u043F\u0440\u0438\u043A\u0440\u0435\u043F\u0438\u0442\u044C \u0444\u043E\u0442\u043E \u0438 \u0432\u0438\u0434\u0435\u043E \u043E\u0434\u043D\u043E\u0432\u0440\u0435\u043C\u0435\u043D\u043D\u043E"});else{if(g.length>0){w([g[0]]),v("video");const C=new FileReader;return C.onloadend=()=>{U([C.result])},void C.readAsDataURL(g[0])}if(p.length>0){w(x=>[...x,...p]),v("image");const C=[];p.forEach(x=>{const D=new FileReader;D.onloadend=()=>{C.push(D.result),C.length===p.length&&U(K=>[...K,...C])},D.readAsDataURL(x)})}}},ue=async()=>{if(z.trim()||S.length!==0||c.length!==0)try{X(!0),m("");const d=new FormData;if(d.append("content",z.trim()),i&&i!=="post"&&d.append("type",i),h&&d.append("recipient_id",h),A==="image"?S.forEach((p,g)=>{d.append(`images[${g}]`,p)}):A==="video"&&d.append("video",S[0]),c.length>0){const p=c.map(g=>({id:g.id,title:g.title,artist:g.artist,duration:g.duration,file_path:g.file_path,cover_path:g.cover_path}));d.append("music",JSON.stringify(p))}const u=await(async p=>{try{const g=p instanceof FormData?p:new FormData;p instanceof FormData||typeof p!="object"||(p.content&&g.append("content",p.content),Array.isArray(p.images)&&p.images.forEach((C,x)=>{g.append(`images[${x}]`,C)}),p.image&&p.image instanceof File&&g.append("image",p.image),p.video&&p.video instanceof File&&g.append("video",p.video),p.music&&Array.isArray(p.music)&&p.music.length>0&&g.append("music",JSON.stringify(p.music)));for(let[C,x]of g.entries());try{const C=await Q.post("/api/posts/create",g,{headers:{"Content-Type":"multipart/form-data"},_invalidatesCache:!0});return Q.cache.clearPostsCache(),typeof window<"u"&&window.dispatchEvent(new CustomEvent("post-created",{detail:{post:C.data.post}})),C.data}catch{try{const x=await Q.put("/api/posts",g,{headers:{"Content-Type":"multipart/form-data"},_invalidatesCache:!0});return Q.cache.clearPostsCache(),typeof window<"u"&&window.dispatchEvent(new CustomEvent("post-created",{detail:{post:x.data.post}})),x.data}catch{const D=await Q.post("/api/post/new",g,{headers:{"Content-Type":"multipart/form-data"}});return Q.cache.clearPostsCache(),typeof window<"u"&&window.dispatchEvent(new CustomEvent("post-created",{detail:{post:D.data.post}})),D.data}}}catch(g){throw g}})(d);u&&u.success&&(M(""),w([]),U([]),v(""),b([]),m(""),y.current&&(y.current.value=""),a&&u.post&&a(u.post))}catch(d){if(d.response&&d.response.status===429){const u=d.response.data.rate_limit;let p="\u041F\u0440\u0435\u0432\u044B\u0448\u0435\u043D \u043B\u0438\u043C\u0438\u0442 \u043F\u0443\u0431\u043B\u0438\u043A\u0430\u0446\u0438\u0438 \u043F\u043E\u0441\u0442\u043E\u0432. ";if(u&&u.reset){const g=new Date(1e3*u.reset),C=new Date,x=Math.round((g-C)/1e3);p+=x>60?`\u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u043F\u043E\u0441\u0442 \u043C\u043E\u0436\u043D\u043E \u043E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u0442\u044C \u0447\u0435\u0440\u0435\u0437 ${Math.floor(x/60)} \u043C\u0438\u043D. ${x%60} \u0441\u0435\u043A.`:`\u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u043F\u043E\u0441\u0442 \u043C\u043E\u0436\u043D\u043E \u043E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u0442\u044C \u0447\u0435\u0440\u0435\u0437 ${x} \u0441\u0435\u043A.`}else p+="\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u0435 \u043F\u043E\u043F\u044B\u0442\u043A\u0443 \u043F\u043E\u0437\u0436\u0435.";m(p)}else d.response&&d.response.data&&d.response.data.error?m(d.response.data.error):m("\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438 \u043F\u043E\u0441\u0442\u0430. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437.")}finally{X(!1)}};return t?e.jsxs(he,{elevation:0,sx:{p:2,borderRadius:1,background:"rgba(255, 255, 255, 0.03)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",position:"relative",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[B&&e.jsx(Ee,{severity:"error",sx:{mb:2},onClose:()=>m(""),children:B}),e.jsx(o,{component:"form",onSubmit:d=>{d.preventDefault(),ue()},sx:{position:"relative",zIndex:1},onDragEnter:d=>{d.preventDefault(),d.stopPropagation(),ne.current+=1,ne.current===1&&W(!0)},onDragOver:d=>{d.preventDefault(),d.stopPropagation()},onDragLeave:d=>{d.preventDefault(),d.stopPropagation(),ne.current-=1,ne.current===0&&W(!1)},onDrop:d=>{d.preventDefault(),setDragActive(!1);const u=d.dataTransfer.files;if(!u.length)return;let p=!1;Array.from(u).forEach(g=>{const C=g.type.startsWith("video/"),x=g.type.startsWith("image/");C&&g.size>me&&(re("\u0420\u0430\u0437\u043C\u0435\u0440 \u0432\u0438\u0434\u0435\u043E \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0435\u0442 \u043B\u0438\u043C\u0438\u0442 \u0432 150\u041C\u0411"),Z(!0),p=!0),x&&g.size>de&&(re("\u0420\u0430\u0437\u043C\u0435\u0440 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0435\u0442 \u043B\u0438\u043C\u0438\u0442 \u0432 50\u041C\u0411"),Z(!0),p=!0)}),p||be(u)},children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column",position:"relative",borderRadius:"12px",border:F?"2px dashed #D0BCFF":"none",backgroundColor:F?"rgba(208, 188, 255, 0.05)":"transparent",padding:F?1:0,transition:"all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)"},children:[F&&e.jsxs(o,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",backgroundColor:"rgba(26, 26, 26, 0.7)",borderRadius:"12px",zIndex:10,opacity:F?1:0,transition:"opacity 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)"},children:[e.jsx(ot,{sx:{fontSize:40,color:"#D0BCFF",mb:1,filter:"drop-shadow(0 0 8px rgba(208, 188, 255, 0.6))"}}),e.jsx(l,{variant:"body1",color:"primary",sx:{fontWeight:"medium",textShadow:"0 1px 3px rgba(0,0,0,0.3)"},children:"\u041F\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0444\u0430\u0439\u043B\u044B \u0441\u044E\u0434\u0430"})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",mb:1},children:[e.jsx(ce,{src:t.photo?`/static/uploads/avatar/${t.id}/${t.photo}`:void 0,alt:t.name,sx:{mr:1.5,width:40,height:40,border:"2px solid rgba(208, 188, 255)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.2)",transition:"all 0.2s ease","&:hover":{transform:"scale(1.05)",boxShadow:"0 3px 10px rgba(0, 0, 0, 0.3)"}}}),e.jsx(Hr,{placeholder:"\u0427\u0442\u043E \u0443 \u0432\u0430\u0441 \u043D\u043E\u0432\u043E\u0433\u043E?",multiline:!0,maxRows:6,value:z,onChange:d=>M(d.target.value),onPaste:d=>{const u=d.clipboardData;if(u.items){const p=u.items;for(let g=0;g<p.length;g++)if(p[g].type.indexOf("image")!==-1){d.preventDefault();const C=p[g].getAsFile();if(C){if(A&&A==="video")return void Y({open:!0,message:"\u041D\u0435\u043B\u044C\u0437\u044F \u043F\u0440\u0438\u043A\u0440\u0435\u043F\u0438\u0442\u044C \u0444\u043E\u0442\u043E \u0438 \u0432\u0438\u0434\u0435\u043E \u043E\u0434\u043D\u043E\u0432\u0440\u0435\u043C\u0435\u043D\u043D\u043E"});v("images"),w(D=>[...D,C]);const x=new FileReader;x.onloadend=()=>{U(D=>[...D,x.result])},x.readAsDataURL(C);break}}}},fullWidth:!0})]}),E.length>0&&e.jsx(o,{sx:{position:"relative",mb:2},children:e.jsxs(o,{sx:{position:"relative",borderRadius:"12px",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.1)",backgroundColor:"rgba(0, 0, 0, 0.2)"},children:[A==="image"?e.jsx(Ot,{sx:{width:"100%",height:"auto",maxHeight:500,margin:0,padding:1},cols:E.length>3?3:E.length,rowHeight:164,gap:8,children:E.map((d,u)=>e.jsxs(Ut,{sx:{position:"relative",borderRadius:"8px",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("img",{src:d,alt:`Preview ${u+1}`,style:{objectFit:"cover",height:"100%",width:"100%",borderRadius:"8px"}}),e.jsx(G,{onClick:()=>{w(p=>p.filter((g,C)=>C!==u)),U(p=>p.filter((g,C)=>C!==u)),E.length===1&&v("")},sx:{position:"absolute",top:4,right:4,backgroundColor:"rgba(0, 0, 0, 0.6)",color:"white",padding:"4px","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.8)"},backdropFilter:"blur(4px)"},children:e.jsx(ge,{fontSize:"small"})})]},u))}):e.jsx("video",{src:E[0],controls:!0,style:{width:"100%",maxHeight:"300px",borderRadius:"12px"}}),A==="video"&&e.jsx(G,{onClick:()=>{w([]),U([]),v(""),b([]),m(""),y.current&&(y.current.value="")},sx:{position:"absolute",top:8,right:8,backgroundColor:"rgba(0, 0, 0, 0.6)",color:"white","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.8)"},padding:"8px",backdropFilter:"blur(4px)"},children:e.jsx(ge,{fontSize:"small"})})]})}),c.length>0&&e.jsx(o,{sx:{mt:2,mb:1},children:c.map(d=>e.jsxs(o,{sx:{display:"flex",alignItems:"center",py:1,px:2,mb:1,borderRadius:"8px",bgcolor:u=>u.palette.mode==="dark"?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.03)",border:u=>u.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.08)":"1px solid rgba(0, 0, 0, 0.05)"},children:[e.jsxs(o,{sx:{width:36,height:36,borderRadius:"4px",overflow:"hidden",mr:1.5,position:"relative",bgcolor:u=>u.palette.mode==="dark"?"rgba(0, 0, 0, 0.3)":"rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx("img",{src:d.cover_path.startsWith("/static/")?d.cover_path:`/static/uploads/music/covers/${d.cover_path}`,alt:d.title,style:{width:"100%",height:"100%",objectFit:"cover"},onError:u=>{u.target.src="/uploads/system/album_placeholder.jpg"}}),e.jsx(Ae,{sx:{position:"absolute",fontSize:16,color:"rgba(255, 255, 255, 0.7)"}})]}),e.jsxs(o,{sx:{flex:1,minWidth:0},children:[e.jsx(l,{variant:"body2",noWrap:!0,children:d.title}),e.jsx(l,{variant:"caption",color:"text.secondary",noWrap:!0,children:d.artist})]}),e.jsx(G,{size:"small",onClick:()=>{return u=d.id,void b(p=>p.filter(g=>g.id!==u));var u},sx:{ml:1},children:e.jsx(ge,{fontSize:"small"})})]},d.id))}),e.jsxs(Or,{children:[e.jsxs(o,{sx:{display:"flex",gap:1},children:[e.jsx("input",{ref:y,type:"file",accept:"image/*,video/*",onChange:d=>{d.preventDefault();const u=d.target.files;if(!u.length)return;let p=!1;Array.from(u).forEach(g=>{const C=g.type.startsWith("video/"),x=g.type.startsWith("image/");C&&g.size>me&&(re("\u0420\u0430\u0437\u043C\u0435\u0440 \u0432\u0438\u0434\u0435\u043E \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0435\u0442 \u043B\u0438\u043C\u0438\u0442 \u0432 150\u041C\u0411"),Z(!0),p=!0),x&&g.size>de&&(re("\u0420\u0430\u0437\u043C\u0435\u0440 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0435\u0442 \u043B\u0438\u043C\u0438\u0442 \u0432 50\u041C\u0411"),Z(!0),p=!0)}),p?d.target.value="":be(u)},multiple:!0,style:{display:"none"},id:"media-upload-profile"}),e.jsx("label",{htmlFor:"media-upload-profile",children:e.jsx(le,{component:"span",startIcon:e.jsx(ot,{sx:{fontSize:18}}),sx:{color:S.length>0||c.length>0?"primary.main":"text.secondary",borderRadius:"10px",textTransform:"none",fontSize:"0.8rem",fontWeight:500,border:S.length>0||c.length>0?"1px solid rgba(208, 188, 255, 0.5)":d=>d.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.12)":"1px solid rgba(0, 0, 0, 0.12)",padding:"4px 10px","&:hover":{backgroundColor:"rgba(208, 188, 255, 0.08)",borderColor:"rgba(208, 188, 255, 0.4)"}},size:"small",children:S.length>0?`\u0424\u0430\u0439\u043B\u044B (${S.length})`:"\u041C\u0435\u0434\u0438\u0430"})}),e.jsx(le,{onClick:()=>n(!0),startIcon:e.jsx(Ae,{sx:{fontSize:18}}),sx:{color:c.length>0?"primary.main":"text.secondary",borderRadius:"10px",textTransform:"none",fontSize:"0.8rem",fontWeight:500,padding:"4px 10px",border:c.length>0?"1px solid rgba(208, 188, 255, 0.5)":d=>d.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.12)":"1px solid rgba(0, 0, 0, 0.12)","&:hover":{backgroundColor:"rgba(208, 188, 255, 0.08)",borderColor:"rgba(208, 188, 255, 0.4)"}},size:"small",children:c.length>0?`\u041C\u0443\u0437\u044B\u043A\u0430 (${c.length})`:"\u041C\u0443\u0437\u044B\u043A\u0430"})]}),e.jsx(Ur,{variant:"contained",onClick:ue,disabled:H||!z.trim()&&S.length===0&&c.length===0,endIcon:H?e.jsx(xe,{size:14,color:"inherit"}):null,size:"small",children:"\u041E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u0442\u044C"})]}),e.jsx(nr,{open:I,onClose:()=>n(!1),onSelectTracks:d=>{b(d)},maxTracks:3})]})}),e.jsx(Ke,{open:V.open,autoHideDuration:3e3,onClose:()=>Y({...V,open:!1}),anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(Ee,{onClose:()=>Y({...V,open:!1}),severity:"warning",sx:{width:"100%"},children:V.message})}),e.jsx(Qt,{open:te,message:oe,shortMessage:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0440\u0430\u0437\u043C\u0435\u0440\u0430 \u0444\u0430\u0439\u043B\u0430",notificationType:"error",animationType:"pill",autoHideDuration:5e3,onClose:()=>Z(!1)})]}):null},Le=({children:a,value:i,index:h,...t})=>e.jsx("div",{role:"tabpanel",hidden:i!==h,id:`simple-tabpanel-${h}`,"aria-labelledby":`simple-tab-${h}`,...t,children:i===h&&e.jsx(ur,{tabIndex:h,children:e.jsx(o,{sx:{pt:0},children:a})})}),Vr=({statusText:a,statusColor:i})=>{if(!a)return null;const h=(f=>{let z=parseInt(f.substr(1,2),16),M=parseInt(f.substr(3,2),16),S=parseInt(f.substr(5,2),16);return(299*z+587*M+114*S)/1e3<128?(z=Math.min(255,z+30),M=Math.min(255,M+30),S=Math.min(255,S+30)):(z=Math.max(0,z-30),M=Math.max(0,M-30),S=Math.max(0,S-30)),`#${z.toString(16).padStart(2,"0")}${M.toString(16).padStart(2,"0")}${S.toString(16).padStart(2,"0")}`})(i||"#D0BCFF"),t=(k=i||"#D0BCFF",(299*parseInt(k.substr(1,2),16)+587*parseInt(k.substr(3,2),16)+114*parseInt(k.substr(5,2),16))/1e3>128?"#000000":"#FFFFFF");var k;const _=(f=>{const z=/\{(\w+)\}/,M=f.match(z),S={text:f,iconName:null};return M&&(S.iconName=M[1].toLowerCase(),S.text=f.replace(z,"").trim()),S})(a),R=(f=>{switch(f){case"minion":return e.jsx(Se,{sx:{fontSize:18,opacity:.8},children:e.jsxs("svg",{width:"800",height:"800",viewBox:"0 0 800 800",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M402.667 518C367.33 518 332.786 507.523 303.405 487.89C274.023 468.257 251.123 440.353 237.6 407.707C224.077 375.06 220.539 339.137 227.433 304.478C234.327 269.82 251.343 237.984 276.33 212.997C301.317 188.01 333.153 170.994 367.81 164.1C402.47 157.206 438.393 160.744 471.04 174.267C503.687 187.79 531.59 210.69 551.223 240.072C570.853 269.453 581.333 303.997 581.333 339.333C581.333 362.797 576.713 386.03 567.733 407.707C558.753 429.383 545.593 449.08 529.003 465.67C512.413 482.26 492.717 495.42 471.04 504.4C449.363 513.38 426.13 518 402.667 518ZM402.667 210.667C377.22 210.667 352.343 218.213 331.183 232.351C310.024 246.489 293.533 266.584 283.794 290.095C274.056 313.606 271.508 339.477 276.472 364.437C281.437 389.393 293.691 412.32 311.686 430.313C329.68 448.31 352.607 460.563 377.567 465.527C402.523 470.493 428.393 467.943 451.907 458.207C475.417 448.467 495.51 431.977 509.65 410.817C523.787 389.657 531.333 364.78 531.333 339.333C531.333 305.209 517.777 272.482 493.647 248.353C469.517 224.223 436.79 210.667 402.667 210.667Z",fill:"currentColor"}),e.jsx("path",{d:"M400 643.667C376.53 643.72 353.28 639.123 331.597 630.14C309.913 621.157 290.224 607.97 273.667 591.333C269.251 586.593 266.847 580.327 266.961 573.85C267.075 567.373 269.699 561.193 274.28 556.613C278.86 552.033 285.04 549.407 291.516 549.293C297.993 549.18 304.261 551.583 309 556C333.693 579.057 366.216 591.88 400 591.88C433.783 591.88 466.31 579.057 491 556C495.74 551.583 502.006 549.18 508.483 549.293C514.96 549.407 521.14 552.033 525.72 556.613C530.303 561.193 532.926 567.373 533.04 573.85C533.153 580.327 530.75 586.593 526.333 591.333C509.776 607.97 490.086 621.157 468.403 630.14C446.72 639.123 423.47 643.72 400 643.667Z",fill:"currentColor"}),e.jsx("path",{d:"M402.667 400C436.173 400 463.333 372.837 463.333 339.333C463.333 305.828 436.173 278.666 402.667 278.666C369.163 278.666 342 305.828 342 339.333C342 372.837 369.163 400 402.667 400Z",fill:"currentColor"}),e.jsx("path",{d:"M666.666 755.333C660.036 755.333 653.676 752.7 648.99 748.01C644.3 743.323 641.666 736.963 641.666 730.333V333.333C637.156 272.944 609.983 216.492 565.596 175.297C521.21 134.102 462.89 111.209 402.333 111.209C341.776 111.209 283.457 134.102 239.07 175.297C194.684 216.492 167.511 272.944 163 333.333V730.333C163 736.963 160.366 743.323 155.678 748.01C150.989 752.7 144.631 755.333 138 755.333C131.37 755.333 125.011 752.7 120.322 748.01C115.634 743.323 113 736.963 113 730.333V333.333C115.55 258.166 147.202 186.929 201.278 134.656C255.354 82.3832 327.623 53.1636 402.833 53.1636C478.043 53.1636 550.313 82.3832 604.39 134.656C658.466 186.929 690.116 258.166 692.666 333.333V730.333C692.623 733.69 691.913 737.003 690.58 740.08C689.246 743.16 687.313 745.943 684.893 748.27C682.476 750.597 679.62 752.417 676.49 753.63C673.36 754.843 670.023 755.423 666.666 755.333Z",fill:"currentColor"}),e.jsx("path",{d:"M666.666 755.333H138C131.37 755.333 125.011 752.7 120.322 748.01C115.634 743.323 113 736.963 113 730.333C113 723.703 115.634 717.343 120.322 712.657C125.011 707.967 131.37 705.333 138 705.333H666.666C673.296 705.333 679.656 707.967 684.343 712.657C689.033 717.343 691.666 723.703 691.666 730.333C691.666 736.963 689.033 743.323 684.343 748.01C679.656 752.7 673.296 755.333 666.666 755.333Z",fill:"currentColor"})]})});case"heart":return e.jsx(Se,{sx:{fontSize:18,opacity:.8},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12,21.35l-1.45-1.32C5.4,15.36,2,12.28,2,8.5C2,5.42,4.42,3,7.5,3c1.74,0,3.41,0.81,4.5,2.09C13.09,3.81,14.76,3,16.5,3 C19.58,3,22,5.42,22,8.5c0,3.78-3.4,6.86-8.55,11.54L12,21.35z"})})});case"star":return e.jsx(Se,{sx:{fontSize:18,opacity:.8},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12,17.27L18.18,21l-1.64-7.03L22,9.24l-7.19-0.61L12,2L9.19,8.63L2,9.24l5.46,4.73L5.82,21L12,17.27z"})})});case"music":return e.jsx(Ae,{sx:{fontSize:18,opacity:.8}});case"location":return e.jsx(rt,{sx:{fontSize:18,opacity:.8}});case"cake":return e.jsx(st,{sx:{fontSize:18,opacity:.8}});case"info":return e.jsx(er,{sx:{fontSize:18,opacity:.8}});case"chat":return e.jsx(it,{sx:{fontSize:18,opacity:.8}});default:return e.jsx(Se,{sx:{fontSize:18,opacity:.8},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"})})})}})(_.iconName);return e.jsx(et.div,{initial:{opacity:0,scale:.8,y:10},animate:{opacity:1,scale:1,y:0},transition:{type:"spring",stiffness:500,damping:30,delay:.2},style:{position:"absolute",left:"100%",top:"60%",zIndex:10},children:e.jsx(o,{sx:{position:"relative",backgroundColor:"transparent",filter:"drop-shadow(0 4px 8px rgba(0,0,0,0.2))",maxWidth:"200px",transform:"translateX(10px)","&:before":{content:'""',position:"absolute",top:0,left:-8,width:0,height:0,borderStyle:"solid",borderWidth:"0 14px 14px 0",borderColor:`transparent ${i||"#D0BCFF"} transparent transparent`,transform:"rotate(40deg)",filter:"drop-shadow(-3px 2px 2px rgba(0,0,0,0.1))",zIndex:0}},children:e.jsxs(o,{sx:{background:`linear-gradient(135deg, ${i||"#D0BCFF"} 0%, ${h} 100%)`,color:t,padding:"8px 12px",borderRadius:"18px",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",boxShadow:`inset 0 0 10px rgba(255,255,255,0.15), 
                        0 1px 1px rgba(0,0,0,0.1),
                        0 4px 10px rgba(0,0,0,0.15)`,backdropFilter:"blur(4px)",border:"1px solid "+(i==="#ffffff"?"rgba(0,0,0,0.1)":"rgba(255,255,255,0.2)"),display:"flex",alignItems:"center",gap:"6px",position:"relative"},children:[R,e.jsx(o,{sx:{overflow:"hidden",maskImage:"linear-gradient(to right, transparent 0%, black 5%, black 95%, transparent 100%)"},children:e.jsx(o,{className:"scrolling-text",sx:{whiteSpace:"nowrap",display:"inline-block",animation:_.text.length>15?"scrollText 10s linear infinite":"none","@keyframes scrollText":{"0%":{transform:"translateX(0%)"},"25%":{transform:"translateX(0%)"},"75%":{transform:_.text.length>15?"translateX(-50%)":"translateX(0%)"},"100%":{transform:"translateX(0%)"}},"&::after":_.text.length>15?{content:`" \u2022 ${_.text} \u2022 "`,paddingLeft:"10px"}:{}},children:_.text})})]})})})},ye=(a,i=.3)=>{if(!a||a==="transparent"||a.startsWith("rgba"))return a;const h=a.replace("#",""),t=parseInt(h.substring(0,2),16),k=parseInt(h.substring(2,4),16),_=parseInt(h.substring(4,6),16),R=f=>Math.min(255,Math.floor(f+(255-f)*i));return`#${R(t).toString(16).padStart(2,"0")}${R(k).toString(16).padStart(2,"0")}${R(_).toString(16).padStart(2,"0")}`},Yr=({duration:a,subscriptionDate:i,subscriptionType:h})=>{if(!a||a<1||h!=="ultimate")return null;let t="bronze";a>=6?t="diamond":a>=3?t="gold":a>=2&&(t="silver");const k=`\u041F\u043E\u0434\u043F\u0438\u0441\u0447\u0438\u043A Ultima \u0441 ${_=i,_?new Date(_).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}):""}`;var _;return e.jsx(se,{title:k,arrow:!0,placement:"top",children:e.jsx(o,{component:"img",src:`/static/subs/${t}.svg`,alt:`${t} \u043F\u043E\u0434\u043F\u0438\u0441\u043A\u0430`,sx:{width:24,height:24,ml:.5,cursor:"pointer",transition:"transform 0.2s ease-in-out","&:hover":{transform:"scale(1.2)"}}})})},Nr=()=>{const{username:a}=Yt(),{user:i,isAuthenticated:h}=s.useContext(Ie),[t,k]=s.useState(null),[_,R]=s.useState([]),[f,z]=s.useState([]),[M,S]=s.useState([]),[w,A]=s.useState(0),[v,E]=s.useState(!0),[U,H]=s.useState(!0),[X,B]=s.useState(!0),[m,y]=s.useState(!1),[F,W]=s.useState(0),[V,Y]=s.useState(0),[I,n]=s.useState(0),[c,b]=s.useState([]),[$,P]=s.useState([]),[L,q]=s.useState([]),[te,Z]=s.useState(!0),[oe,re]=s.useState(!0),[me,de]=s.useState(!0),[ie,pe]=s.useState([]),[ne,be]=s.useState(1),[ue,d]=s.useState(!1),[u,p]=s.useState(""),[g,C]=s.useState({open:!1,message:"",severity:"success"}),x=Nt(),{themeSettings:D,setProfileBackground:K,clearProfileBackground:fe}=s.useContext(Gt),[Be,je]=s.useState(0),[_t,Ct]=s.useState(!1),[Xr,kt]=s.useState(null),[St,It]=s.useState(""),[ze,$e]=s.useState([]),[Zr,Pe]=s.useState(!1),[He,zt]=s.useState(null),[Gr,Jr]=s.useState(null),[$t,Oe]=s.useState(!1),[N,Ue]=s.useState(null),[Dt,Rt]=s.useState(!1),Ve=()=>{d(!1)},Ye=()=>{C(r=>({...r,open:!1}))},Ne=r=>{C({open:!0,severity:"success",message:"\u041F\u043E\u0441\u0442 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u043D"})};s.useEffect(()=>{(async()=>{try{E(!0);const r=await ee.get(`/api/profile/${a}`);if(r.data.user){if(r.data.user.verification_status===void 0&&r.data.verification&&(r.data.user.verification_status=r.data.verification.status||null),r.data.achievement&&(r.data.user.achievement=r.data.achievement),r.data.connect_info&&(r.data.user.connect_info=r.data.connect_info),k(r.data.user),r.data.user.total_likes!==void 0&&je(r.data.user.total_likes),r.data.subscription?r.data.user.subscription=r.data.subscription:r.data.user.subscription,r.data.user.photos){const j=Array.isArray(r.data.user.photos)?r.data.user.photos:[];z(j)}else z([]);if(r.data.user.videos){const j=Array.isArray(r.data.user.videos)?r.data.user.videos:[];S(j)}else S([]);r.data.user.followers_count!==void 0&&W(r.data.user.followers_count),r.data.user.following_count!==void 0&&Y(r.data.user.following_count),r.data.user.is_following!==void 0?y(r.data.user.is_following):r.data.is_following!==void 0&&y(r.data.is_following),r.data.user.posts_count!==void 0?n(r.data.user.posts_count):r.data.posts_count!==void 0&&n(r.data.posts_count),r.data.socials&&pe(r.data.socials);try{const j=await ee.get(`/api/username/purchased/${r.data.user.id}`);if(j.data.success){const O=j.data.usernames.filter(ke=>!ke.is_active&&ke.username!==r.data.user.username).map(ke=>ke.username);R(O)}}catch{R([])}r.data.user.ban||r.data.ban?Ue(r.data.user.ban||r.data.ban):Ue(null),r.data.current_user_is_moderator!==void 0&&Rt(r.data.current_user_is_moderator)}else k(null)}catch(r){r.response&&r.response.status===404&&k(null)}finally{E(!1)}})()},[a,E,k,W,Y,y,n,pe,je]),s.useEffect(()=>{i||k(null)},[i]),s.useEffect(()=>{t&&t.id&&(Z(!0),re(!0),de(!0),ee.get(`/api/profile/${t.id}/followers`).then(r=>{if(r.data&&r.data.followers){const j=Array.isArray(r.data.followers)?r.data.followers.filter(O=>O&&typeof O=="object"):[];b(j)}else b([])}).catch(r=>{b([])}).finally(()=>{Z(!1)}),ee.get(`/api/profile/${t.id}/following`).then(r=>{if(r.data&&r.data.following){const j=Array.isArray(r.data.following)?r.data.following.filter(O=>O&&typeof O=="object"):[];P(j)}else P([])}).catch(r=>{P([])}).finally(()=>{re(!1)}),ee.get(`/api/profile/${t.id}/friends`).then(r=>{if(r.data&&r.data.friends){const j=Array.isArray(r.data.friends)?r.data.friends.filter(O=>O&&typeof O=="object"):[];q(j)}else q([])}).catch(r=>{q([])}).finally(()=>{de(!1)}))},[t]),s.useEffect(()=>{t&&t.id&&(async()=>{try{if(t&&t.id){const r=await ee.get(`/api/profile/${t.id}/stats`);r.data&&r.data.total_likes!==void 0?je(r.data.total_likes):je(0)}}catch{je(0)}})()},[t]),s.useEffect(()=>{a&&(async()=>{try{if(!a)return;const r=await ee.get(`/api/profile/${a}/online_status`);r.data.success&&(Ct(r.data.is_online),kt(r.data.last_active))}catch{}})()},[a]),s.useEffect(()=>{},[t]),s.useEffect(()=>{t&&t.id&&Ft()},[t]);const Ft=async()=>{try{Pe(!0);const r=await ee.get(`/api/profile/${t.id}/medals`);r.data.success?$e(r.data.medals||[]):$e([])}catch{$e([])}finally{Pe(!1)}},Xe=(r,j)=>{r.preventDefault(),zt(j),Oe(!0)};if(s.useEffect(()=>{if(t&&t.profile_background_url)return K(t.profile_background_url),()=>fe();fe()},[t&&t.profile_background_url]),v)return e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:e.jsx(xe,{})});if(!t)return e.jsx(qe,{maxWidth:"lg",children:e.jsxs(o,{sx:{textAlign:"center",mt:5},children:[e.jsx(l,{variant:"h5",children:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D"}),e.jsx(le,{component:ae,to:"/",variant:"contained",color:"primary",sx:{mt:2,borderRadius:20,textTransform:"none"},children:"\u0412\u0435\u0440\u043D\u0443\u0442\u044C\u0441\u044F \u043D\u0430 \u0433\u043B\u0430\u0432\u043D\u0443\u044E"})]})});const Ze=i&&i.username===t.username,Wt=({userId:r})=>e.jsx(fr,{userId:r}),Et=()=>e.jsx(br,{userId:t?.id,statusColor:t?.status_color});return e.jsxs(qe,{maxWidth:"lg",sx:{pt:0,pb:4,px:{xs:.5,sm:1},width:"100%",marginRight:"auto",marginLeft:"0!important",paddingTop:"24px",paddingBottom:"40px",paddingLeft:"0",paddingRight:"0",minHeight:"calc(100vh - 64px)"},children:[e.jsxs(J,{container:!0,spacing:.5,sx:{flexDirection:{xs:"column",md:"row"},flexWrap:{xs:"nowrap",md:"nowrap"}},children:[e.jsxs(J,{item:!0,xs:12,md:5,sx:{position:{xs:"static",md:"sticky"},top:"60px",height:"fit-content",zIndex:2},children:[e.jsxs(he,{sx:{p:0,borderRadius:"16px",background:"rgba(255, 255, 255, 0.03)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.2)",overflow:"hidden",mb:"5px",border:"1px solid rgba(255, 255, 255, 0.1)",position:"relative",zIndex:2},children:[t?.profile_id!==2?t?.banner_url?e.jsx(o,{sx:{width:"100%",height:{xs:150,sm:200},backgroundImage:`url(${t.banner_url})`,backgroundSize:"cover",backgroundPosition:"center",position:"relative",transition:"transform 0.5s ease","&:hover":{transform:"scale(1.02)"},"&::after":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:1}}}):e.jsx(o,{sx:{width:"100%",height:{xs:100,sm:120},position:"relative"}}):null,e.jsxs(o,{sx:{px:3,pb:3,pt:0,mt:t?.profile_id===2?2:-7},children:[e.jsx(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:e.jsxs(o,{sx:{position:"relative"},children:[e.jsx(se,{title:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0430\u0432\u0430\u0442\u0430\u0440",arrow:!0,placement:"top",children:e.jsx(ce,{src:t?.avatar_url,alt:t?.name,onClick:()=>{const r=t?.avatar_url||St;r&&(j=>{typeof j=="string"&&(p(j),d(!0))})(r)},sx:{width:{xs:110,sm:130},height:{xs:110,sm:130},border:t?.status_color&&t?.status_text&&t?.subscription?`4px solid ${t.status_color}`:t?.subscription?"4px solid "+(t.subscription.type==="premium"?"rgba(186, 104, 200)":t.subscription.type==="pick-me"?"rgba(208, 188, 255)":t.subscription.type==="ultimate"?"rgba(124, 77, 255)":"rgba(66, 165, 245)"):r=>r.palette.mode==="dark"?"4px solid #121212":"4px solid #ffffff",boxShadow:t?.status_color&&t?.status_text&&t.subscription?`0 0 15px ${t.status_color}80`:t?.subscription?t.subscription.type==="premium"?"0 0 15px rgba(186, 104, 200, 0.5)":t.subscription.type==="pick-me"?"0 0 15px rgba(208, 188, 255, 0.5)":t.subscription.type==="ultimate"?"0 0 15px rgba(124, 77, 255, 0.5)":"0 0 15px rgba(66, 165, 245, 0.5)":"0 8px 20px rgba(0, 0, 0, 0.25)",bgcolor:"primary.dark",transition:"all 0.3s ease",cursor:"pointer","&:hover":{transform:"scale(1.03)",boxShadow:t?.status_color&&t?.status_text&&t.subscription?`0 0 20px ${t.status_color}B3`:t?.subscription?t.subscription.type==="premium"?"0 0 20px rgba(186, 104, 200, 0.7)":t.subscription.type==="pick-me"?"0 0 20px rgba(208, 188, 255, 0.7)":t.subscription.type==="ultimate"?"0 0 20px rgba(124, 77, 255, 0.7)":"0 0 20px rgba(66, 165, 245, 0.7)":"0 10px 25px rgba(0, 0, 0, 0.35)",border:t?.status_color&&t?.status_text&&t.subscription?`4px solid ${t.status_color}CC`:t?.subscription?"4px solid "+(t.subscription.type==="premium"?"rgba(186, 104, 200, 0.8)":t.subscription.type==="pick-me"?"rgba(208, 188, 255, 0.8)":t.subscription.type==="ultimate"?"rgba(124, 77, 255, 0.8)":"rgba(66, 165, 245, 0.8)"):"4px solid rgba(208, 188, 255, 0.4)"}},onError:r=>{if(t?.id){const j=`/static/uploads/avatar/${t.id}/${t.photo||"default.png"}`;r.currentTarget.src=j,It(j)}}})}),_t&&t?.subscription?.type!=="channel"&&e.jsx(o,{sx:{position:"absolute",width:20,height:20,borderRadius:"50%",bgcolor:"#4caf50",border:r=>r.palette.mode==="dark"?"2px solid #121212":"2px solid #ffffff",bottom:5,right:15,boxShadow:"0 0 8px rgba(76, 175, 80, 0.9)",zIndex:2,animation:"pulse 2s infinite","@keyframes pulse":{"0%":{boxShadow:"0 0 0 0 rgba(76, 175, 80, 0.7)"},"70%":{boxShadow:"0 0 0 6px rgba(76, 175, 80, 0)"},"100%":{boxShadow:"0 0 0 0 rgba(76, 175, 80, 0)"}}}}),e.jsx(Vr,{statusText:t?.status_text,statusColor:t?.status_color})]})}),e.jsxs(o,{sx:{mt:2,whiteSpace:"nowrap"},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(l,{variant:"h5",sx:{fontWeight:700,color:t?.profile_id===2?"#fff":"inherit",textShadow:t?.profile_id===2?"0 1px 3px rgba(0,0,0,0.7)":"none",background:t?.profile_id===2?"none":r=>r.palette.mode==="dark"?"linear-gradient(90deg, #fff 0%, rgba(255,255,255,0.8) 100%)":"linear-gradient(90deg, #000 0%, rgba(0,0,0,0.8) 100%)",WebkitBackgroundClip:t?.profile_id===2?"unset":"text",WebkitTextFillColor:t?.profile_id===2?"unset":"transparent"},children:t?.name||"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C"}),e.jsx(ar,{status:t?.verification_status,size:"small"}),t?.subscription&&t.subscription.total_duration_months>0&&e.jsx(Yr,{duration:t.subscription.total_duration_months,subscriptionDate:t.subscription.subscription_date,subscriptionType:t.subscription.type}),t?.achievement&&e.jsx(o,{component:"img",sx:{width:"auto",height:25,ml:.5},src:`/static/images/bages/${t.achievement.image_path}`,alt:t.achievement.bage,onError:r=>{r.target&&r.target instanceof HTMLImageElement&&(r.target.style.display="none")}})]})}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:.5,mt:.5,flexWrap:"wrap",maxWidth:"100%"},children:[e.jsxs(l,{variant:"body2",sx:{fontWeight:500,color:t?.profile_id===2?"rgba(255,255,255,0.9)":r=>r.palette.text.secondary,textShadow:t?.profile_id===2?"0 1px 2px rgba(0,0,0,0.5)":"none",display:"flex",alignItems:"center",background:t?.profile_id===2?"rgba(0,0,0,0.3)":r=>r.palette.mode==="dark"?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.03)",px:1.2,py:.4,borderRadius:4,border:t?.profile_id===2?"1px solid rgba(255,255,255,0.15)":r=>r.palette.mode==="dark"?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.05)"},children:["@",t?.username||"username"]}),t?.connect_info&&t.connect_info.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(jr,{sx:r=>({width:"2em",height:"2em",fontSize:16,color:t?.profile_id===2?"rgba(255,255,255,0.9)":r.palette.text.secondary})}),e.jsxs(l,{variant:"body2",component:ae,to:`/profile/${t.connect_info[0].username}`,sx:r=>({fontWeight:500,color:t?.profile_id===2?"rgba(255,255,255,0.9)":r.palette.text.secondary,textShadow:t?.profile_id===2?"0 1px 2px rgba(0,0,0,0.5)":"none",display:"flex",alignItems:"center",background:t?.profile_id===2?"rgba(0,0,0,0.3)":r.palette.mode==="dark"?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.03)",px:1.2,py:.4,borderRadius:4,border:t?.profile_id===2?"1px solid rgba(255,255,255,0.15)":r.palette.mode==="dark"?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.05)",textDecoration:"none","&:hover":{textDecoration:"none",background:t?.profile_id===2?"rgba(0,0,0,0.4)":r.palette.mode==="dark"?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.05)"}}),children:["@",t.connect_info[0].username]})]}),N?e.jsx(se,{title:e.jsxs(o,{sx:{p:.5},children:[e.jsx(l,{variant:"subtitle2",sx:{mb:1,fontWeight:"bold"},children:"\u0410\u043A\u043A\u0430\u0443\u043D\u0442 \u0437\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u043D"}),e.jsxs(l,{variant:"body2",sx:{mb:.5},children:["\u041F\u0440\u0438\u0447\u0438\u043D\u0430: ",N.reason]}),e.jsxs(l,{variant:"body2",sx:{mb:.5},children:["\u0414\u043E: ",N.end_date]}),N.remaining_days>0&&e.jsxs(l,{variant:"body2",children:["\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C \u0434\u043D\u0435\u0439: ",N.remaining_days]})]}),arrow:!0,placement:"top",children:e.jsxs(l,{variant:"caption",sx:{display:"flex",alignItems:"center",color:"#fff",fontWeight:500,background:"rgba(211, 47, 47, 0.7)",px:1,py:.1,borderRadius:4,border:"1px solid rgba(211, 47, 47, 0.8)",boxShadow:"0 0 8px rgba(211, 47, 47, 0.5)","&:hover":{background:"rgba(211, 47, 47, 0.8)"},animation:"pulse-red 2s infinite","@keyframes pulse-red":{"0%":{boxShadow:"0 0 0 0 rgba(211, 47, 47, 0.4)"},"70%":{boxShadow:"0 0 0 6px rgba(211, 47, 47, 0)"},"100%":{boxShadow:"0 0 0 0 rgba(211, 47, 47, 0)"}}},children:[e.jsx(cr,{sx:{fontSize:14,mr:.5,opacity:.9}}),e.jsx(o,{component:"span",children:"\u0412 \u0431\u0430\u043D\u0435"})]})}):null,t?.scam===1&&e.jsx(se,{title:"\u042D\u0442\u043E\u0442 \u0430\u043A\u043A\u0430\u0443\u043D\u0442 \u0431\u044B\u043B \u043E\u0442\u043C\u0435\u0447\u0435\u043D \u043A\u0430\u043A \u043C\u043E\u0448\u0435\u043D\u043D\u0438\u0447\u0435\u0441\u043A\u0438\u0439. \u0411\u0443\u0434\u044C\u0442\u0435 \u043E\u0441\u0442\u043E\u0440\u043E\u0436\u043D\u044B!",arrow:!0,placement:"top",children:e.jsxs(l,{variant:"caption",sx:{display:"flex",alignItems:"center",color:"#fff",fontWeight:500,background:"rgba(211, 47, 47, 0.6)",px:1,py:.1,borderRadius:4,border:"1px solid rgba(211, 47, 47, 0.8)",boxShadow:"0 0 8px rgba(211, 47, 47, 0.5)","&:hover":{background:"rgba(211, 47, 47, 0.7)"},animation:"pulse-red 2s infinite","@keyframes pulse-red":{"0%":{boxShadow:"0 0 0 0 rgba(211, 47, 47, 0.4)"},"70%":{boxShadow:"0 0 0 6px rgba(211, 47, 47, 0)"},"100%":{boxShadow:"0 0 0 0 rgba(211, 47, 47, 0)"}}},children:[e.jsx(tt,{sx:{fontSize:14,mr:.5,opacity:.9}}),e.jsx(o,{component:"span",children:"SCAM"})]})}),t?.subscription&&(t.subscription.type==="channel"?e.jsx(Fe,{icon:e.jsx(it,{fontSize:"small"}),label:"\u041A\u0430\u043D\u0430\u043B",size:"small",sx:{bgcolor:t.status_color?`${t.status_color}26`:r=>r.palette.mode==="dark"?"rgba(208, 188, 255, 0.15)":"rgba(124, 77, 255, 0.15)",color:t.status_color?t.status_color:r=>r.palette.mode==="dark"?"#d0bcff":"#7c4dff",fontWeight:"bold",border:"1px solid",borderColor:t.status_color?`${t.status_color}4D`:r=>r.palette.mode==="dark"?"rgba(208, 188, 255, 0.3)":"rgba(124, 77, 255, 0.3)","& .MuiChip-icon":{color:"inherit"},py:.25,height:"auto",animation:"pulse-light 2s infinite","@keyframes pulse-light":{"0%":{boxShadow:t.status_color?`0 0 0 0 ${t.status_color}66`:"0 0 0 0 rgba(124, 77, 255, 0.4)"},"70%":{boxShadow:t.status_color?`0 0 0 6px ${t.status_color}00`:"0 0 0 6px rgba(124, 77, 255, 0)"},"100%":{boxShadow:t.status_color?`0 0 0 0 ${t.status_color}00`:"0 0 0 0 rgba(124, 77, 255, 0)"}}}}):e.jsx(se,{title:`\u041F\u043E\u0434\u043F\u0438\u0441\u043A\u0430 ${t.subscription.type==="pick-me"?"\u041F\u0438\u043A\u043C\u0438":t.subscription.type} \u0430\u043A\u0442\u0438\u0432\u043D\u0430 \u0434\u043E ${new Date(t.subscription.expires_at).toLocaleDateString()}`,children:e.jsx(Fe,{icon:e.jsx(lr,{fontSize:"small"}),label:t.subscription.type==="pick-me"?"\u041F\u0438\u043A\u043C\u0438":t.subscription.type.charAt(0).toUpperCase()+t.subscription.type.slice(1),size:"small",sx:{bgcolor:t.subscription.type==="premium"?"rgba(186, 104, 200, 0.15)":t.subscription.type==="ultimate"?"rgba(124, 77, 255, 0.15)":t.subscription.type==="pick-me"?"rgba(208, 188, 255, 0.15)":"rgba(66, 165, 245, 0.15)",color:t.subscription.type==="premium"?"#ba68c8":t.subscription.type==="ultimate"?"#7c4dff":t.subscription.type==="pick-me"?"rgb(208, 188, 255)":"#42a5f5",fontWeight:"bold",border:"1px solid",borderColor:t.subscription.type==="premium"?"rgba(186, 104, 200, 0.3)":t.subscription.type==="ultimate"?"rgba(124, 77, 255, 0.3)":t.subscription.type==="pick-me"?"rgba(208, 188, 255, 0.3)":"rgba(66, 165, 245, 0.3)","& .MuiChip-icon":{color:"inherit"},py:.25,height:"auto",animation:"pulse-light 2s infinite","@keyframes pulse-light":{"0%":{boxShadow:t.status_color&&t.status_text?`0 0 0 0 ${t.status_color}66`:"0 0 0 0 rgba(124, 77, 255, 0.4)"},"70%":{boxShadow:t.status_color&&t.status_text?`0 0 0 6px ${t.status_color}00`:"0 0 0 6px rgba(124, 77, 255, 0)"},"100%":{boxShadow:t.status_color&&t.status_text?`0 0 0 0 ${t.status_color}00`:"0 0 0 0 rgba(124, 77, 255, 0)"}}}})}))]}),_.length>0&&e.jsx(o,{sx:{display:"flex",mt:1,width:"100%"},children:e.jsxs(o,{sx:{color:r=>r.palette.text.secondary,backgroundColor:t.status_color&&t.status_text&&t.subscription?`${t.status_color}1A`:r=>r.palette.mode==="dark"?"rgba(208, 188, 255, 0.1)":"rgba(0, 0, 0, 0.05)",px:1.2,py:.4,borderRadius:4,border:t.status_color&&t.status_text&&t.subscription?`1px solid ${t.status_color}33`:r=>r.palette.mode==="dark"?"1px solid rgba(208, 188, 255, 0.2)":"1px solid rgba(0, 0, 0, 0.1)",fontSize:"0.75rem",display:"inline-flex",alignItems:"center",maxWidth:"100%",flexWrap:"wrap"},children:[e.jsx(l,{variant:"caption",sx:{color:t?.status_color?ye(t.status_color):r=>r.palette.text.secondary,mr:.5},children:"\u0410 \u0442\u0430\u043A\u0436\u0435:"}),_.slice(0,3).map((r,j)=>e.jsxs(Xt.Fragment,{children:[e.jsxs(l,{variant:"caption",component:"span",sx:{color:t.status_color&&t.status_text&&t.subscription?t.status_color:O=>O.palette.mode==="dark"?"#d0bcff":"#7c4dff",fontWeight:500,cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:O=>Xe(O,r),children:["@",r]}),j<Math.min(_.length,3)-1&&e.jsx(l,{variant:"caption",component:"span",sx:{mx:.5,color:O=>O.palette.text.disabled},children:","})]},j)),_.length>3&&e.jsxs(l,{variant:"caption",component:"span",sx:{ml:.5,color:r=>r.palette.text.disabled},children:["\u0438 \u0435\u0449\u0451 ",_.length-3]})]})}),N&&(Dt||i&&i.id===3)&&e.jsxs(o,{sx:{mt:2,p:1.5,borderRadius:"12px",backgroundColor:"rgba(211, 47, 47, 0.7)",backdropFilter:"blur(10px)",border:"1px solid rgba(211, 47, 47, 0.8)",boxShadow:"0 0 15px rgba(211, 47, 47, 0.4)",display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(tt,{sx:{fontSize:22,mt:.5,color:"white"}}),e.jsxs(o,{children:[e.jsx(l,{variant:"subtitle2",sx:{fontWeight:"bold",color:"white"},children:"\u0410\u043A\u043A\u0430\u0443\u043D\u0442 \u0437\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u043D"}),e.jsxs(l,{variant:"caption",sx:{display:"block",color:"rgba(255,255,255,0.9)"},children:["\u041F\u0440\u0438\u0447\u0438\u043D\u0430: ",N.reason]}),e.jsxs(l,{variant:"caption",sx:{display:"block",color:"rgba(255,255,255,0.9)"},children:["\u0414\u043E ",N.end_date,N.remaining_days>0&&` (\u043E\u0441\u0442\u0430\u043B\u043E\u0441\u044C ${N.remaining_days} \u0434\u043D.)`]}),i&&i.id===3&&e.jsxs(o,{sx:{mt:1,pt:1,borderTop:"1px dashed rgba(255, 255, 255, 0.4)"},children:[e.jsx(l,{variant:"caption",sx:{display:"block",fontStyle:"italic",color:"rgba(255,255,255,0.9)"},children:N.is_auto_ban?"\u0410\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u0431\u0430\u043D \u0441\u0438\u0441\u0442\u0435\u043C\u043E\u0439":N.admin?`\u0411\u0430\u043D \u0432\u044B\u0434\u0430\u043B: ${N.admin.name} (@${N.admin.username})`:"\u0411\u0430\u043D \u0432\u044B\u0434\u0430\u043D \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439"}),N.start_date&&e.jsxs(l,{variant:"caption",sx:{display:"block",fontStyle:"italic",color:"rgba(255,255,255,0.9)"},children:["\u041D\u0430\u0447\u0430\u043B\u043E \u0431\u0430\u043D\u0430: ",N.start_date]}),N.details&&e.jsxs(l,{variant:"caption",sx:{display:"block",fontStyle:"italic",color:"rgba(255,255,255,0.9)"},children:["\u0414\u0435\u0442\u0430\u043B\u0438: ",N.details]})]})]})]}),t?.about&&e.jsx(l,{variant:"body2",sx:{mt:1,lineHeight:1.5,color:t?.status_color?ye(t.status_color):r=>r.palette.text.secondary,p:1.5,borderRadius:1,background:r=>r.palette.mode==="dark"?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.03)",backdropFilter:"blur(10px)",border:r=>r.palette.mode==="dark"?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.05)",overflowWrap:"break-word",wordBreak:"break-word",whiteSpace:"normal"},children:t.about}),e.jsxs(o,{sx:{display:"grid",gridTemplateColumns:t?.subscription?.type==="channel"?"repeat(2, 1fr)":"repeat(3, 1fr)",gap:1,mt:1},children:[e.jsxs(he,{sx:{p:1.5,borderRadius:2,textAlign:"center",background:r=>r.palette.mode==="dark"?"rgba(255,255,255,0.04)":"rgba(0,0,0,0.04)",backdropFilter:"blur(5px)",border:r=>r.palette.mode==="dark"?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.05)",transition:"all 0.2s ease","&:hover":{background:r=>r.palette.mode==="dark"?"rgba(255,255,255,0.07)":"rgba(0,0,0,0.07)",transform:"translateY(-2px)"}},children:[e.jsx(l,{variant:"h6",sx:{fontWeight:700,color:t.status_color&&t.status_text&&t.subscription?t.status_color:"primary.main"},children:I||0}),e.jsx(l,{variant:"caption",sx:{color:t?.status_color?ye(t.status_color):r=>r.palette.text.secondary},children:"\u043F\u0443\u0431\u043B\u0438\u043A\u0430\u0446\u0438\u0439"})]}),e.jsxs(he,{component:ae,to:`/profile/${t?.username}/followers`,sx:{p:1.5,borderRadius:2,textAlign:"center",background:r=>r.palette.mode==="dark"?"rgba(255,255,255,0.04)":"rgba(0,0,0,0.04)",backdropFilter:"blur(5px)",border:t.status_color&&t.status_text&&t.subscription?`1px solid ${t.status_color}33`:r=>r.palette.mode==="dark"?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.05)",textDecoration:"none",transition:"all 0.2s ease","&:hover":{background:r=>r.palette.mode==="dark"?"rgba(255,255,255,0.07)":"rgba(0,0,0,0.07)",transform:"translateY(-2px)",boxShadow:t.status_color&&t.status_text&&t.subscription?`0 4px 15px ${t.status_color}33`:"0 4px 15px rgba(0,0,0,0.1)"}},children:[e.jsx(l,{variant:"h6",sx:{fontWeight:700,color:t.status_color&&t.status_text&&t.subscription?t.status_color:"primary.main"},children:F||0}),e.jsx(l,{variant:"caption",sx:{color:t?.status_color?ye(t.status_color):r=>r.palette.text.secondary},children:"\u043F\u043E\u0434\u043F\u0438\u0441\u0447\u0438\u043A\u043E\u0432"})]}),(!t?.subscription||t.subscription.type!=="channel")&&e.jsxs(he,{component:ae,to:`/profile/${t?.username}/following`,sx:{p:1.5,borderRadius:2,textAlign:"center",background:r=>r.palette.mode==="dark"?"rgba(255,255,255,0.04)":"rgba(0,0,0,0.04)",backdropFilter:"blur(5px)",border:t.status_color&&t.status_text&&t.subscription?`1px solid ${t.status_color}33`:r=>r.palette.mode==="dark"?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.05)",textDecoration:"none",transition:"all 0.2s ease","&:hover":{background:r=>r.palette.mode==="dark"?"rgba(255,255,255,0.07)":"rgba(0,0,0,0.07)",transform:"translateY(-2px)",boxShadow:t.status_color&&t.status_text&&t.subscription?`0 4px 15px ${t.status_color}33`:"0 4px 15px rgba(0,0,0,0.1)"}},children:[e.jsx(l,{variant:"h6",sx:{fontWeight:700,color:t.status_color&&t.status_text&&t.subscription?t.status_color:"primary.main"},children:V||0}),e.jsx(l,{variant:"caption",sx:{color:t?.status_color?ye(t.status_color):r=>r.palette.text.secondary},children:"\u043F\u043E\u0434\u043F\u0438\u0441\u043E\u043A"})]})]}),(!t?.subscription||t.subscription.type!=="channel")&&e.jsxs(J,{container:!0,spacing:1,sx:{mt:1},children:[t?.subscription&&t.subscription.type==="channel"?e.jsx(J,{item:!0,xs:6,children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.8rem"},children:"\u041F\u043E\u0434\u043F\u0438\u0441\u0447\u0438\u043A\u0438"}),e.jsx(l,{variant:"body2",children:F||0})]})}):e.jsx(J,{item:!0,xs:6,children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.8rem"},children:"\u041F\u043E\u0434\u043F\u0438\u0441\u0447\u0438\u043A\u0438"}),me?e.jsx(xe,{size:20}):L&&L.length>0?e.jsxs(o,{sx:{display:"flex",gap:1},children:[L.slice(0,3).map(r=>e.jsx(se,{title:r.name,arrow:!0,children:e.jsx(ce,{src:r.avatar_url,alt:r.name,component:ae,to:`/profile/${r.username}`,sx:{width:32,height:32,border:t.status_color&&t.status_text&&t.subscription?`1px solid ${t.status_color}`:"1px solid #D0BCFF",flexShrink:0},onError:j=>{r.id&&(j.target.src=`/static/uploads/avatar/${r.id}/${r.photo||"avatar.png"}`)}})},r.id)),t?.friends_count>3&&e.jsx(se,{title:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0441\u0435\u0445 \u043F\u043E\u0434\u043F\u0438\u0441\u0447\u0438\u043A\u043E\u0432",arrow:!0,children:e.jsxs(ce,{component:ae,to:`/profile/${t?.username}/followers`,sx:{width:32,height:32,bgcolor:t.status_color&&t.status_text&&t.subscription?`${t.status_color}26`:"rgba(208, 188, 255, 0.15)",fontSize:"0.75rem",color:t.status_color&&t.status_text&&t.subscription?t.status_color:"#D0BCFF",flexShrink:0},children:["+",t?.friends_count-3]})})]}):e.jsx(l,{variant:"caption",color:"text.secondary",children:"\u041D\u0435\u0442 \u043F\u043E\u0434\u043F\u0438\u0441\u0447\u0438\u043A\u043E\u0432"})]})}),e.jsx(J,{item:!0,xs:6,children:e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",sx:{fontSize:"0.8rem"},children:"\u041F\u043E\u0434\u043F\u0438\u0441\u043A\u0438"}),t?.subscription&&t.subscription.type==="channel"?e.jsx(l,{variant:"body2",children:V||0}):oe?e.jsx(xe,{size:20}):$.length>0?e.jsxs(o,{sx:{display:"flex",gap:1},children:[$.slice(0,3).map(r=>e.jsx(se,{title:r.name,arrow:!0,children:e.jsx(ce,{src:r.avatar_url,alt:r.name,component:ae,to:`/profile/${r.username}`,sx:{width:32,height:32,border:t.status_color&&t.status_text&&t.subscription?`1px solid ${t.status_color}`:"1px solid #D0BCFF",flexShrink:0},onError:j=>{r.id&&(j.target.src=`/static/uploads/avatar/${r.id}/${r.photo||"avatar.png"}`)}})},r.id)),V>3&&e.jsx(se,{title:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0441\u0435\u0445",arrow:!0,children:e.jsxs(ce,{component:ae,to:`/profile/${t?.username}/following`,sx:{width:32,height:32,bgcolor:t.status_color&&t.status_text&&t.subscription?`${t.status_color}26`:"rgba(208, 188, 255, 0.15)",fontSize:"0.75rem",color:t.status_color&&t.status_text&&t.subscription?t.status_color:"#D0BCFF",flexShrink:0},children:["+",V-3]})})]}):e.jsx(l,{variant:"caption",color:"text.secondary",children:t?.subscription&&t.subscription.type==="channel"?"\u041D\u0435\u0442 \u043F\u043E\u0434\u043F\u0438\u0441\u0447\u0438\u043A\u043E\u0432":"\u041D\u0435\u0442 \u0434\u0440\u0443\u0437\u0435\u0439"})]})})]}),ie&&ie.length>0&&e.jsx(o,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:3,pt:2,borderTop:"1px solid rgba(255,255,255,0.08)"},children:ie.map((r,j)=>e.jsx(se,{title:r.title||r.name,arrow:!0,children:e.jsx(G,{component:"a",href:r.url||r.link,target:"_blank",rel:"noopener noreferrer",size:"small",sx:{color:t.status_color&&t.status_text&&t.subscription?t.status_color:r.color||"primary.main",padding:1,bgcolor:"rgba(255, 255, 255, 0.07)","&:hover":{bgcolor:t.status_color&&t.status_text&&t.subscription?`${t.status_color}15`:"rgba(255, 255, 255, 0.12)",transform:"translateY(-2px)",transition:"transform 0.2s"}},children:r.icon?e.jsx(o,{component:"img",src:r.icon,alt:r.title||r.name,sx:{width:20,height:20}}):e.jsx(o,{component:"div",sx:{width:20,height:20,fontSize:18,display:"flex",alignItems:"center",justifyContent:"center"},children:r.name?.toLowerCase().includes("instagram")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})}):r.name?.toLowerCase().includes("facebook")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5 1.583-5 4.615v3.385z"})}):r.name?.toLowerCase().includes("twitter")||r.name?.toLowerCase().includes("x")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"})}):r.name?.toLowerCase().includes("vk")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M13.162 18.994c.609 0 .858-.406.851-.915-.031-1.917.714-2.949 2.059-1.604 1.488 1.488 1.796 2.519 3.603 2.519h3.2c.808 0 1.126-.26 1.126-.668 0-.863-1.421-2.386-2.625-3.504-1.686-1.565-1.765-1.602-.313-3.486 1.801-2.339 4.157-5.336 2.073-5.336h-3.981c-.772 0-.828.435-1.103 1.083-.995 2.347-2.886 5.387-3.604 4.922-.751-.485-.407-2.406-.35-5.261.015-.754.011-1.271-1.141-1.539-.629-.145-1.241-.205-1.809-.205-2.273 0-3.841.953-2.95 1.119 1.571.293 1.42 3.692 1.054 5.16-.638 2.556-3.036-2.024-4.035-4.305-.241-.548-.315-.974-1.175-.974h-3.255c-.492 0-.787.16-.787.516 0 .602 2.96 6.72 5.786 9.77 2.756 2.975 5.48 2.708 7.376 2.708z"})}):r.name?.toLowerCase().includes("youtube")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"})}):r.name?.toLowerCase().includes("telegram")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M9.78 18.65l.28-4.23 7.68-6.92c.34-.31-.07-.46-.52-.19l-9.5 5.97-4.1-1.34c-.88-.28-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.81c-.19.91-.74 1.13-1.5.71l-4.14-3.05-1.99 1.93c-.23.23-.42.42-.83.42z"})}):r.name?.toLowerCase().includes("element")?e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 12.7 12.7",fill:"currentColor",children:[e.jsx("path",{d:"M 4.9717204,2.3834823 A 5.0230292,5.0230292 0 0 0 0.59994682,7.3615548 5.0230292,5.0230292 0 0 0 5.6228197,12.384429 5.0230292,5.0230292 0 0 0 10.645693,7.3615548 5.0230292,5.0230292 0 0 0 10.630013,6.9628311 3.8648402,3.8648402 0 0 1 8.6139939,7.532543 3.8648402,3.8648402 0 0 1 4.7492118,3.6677608 3.8648402,3.8648402 0 0 1 4.9717204,2.3834823 Z"}),e.jsx("circle",{cx:"8.6142359",cy:"3.6677198",r:"3.5209935"})]}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z"})})})})},j))}),!Ze&&(!i?.account_type||i.account_type!=="channel")&&e.jsx(o,{sx:{display:"flex",gap:1,mt:2,justifyContent:"center"},children:e.jsx(le,{variant:"contained",color:"primary",startIcon:m?e.jsx(or,{}):e.jsx(Jt,{}),onClick:async()=>{if(((r,j,O)=>!(!j||!r)||(O("/login",{state:{from:window.location.pathname,message:"\u0414\u043B\u044F \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u044D\u0442\u043E\u0433\u043E \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u0430 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u044F"}}),!1))(i,h,x))try{const r=await ee.post("/api/profile/follow",{followed_id:t.id});r.data.success&&(y(r.data.is_following),W(j=>r.data.is_following?j+1:j-1))}catch{}},fullWidth:!0,sx:{borderRadius:6,py:.7,fontWeight:"bold",textTransform:"none",boxShadow:t.status_color&&t.status_text&&t.subscription?`0 2px 8px ${t.status_color}40`:"0 2px 8px rgba(208, 188, 255, 0.25)",backgroundColor:m?"rgba(255, 255, 255, 0.1)":t.status_color&&t.status_text&&t.subscription?t.status_color:"primary.main",color:m?"text.primary":"#fff",transition:"all 0.2s ease","&:hover":{backgroundColor:m?"rgba(255, 255, 255, 0.15)":t.status_color&&t.status_text&&t.subscription?`${t.status_color}E6`:"primary.dark",transform:"translateY(-2px)",boxShadow:t.status_color&&t.status_text&&t.subscription?`0 4px 12px ${t.status_color}66`:"0 4px 12px rgba(208, 188, 255, 0.4)"},"&:active":{transform:"translateY(0)"}},children:m?"\u041E\u0442\u043F\u0438\u0441\u0430\u0442\u044C\u0441\u044F":"\u041F\u043E\u0434\u043F\u0438\u0441\u0430\u0442\u044C\u0441\u044F"})})]})]})]}),t&&t.account_type!=="channel"&&e.jsx(o,{sx:{position:"relative",zIndex:1},children:e.jsx(Pr,{userIdentifier:t.id})})]}),e.jsxs(J,{item:!0,xs:12,md:7,sx:{pt:0,ml:{xs:0,md:"5px"},mb:"100px"},children:[e.jsx(he,{sx:{borderRadius:"12px",background:"rgba(255, 255, 255, 0.03)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.2)",overflow:"hidden",mb:"5px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsxs(Ht,{value:w,onChange:(r,j)=>{A(j)},indicatorColor:"primary",variant:"fullWidth",sx:{"& .MuiTab-root":{color:r=>r.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)","&.Mui-selected":{color:r=>r.palette.primary.main}},"& .MuiTabs-indicator":{backgroundColor:"primary.main"}},children:[e.jsx(We,{label:"\u041F\u043E\u0441\u0442\u044B"}),e.jsx(We,{label:"\u0421\u0442\u0435\u043D\u0430"}),e.jsx(We,{label:"\u041F\u0440\u043E\u0444\u0438\u043B\u044C"})]})}),e.jsxs(Le,{value:w,index:0,sx:{p:0,mt:1},children:[Ze&&e.jsx(vt,{onPostCreated:Ne}),e.jsx(Et,{})]}),e.jsxs(Le,{value:w,index:1,sx:{p:0,mt:1},children:[i&&(!i.subscription||i.subscription.type!=="channel")&&e.jsx(vt,{onPostCreated:Ne,postType:"stena",recipientId:t.id}),e.jsx(Wt,{userId:t.id})]}),e.jsx(Le,{value:w,index:2,sx:{p:0,mt:1},children:e.jsx(he,{sx:{p:3,borderRadius:"12px",background:"rgba(255, 255, 255, 0.03)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.2)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:e.jsxs(J,{container:!0,spacing:3,children:[e.jsx(J,{item:!0,xs:12,children:e.jsxs(o,{sx:{mb:2},children:[t?.connect_info&&t.connect_info.length>0&&e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:2,p:2,borderRadius:2,bgcolor:r=>r.palette.mode==="dark"?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.03)",border:r=>r.palette.mode==="dark"?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.05)"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(l,{component:ae,to:`/profile/${t.username}`,sx:{color:"text.primary",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:["@",t.username]}),e.jsx(l,{sx:{mx:1,color:"text.secondary"},children:"\u2022"}),e.jsxs(l,{sx:{color:"text.secondary"},children:[t.connect_info[0].days," \u0434\u043D\u0435\u0439"]}),e.jsx(l,{sx:{mx:1,color:"text.secondary"},children:"\u2022"}),e.jsxs(l,{component:ae,to:`/profile/${t.connect_info[0].username}`,sx:{color:"text.primary",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:["@",t.connect_info[0].username]})]})}),t?.about&&e.jsx(l,{variant:"body2",sx:{mt:1,lineHeight:1.5,color:t?.status_color?ye(t.status_color):r=>r.palette.text.secondary,p:1.5,borderRadius:2,background:r=>r.palette.mode==="dark"?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.03)",backdropFilter:"blur(10px)",border:r=>r.palette.mode==="dark"?"1px solid rgba(255,255,255,0.05)":"1px solid rgba(0,0,0,0.05)",overflowWrap:"break-word",wordBreak:"break-word",whiteSpace:"normal"},children:t.about})]})}),t?.location&&e.jsx(J,{item:!0,xs:12,sm:6,children:e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(rt,{color:"primary",sx:{mt:.5}}),e.jsxs(o,{children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"\u041C\u0435\u0441\u0442\u043E\u043F\u043E\u043B\u043E\u0436\u0435\u043D\u0438\u0435"}),e.jsx(l,{variant:"body2",children:t.location})]})]})}),t?.website&&e.jsx(J,{item:!0,xs:12,sm:6,children:e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(ir,{color:"primary",sx:{mt:.5}}),e.jsxs(o,{children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"\u0412\u0435\u0431-\u0441\u0430\u0439\u0442"}),e.jsx(l,{variant:"body2",children:e.jsx(ae,{href:t.website,target:"_blank",rel:"noopener noreferrer",sx:{color:"primary.main"},children:t.website.replace(/^https?:\/\//,"")})})]})]})}),t?.birthday&&e.jsx(J,{item:!0,xs:12,sm:6,children:e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(st,{color:"primary",sx:{mt:.5}}),e.jsxs(o,{children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"\u0414\u0430\u0442\u0430 \u0440\u043E\u0436\u0434\u0435\u043D\u0438\u044F"}),e.jsx(l,{variant:"body2",children:tr(t.birthday)})]})]})}),e.jsx(J,{item:!0,xs:12,sm:6,children:e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(gr,{color:"primary",sx:{mt:.5}}),e.jsxs(o,{children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"\u0414\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"}),e.jsx(l,{variant:"body2",children:t?.registration_date?new Date(t.registration_date).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"}):"\u041D\u0435\u0434\u043E\u0441\u0442\u0443\u043F\u043D\u043E"})]})]})}),t?.purchased_usernames&&t.purchased_usernames.length>0&&e.jsx(J,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(rr,{color:"primary",sx:{mt:.5}}),e.jsxs(o,{children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"\u042E\u0437\u0435\u0440\u043D\u0435\u0439\u043C\u044B"}),e.jsx(o,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:t.purchased_usernames.map((r,j)=>e.jsx(Fe,{label:r.username,size:"small",variant:r.is_active?"filled":"outlined",color:r.is_active?"primary":"default",onClick:O=>Xe(O,r.username),sx:{"& .MuiChip-label":{px:1}}},j))})]})]})}),ze&&ze.length>0&&e.jsx(J,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,pb:2,borderBottom:"1px solid rgba(255,255,255,0.07)"},children:[e.jsx(qt,{color:"primary",sx:{mt:.5}}),e.jsxs(o,{children:[e.jsx(l,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"\u041C\u0435\u0434\u0430\u043B\u0438"}),e.jsx(o,{sx:{display:"flex",flexWrap:"wrap",gap:2,mt:1},children:ze.map(r=>e.jsx(se,{title:e.jsxs(o,{children:[r.description&&e.jsx(l,{variant:"caption",children:r.description}),e.jsxs(l,{variant:"caption",display:"block",sx:{mt:.5,opacity:.8},children:["\u0412\u044B\u0434\u0430\u043D\u0430: ",new Date(r.awarded_at).toLocaleDateString()]}),e.jsxs(l,{variant:"caption",display:"block",sx:{opacity:.8},children:["\u041A\u0435\u043C: @",r.awarded_by]})]}),arrow:!0,children:e.jsx("img",{src:r.image_path,alt:r.name,style:{width:150,height:150,cursor:"pointer",transition:"transform 0.2s",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},onMouseOver:j=>{j.currentTarget.style.transform="translateY(-2px)",j.currentTarget.style.filter="drop-shadow(0 4px 8px rgba(0,0,0,0.3))"},onMouseOut:j=>{j.currentTarget.style.transform="translateY(0)",j.currentTarget.style.filter="drop-shadow(0 2px 4px rgba(0,0,0,0.2))"}})},r.id))})]})]})})]})})})]})]}),ue&&e.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:Ve,children:[e.jsx("img",{src:u,alt:"Full size",style:{maxWidth:"90%",maxHeight:"90%",objectFit:"contain"},onClick:r=>r.stopPropagation()}),e.jsx(G,{sx:{position:"absolute",top:20,right:20,color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},onClick:Ve,children:e.jsx(ge,{})})]}),e.jsx(Ke,{open:g.open,autoHideDuration:4e3,onClose:Ye,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(Ee,{onClose:Ye,severity:g.severity,variant:"filled",children:g.message})}),e.jsx(Qe,{children:He&&e.jsx(sr,{username:He,onClose:()=>{Oe(!1)},open:$t})})]})};export{Nr as default};

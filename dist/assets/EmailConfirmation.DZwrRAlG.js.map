{"version":3,"file":"EmailConfirmation.DZwrRAlG.js","sources":["../../src/pages/Auth/EmailConfirmation.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { \n  Box, \n  Typography, \n  CircularProgress, \n  Paper, \n  Button,\n  Alert\n} from '@mui/material';\nimport CheckCircleIcon from '@mui/icons-material/CheckCircle';\nimport ErrorIcon from '@mui/icons-material/Error';\nimport axios from 'axios';\n\nconst EmailConfirmation = () => {\n  const { token } = useParams();\n  const navigate = useNavigate();\n  const [status, setStatus] = useState('loading'); \n  const [message, setMessage] = useState('');\n  const [chatId, setChatId] = useState('');\n\n  useEffect(() => {\n    const confirmEmail = async () => {\n      try {\n        const response = await axios.get(`/api/auth/confirm-email/${token}`);\n        if (response.data.success) {\n          setStatus('success');\n          setMessage(response.data.message);\n          \n          \n          if (response.data.chat_id) {\n            setChatId(response.data.chat_id);\n            \n            localStorage.setItem('k-connect-chat-id', response.data.chat_id);\n            console.log('Сохранен chat_id в localStorage:', response.data.chat_id);\n          }\n          \n          \n          if (response.data.needs_profile_setup) {\n            \n            setTimeout(() => {\n              navigate('/register/profile', { replace: true });\n            }, 2000);\n          } else {\n            \n            setTimeout(() => {\n              navigate('/login', { replace: true });\n            }, 2000);\n          }\n        }\n      } catch (error) {\n        setStatus('error');\n        setMessage(error.response?.data?.error || 'Произошла ошибка при подтверждении email.');\n      }\n    };\n\n    confirmEmail();\n  }, [token, navigate]);\n\n  return (\n    <Box\n      sx={{\n        minHeight: '100vh',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        padding: 2,\n        backgroundImage: 'linear-gradient(120deg, #321d5b 0%, #1a1a1a 100%)',\n      }}\n    >\n      <Paper\n        elevation={6}\n        sx={{\n          padding: 4,\n          borderRadius: 2,\n          maxWidth: 500,\n          width: '100%',\n          textAlign: 'center',\n          backgroundColor: 'rgba(26, 26, 26, 0.9)',\n          backdropFilter: 'blur(10px)',\n          boxShadow: '0 8px 32px rgba(0, 0, 0, 0.2)',\n        }}\n      >\n        {status === 'loading' && (\n          <>\n            <CircularProgress \n              size={80} \n              sx={{ color: 'var(--primary)', mb: 3 }} \n            />\n            <Typography variant=\"h5\" gutterBottom sx={{ fontWeight: 'bold' }}>\n              Подтверждение Email\n            </Typography>\n            <Typography variant=\"body1\" color=\"text.secondary\">\n              Пожалуйста, подождите, мы подтверждаем ваш Email...\n            </Typography>\n          </>\n        )}\n\n        {status === 'success' && (\n          <>\n            <CheckCircleIcon \n              sx={{ fontSize: 80, color: 'success.main', mb: 3 }} \n            />\n            <Typography variant=\"h5\" gutterBottom sx={{ fontWeight: 'bold' }}>\n              Email подтвержден!\n            </Typography>\n            <Typography variant=\"body1\" color=\"text.secondary\" sx={{ mb: 3 }}>\n              {message}\n            </Typography>\n            <Alert severity=\"info\" sx={{ mb: 3 }}>\n              Вы будете перенаправлены автоматически через несколько секунд.\n            </Alert>\n            <Button \n              variant=\"contained\" \n              color=\"primary\" \n              onClick={() => {\n                if (status === 'success' && message.includes('создать профиль')) {\n                  navigate('/register/profile');\n                } else {\n                  navigate('/login');\n                }\n              }}\n              sx={{ \n                borderRadius: '20px',\n                background: 'var(--primary)', \n                '&:hover': { \n                  background: 'var(--primary-dark)' \n                }\n              }}\n            >\n              {status === 'success' && message.includes('создать профиль') \n                ? 'Создать профиль' \n                : 'Перейти на страницу входа'}\n            </Button>\n          </>\n        )}\n\n        {status === 'error' && (\n          <>\n            <ErrorIcon \n              sx={{ fontSize: 80, color: 'error.main', mb: 3 }} \n            />\n            <Typography variant=\"h5\" gutterBottom sx={{ fontWeight: 'bold' }}>\n              Ошибка подтверждения\n            </Typography>\n            <Typography variant=\"body1\" color=\"text.secondary\" sx={{ mb: 3 }}>\n              {message}\n            </Typography>\n            <Button \n              variant=\"contained\" \n              color=\"primary\" \n              onClick={() => navigate('/login')}\n              sx={{ \n                borderRadius: '20px',\n                background: 'var(--primary)', \n                '&:hover': { \n                  background: 'var(--primary-dark)' \n                }\n              }}\n            >\n              Вернуться на страницу входа\n            </Button>\n          </>\n        )}\n      </Paper>\n    </Box>\n  );\n};\n\nexport default EmailConfirmation; "],"names":["EmailConfirmation","token","useParams","navigate","useNavigate","status","setStatus","useState","message","setMessage","chatId","setChatId","useEffect","async","response","axios","get","data","success","chat_id","localStorage","setItem","needs_profile_setup","setTimeout","replace","error","confirmEmail","jsx","Box","sx","minHeight","display","alignItems","justifyContent","padding","backgroundImage","children","jsxs","Paper","elevation","borderRadius","maxWidth","width","textAlign","backgroundColor","backdropFilter","boxShadow","Fragment","CircularProgress","size","color","mb","Typography","variant","gutterBottom","fontWeight","CheckCircleIcon","fontSize","Alert","severity","Button","onClick","includes","background","ErrorIcon"],"mappings":"gRAcA,MAAMA,EAAoBA,KAClB,MAAAC,MAAEA,GAAUC,IACZC,EAAWC,KACVC,EAAQC,GAAaC,EAAAA,SAAS,YAC9BC,EAASC,GAAcF,EAAAA,SAAS,KAChCG,EAAQC,GAAaJ,EAAAA,SAAS,IAyCnC,OAvCFK,EAAAA,UAAU,KACaC,WACf,IACF,MAAMC,QAAiBC,EAAMC,IAAI,2BAA2Bf,KACxDa,EAASG,KAAKC,UAChBZ,EAAU,WACCQ,EAAAA,EAASG,KAAKT,SAGrBM,EAASG,KAAKE,UACNL,EAAAA,EAASG,KAAKE,SAExBC,aAAaC,QAAQ,oBAAqBP,EAASG,KAAKE,UAKtDL,EAASG,KAAKK,oBAEhBC,WAAW,KACTpB,EAAS,oBAAqB,CAAEqB,SAAS,KACxC,KAGHD,WAAW,KACTpB,EAAS,SAAU,CAAEqB,SAAS,KAC7B,YAGAC,GACPnB,EAAU,SACVG,EAAWgB,EAAMX,UAAUG,MAAMQ,OAAS,4CAA2C,GAI5EC,IACZ,CAACzB,EAAOE,IAGTwB,EAAAA,IAACC,GACCC,GAAI,CACFC,UAAW,QACXC,QAAS,OACTC,WAAY,SACZC,eAAgB,SAChBC,QAAS,EACTC,gBAAiB,qDAGnBC,SAAAC,EAAAA,KAACC,EACC,CAAAC,UAAW,EACXV,GAAI,CACFK,QAAS,EACTM,aAAc,EACdC,SAAU,IACVC,MAAO,OACPC,UAAW,SACXC,gBAAiB,wBACjBC,eAAgB,aAChBC,UAAW,iCAGZzC,SAAAA,CAAW,YAAXA,GAEGgC,EAAAA,KAAAU,EAAAA,SAAA,CAAAX,SAAA,CAACT,EAAAA,IAAAqB,EAAA,CACCC,KAAM,GACNpB,GAAI,CAAEqB,MAAO,iBAAkBC,GAAI,WAEpCC,EAAW,CAAAC,QAAQ,KAAKC,cAAY,EAACzB,GAAI,CAAE0B,WAAY,QAASnB,SAEjE,8BACCgB,EAAW,CAAAC,QAAQ,QAAQH,MAAM,iBAAgBd,SAElD,2DAIQ,YAAX/B,GAEGgC,EAAAA,KAAAU,EAAAA,SAAA,CAAAX,SAAA,CAAAT,MAAC6B,GACC3B,GAAI,CAAE4B,SAAU,GAAIP,MAAO,eAAgBC,GAAI,WAEhDC,EAAW,CAAAC,QAAQ,KAAKC,cAAY,EAACzB,GAAI,CAAE0B,WAAY,QAASnB,SAEjE,6BACCgB,EAAW,CAAAC,QAAQ,QAAQH,MAAM,iBAAiBrB,GAAI,CAAEsB,GAAI,GAC1D3C,SACHA,IACCmB,EAAAA,IAAA+B,EAAA,CAAMC,SAAS,OAAO9B,GAAI,CAAEsB,GAAI,GAAIf,SAErC,yEACCwB,EACC,CAAAP,QAAQ,YACRH,MAAM,UACNW,QAAS,KACQ,YAAXxD,GAAwBG,EAAQsD,SAAS,mBAC3C3D,EAAS,qBAETA,EAAS,WAGb0B,GAAI,CACFW,aAAc,OACduB,WAAY,iBACZ,UAAW,CACTA,WAAY,wBAIf1D,SAAW,eAAaG,EAAQsD,SAAS,mBACtC,kBACA,iCAKE,UAAXzD,GAEGgC,EAAAA,KAAAU,EAAAA,SAAA,CAAAX,SAAA,CAAAT,MAACqC,GACCnC,GAAI,CAAE4B,SAAU,GAAIP,MAAO,aAAcC,GAAI,WAE9CC,EAAW,CAAAC,QAAQ,KAAKC,cAAY,EAACzB,GAAI,CAAE0B,WAAY,QAASnB,SAEjE,+BACCgB,EAAW,CAAAC,QAAQ,QAAQH,MAAM,iBAAiBrB,GAAI,CAAEsB,GAAI,GAC1D3C,SACHA,IACAmB,EAAAA,IAACiC,EACC,CAAAP,QAAQ,YACRH,MAAM,UACNW,QAAS,IAAM1D,EAAS,UACxB0B,GAAI,CACFW,aAAc,OACduB,WAAY,iBACZ,UAAW,CACTA,WAAY,wBAEd3B,SAGJ"}
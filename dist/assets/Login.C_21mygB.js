import{b as T,g as L,j as e,h as B,a0 as M,P as I,i as l,T as a,l as f,A as $,m as E,I as J,w as N,a1 as P,a2 as G,L as W,o as H,V as Z}from"./vendor-mui.08p3AH88.js";import{r as n,u as U,d as V,L as y}from"./vendor-router.BRqU_Zs2.js";import{A as q}from"./index.CdVNWeFt.js";import{m as w}from"./vendor.CL98q8z6.js";import"./vendor-react.DF-_cTkv.js";const K=()=>{const A=T(),i=L(A.breakpoints.down("sm")),[C,R]=n.useState({usernameOrEmail:"",password:""}),[F,z]=n.useState(!1),[g,u]=n.useState(!1),[p,s]=n.useState(""),[m,v]=n.useState(null),[h,_]=n.useState("/"),c=U(),S=V(),{login:O,isAuthenticated:j,error:x,checkAuth:D}=n.useContext(q);n.useEffect(()=>{const r=S.state?.from,t=new URLSearchParams(S.search).get("redirectTo"),o=localStorage.getItem("redirect_after_login");t?_(t):r?_(r):o&&(_(o),localStorage.removeItem("redirect_after_login"))},[S]),n.useEffect(()=>{(async()=>{try{if(document.cookie.split(";").some(r=>r.trim().startsWith("kconnect_session=")))return void c(h,{replace:!0});await D(),j&&c(h,{replace:!0})}catch{}})()},[D,j,c,h]),n.useEffect(()=>{const r=localStorage.getItem("login_error");if(r){try{const t=JSON.parse(r);t.ban_info?v(t.ban_info):s(r)}catch{s(r)}localStorage.removeItem("login_error")}},[]),n.useEffect(()=>{if(x)if(x.ban_info)v(x.ban_info),localStorage.setItem("login_error",JSON.stringify(x));else{const r=x.details||x.message||"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u0445\u043E\u0434\u0435";s(r),localStorage.setItem("login_error",r)}},[x]),n.useEffect(()=>{!j||p||x||g||m||(localStorage.removeItem("login_error"),c(h,{replace:!0}))},[j,c,p,x,g,m,h]),n.useEffect(()=>{const r=t=>{if(t.data.type==="telegram-auth-success"){u(!0);try{t.data.user&&localStorage.setItem("kconnect-user",JSON.stringify(t.data.user)),t.data.needs_profile_setup?localStorage.setItem("k-connect-needs-profile-setup","true"):localStorage.removeItem("k-connect-needs-profile-setup"),t.data.needs_profile_setup?c("/register/profile"):t.data.redirect?c(t.data.redirect):c(h!=="/"?h:"/profile")}catch{s("\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0432\u0445\u043E\u0434\u0435 \u0447\u0435\u0440\u0435\u0437 Telegram. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0441\u043D\u043E\u0432\u0430.")}finally{u(!1)}}};return window.addEventListener("message",r),()=>{window.removeEventListener("message",r)}},[c,h]);const k=r=>{const{name:t,value:o}=r.target;R(d=>({...d,[t]:o})),s(""),v(null),localStorage.removeItem("login_error")};return m?e.jsx(B,{maxWidth:!1,disableGutters:!0,sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",width:"100%"},children:e.jsx(M,{in:!0,timeout:800,children:e.jsxs(I,{elevation:6,sx:{p:i?3:4,width:"90%",maxWidth:"480px",borderRadius:4,background:"rgba(30, 30, 40, 0.9)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs(l,{sx:{textAlign:"center",mb:4},children:[e.jsx("img",{src:"/static/icons/clear-logonew.svg",alt:"\u041A-\u041A\u043E\u043D\u043D\u0435\u043A\u0442 \u041B\u043E\u0433\u043E",style:{width:i?80:100,marginBottom:16}}),e.jsx(a,{variant:"h4",component:"h1",sx:{fontWeight:700,mb:1},children:"\u0410\u043A\u043A\u0430\u0443\u043D\u0442 \u0437\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u043D"}),e.jsx(a,{variant:"body1",color:"text.secondary",children:"\u0412\u0445\u043E\u0434 \u0432 \u0430\u043A\u043A\u0430\u0443\u043D\u0442 \u0432\u0440\u0435\u043C\u0435\u043D\u043D\u043E \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D"})]}),e.jsxs(I,{elevation:0,sx:{p:3,mb:3,width:"100%",backgroundColor:"rgba(211, 47, 47, 0.1)",border:"1px solid rgba(211, 47, 47, 0.3)",borderRadius:3},children:[e.jsx(a,{variant:"h6",sx:{color:"#d32f2f",mb:1},children:"\u0412\u0430\u0448 \u0430\u043A\u043A\u0430\u0443\u043D\u0442 \u0432\u0440\u0435\u043C\u0435\u043D\u043D\u043E \u0437\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u043D"}),e.jsxs(a,{variant:"body1",sx:{mb:2},children:["\u041F\u0440\u0438\u0447\u0438\u043D\u0430: ",m.reason]}),e.jsxs(a,{variant:"body1",sx:{mb:1},children:["\u0411\u0430\u043D \u0438\u0441\u0442\u0435\u0447\u0435\u0442: ",m.formatted_end_date]}),e.jsxs(a,{variant:"body1",sx:{mb:1},children:["\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C \u0434\u043D\u0435\u0439: ",m.remaining_days]}),m.is_auto_ban&&e.jsx(a,{variant:"body2",sx:{mt:2,fontStyle:"italic"},children:"\u0411\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u043A\u0430 \u0432\u044B\u0434\u0430\u043D\u0430 \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438 \u0437\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0435 3 \u043F\u0440\u0435\u0434\u0443\u043F\u0440\u0435\u0436\u0434\u0435\u043D\u0438\u0439 \u043E\u0442 \u043C\u043E\u0434\u0435\u0440\u0430\u0442\u043E\u0440\u043E\u0432."})]}),e.jsx(l,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(f,{component:y,to:"/",variant:"outlined",sx:{mt:2,py:1.5,borderRadius:2,borderColor:"#D0BCFF",color:"#D0BCFF","&:hover":{borderColor:"#B69DF8",backgroundColor:"rgba(208, 188, 255, 0.04)"}},children:"\u0412\u0435\u0440\u043D\u0443\u0442\u044C\u0441\u044F \u043D\u0430 \u0433\u043B\u0430\u0432\u043D\u0443\u044E"})})]})})}):e.jsxs(B,{disableGutters:!0,maxWidth:!1,sx:{display:"flex",minHeight:"100vh",width:"100%",overflow:"hidden",position:"relative"},children:[!i&&e.jsxs(l,{sx:{flex:"0 0 45%",background:"linear-gradient(135deg, rgba(20, 20, 30, 1) 0%, rgba(40, 40, 60, 0.95) 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",p:6},children:[e.jsx(l,{sx:{position:"absolute",width:"200%",height:"200%",top:"-50%",left:"-50%",background:"radial-gradient(circle, rgba(208, 188, 255, 0.05) 0%, rgba(208, 188, 255, 0) 70%)",zIndex:0}}),e.jsx(w.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.7,delay:.2},style:{position:"relative",zIndex:1},children:e.jsx("img",{src:"/static/icons/clear-logonew.svg",alt:"\u041A-\u041A\u043E\u043D\u043D\u0435\u043A\u0442 \u041B\u043E\u0433\u043E",style:{width:180,marginBottom:40}})}),e.jsxs(w.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.5},style:{position:"relative",zIndex:1,textAlign:"center"},children:[e.jsxs(a,{variant:"h3",sx:{fontWeight:700,mb:2},children:[e.jsx("span",{style:{color:"#D0BCFF"},children:"\u041A"}),"-\u041A\u041E\u041D\u041D\u0415\u041A\u0422"]}),e.jsx(a,{variant:"h6",color:"text.secondary",sx:{maxWidth:400,mb:3},children:"\u041F\u0440\u0438\u0441\u043E\u0435\u0434\u0438\u043D\u044F\u0439\u0442\u0435\u0441\u044C \u043A \u043D\u0430\u0448\u0435\u043C\u0443 \u0441\u043E\u043E\u0431\u0449\u0435\u0441\u0442\u0432\u0443 \u0438 \u043E\u0442\u043A\u0440\u044B\u0432\u0430\u0439\u0442\u0435 \u043D\u043E\u0432\u044B\u0435 \u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E\u0441\u0442\u0438"}),e.jsx(f,{component:y,to:"/about",variant:"outlined",sx:{color:"#D0BCFF",borderColor:"#D0BCFF","&:hover":{borderColor:"#B69DF8",backgroundColor:"rgba(208, 188, 255, 0.04)"}},children:"\u0423\u0437\u043D\u0430\u0442\u044C \u0431\u043E\u043B\u044C\u0448\u0435 \u043E \u041A-\u041A\u043E\u043D\u043D\u0435\u043A\u0442"})]}),e.jsx(l,{sx:{position:"absolute",bottom:40,left:0,right:0,display:"flex",justifyContent:"center",gap:2},children:[...Array(3)].map((r,t)=>e.jsx(w.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.4,delay:.8+.2*t},children:e.jsx(l,{sx:{width:12+4*t,height:12+4*t,borderRadius:"50%",background:`rgba(208, 188, 255, ${.6-.15*t})`}})},t))})]}),e.jsx(l,{sx:{flex:i?1:"0 0 55%",display:"flex",alignItems:"center",justifyContent:"center",p:0,background:i?"linear-gradient(135deg, rgba(20, 20, 30, 1) 0%, rgba(40, 40, 60, 0.95) 100%)":"transparent"},children:e.jsxs(w.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",padding:i?"16px":"40px"},children:[i&&e.jsxs(l,{sx:{position:"absolute",top:"32px",left:0,width:"100%",textAlign:"center"},children:[e.jsx("img",{src:"/static/icons/clear-logonew.svg",alt:"\u041A-\u041A\u043E\u043D\u043D\u0435\u043A\u0442 \u041B\u043E\u0433\u043E",style:{width:90,marginBottom:16}}),e.jsxs(a,{variant:"h4",component:"h1",sx:{fontWeight:700},children:[e.jsx("span",{style:{color:"#D0BCFF"},children:"\u041A"}),"-\u041A\u041E\u041D\u041D\u0415\u041A\u0422"]}),e.jsx(f,{component:y,to:"/about",variant:"text",sx:{mt:1,color:"#D0BCFF","&:hover":{backgroundColor:"rgba(208, 188, 255, 0.04)"}},children:"\u041E \u041A-\u041A\u043E\u043D\u043D\u0435\u043A\u0442"})]}),e.jsxs(I,{elevation:i?0:6,sx:{p:i?3:4,width:"100%",maxWidth:"480px",borderRadius:4,background:i?"transparent":"rgba(30, 30, 40, 0.85)",backdropFilter:"blur(10px)",border:i?"none":"1px solid rgba(255, 255, 255, 0.1)",mt:i?"120px":0},children:[e.jsx(a,{variant:"h5",component:"h2",sx:{mb:1,fontWeight:600},children:"\u0412\u0445\u043E\u0434 \u0432 \u0430\u043A\u043A\u0430\u0443\u043D\u0442"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"\u0412\u043E\u0439\u0434\u0438\u0442\u0435 \u0432 \u041A-\u041A\u043E\u043D\u043D\u0435\u043A\u0442 \u0434\u043B\u044F \u0434\u043E\u0441\u0442\u0443\u043F\u0430 \u043A \u0441\u0432\u043E\u0435\u043C\u0443 \u043F\u0440\u043E\u0444\u0438\u043B\u044E"}),p&&e.jsx($,{severity:"error",sx:{mb:3,borderRadius:2,"& .MuiAlert-icon":{alignItems:"center"}},children:p}),e.jsxs("form",{onSubmit:async r=>{if(r.preventDefault(),!g){u(!0),s(""),v(null),localStorage.removeItem("login_error");try{const{usernameOrEmail:t,password:o}=C;if(!t||!o){const b="\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u0432\u0441\u0435 \u043F\u043E\u043B\u044F";return s(b),localStorage.setItem("login_error",b),void u(!1)}const d=await O({usernameOrEmail:t,password:o,preventRedirect:!1});if(d&&!d.success){if(d.ban_info)v(d.ban_info),localStorage.setItem("login_error",JSON.stringify(d));else if(d.error){let b;b=d.error.includes("\u043D\u0435 \u0432\u0435\u0440\u0438\u0444\u0438\u0446\u0438\u0440\u043E\u0432\u0430\u043D")?"\u0412\u0430\u0448\u0430 \u043F\u043E\u0447\u0442\u0430 \u043D\u0435 \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0430. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u0440\u043E\u0432\u0435\u0440\u044C\u0442\u0435 \u0432\u0430\u0448\u0443 \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u0443\u044E \u043F\u043E\u0447\u0442\u0443 \u0438 \u043F\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043F\u043E \u0441\u0441\u044B\u043B\u043A\u0435 \u0432 \u043F\u0438\u0441\u044C\u043C\u0435 \u0434\u043B\u044F \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u044F \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430.":d.error,s(b),localStorage.setItem("login_error",b)}return u(!1),void document.getElementById("login-button")?.focus()}localStorage.removeItem("login_error")}catch{const o="\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u0430. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0441\u043D\u043E\u0432\u0430.";s(o),localStorage.setItem("login_error",o)}finally{u(!1)}}},style:{width:"100%"},children:[e.jsx(E,{fullWidth:!0,label:"Email \u0438\u043B\u0438 \u0438\u043C\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F",name:"usernameOrEmail",value:C.usernameOrEmail,onChange:k,error:!!p,disabled:g,sx:{mb:2}}),e.jsx(E,{fullWidth:!0,label:"\u041F\u0430\u0440\u043E\u043B\u044C",name:"password",type:F?"text":"password",value:C.password,onChange:k,error:!!p,disabled:g,InputProps:{endAdornment:e.jsx(J,{position:"end",children:e.jsx(N,{onClick:()=>{z(!F)},edge:"end",children:F?e.jsx(P,{}):e.jsx(G,{})})})}}),e.jsx(l,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:e.jsx(W,{component:y,to:"/forgot-password",sx:{color:"#D0BCFF",fontSize:"0.875rem",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"\u0417\u0430\u0431\u044B\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C?"})}),e.jsx(f,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{py:1.5,borderRadius:2,fontSize:"1rem",textTransform:"none",background:"linear-gradient(90deg, #B69DF8 0%, #D0BCFF 100%)",boxShadow:"0 4px 12px rgba(182, 157, 248, 0.3)","&:hover":{background:"linear-gradient(90deg, #D0BCFF 0%, #E9DDFF 100%)",boxShadow:"0 6px 16px rgba(182, 157, 248, 0.4)"}},disabled:g,id:"login-button",children:g?e.jsx(H,{size:24,color:"inherit"}):"\u0412\u043E\u0439\u0442\u0438"})]}),e.jsx(Z,{sx:{my:3,"&::before, &::after":{borderColor:"rgba(255,255,255,0.1)"}},children:e.jsx(a,{variant:"body2",color:"text.secondary",children:"\u0438\u043B\u0438"})}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(f,{fullWidth:!0,variant:"outlined",size:"large",startIcon:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 27 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M10.2194 5.27527C7.49181 5.62505 4.98695 6.93564 3.17176 8.96273C1.35657 10.9898 0.354917 13.5951 0.353516 16.2929C0.353608 19.2413 1.54789 22.0688 3.67364 24.1536C5.79939 26.2384 8.68251 27.4096 11.6888 27.4097C14.6951 27.4096 17.5782 26.2384 19.7039 24.1536C21.8297 22.0688 23.024 19.2413 23.024 16.2929C23.0242 15.9984 23.0124 15.704 22.9887 15.4105C21.6194 16.2335 20.045 16.6699 18.4391 16.6714C16.1259 16.6713 13.9075 15.7701 12.2719 14.166C10.6362 12.5619 9.71732 10.3862 9.71728 8.11768C9.71938 7.14916 9.88917 6.18803 10.2194 5.27527Z",fill:"#D0BCFF"}),e.jsx("path",{d:"M18.4401 15.9104C22.8285 15.9104 26.386 12.4214 26.386 8.11756C26.386 3.81372 22.8285 0.324768 18.4401 0.324768C14.0517 0.324768 10.4941 3.81372 10.4941 8.11756C10.4941 12.4214 14.0517 15.9104 18.4401 15.9104Z",fill:"#D0BCFF"})]}),onClick:()=>{const r=t=>{try{if(!/^https?:\/\/(.*\.)?elemsocial\.com(\/.*)?$/.test(t.origin))return;if(t.data&&typeof t.data=="string"){window.removeEventListener("message",r);let o=null;t.data.includes("/auth_elem/")?o=t.data.split("/auth_elem/")[1]:t.data.includes("/auth/element/")?o=t.data.split("/auth/element/")[1]:t.data.includes(".")&&(o=t.data),o&&(window.location.href=`/auth_elem/direct/${o}`)}}catch{}};window.addEventListener("message",r),window.location.href="https://elemsocial.com/connect_app/0195a00f-826a-7a34-85f1-45065c8c727d"},sx:{py:1.25,borderRadius:2,textTransform:"none",borderColor:"#D0BCFF",color:"#D0BCFF","&:hover":{borderColor:"#B69DF8",backgroundColor:"rgba(208, 188, 255, 0.04)"}},children:"\u0412\u043E\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 Element"}),e.jsx(f,{fullWidth:!0,variant:"outlined",onClick:()=>{s("");const r=window.screen.width/2-275,t=window.screen.height/2-325,o=window.open("/telegram-auth.html","TelegramAuth",`width=550,height=650,left=${r},top=${t}`);o&&!o.closed&&o.closed!==void 0||s("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0442\u043A\u0440\u044B\u0442\u044C \u043E\u043A\u043D\u043E \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u0440\u043E\u0432\u0435\u0440\u044C\u0442\u0435 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u043A\u0438 \u0432\u0441\u043F\u043B\u044B\u0432\u0430\u044E\u0449\u0438\u0445 \u043E\u043A\u043E\u043D \u0432 \u0432\u0430\u0448\u0435\u043C \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435.")},sx:{py:1.25,borderRadius:2,textTransform:"none",borderColor:"#0088cc",color:"#0088cc","&:hover":{borderColor:"#0088cc",backgroundColor:"rgba(0, 136, 204, 0.1)"},svg:{fill:"#0088cc"}},startIcon:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 240 240",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:`M120,0C53.73,0,0,53.73,0,120s53.73,120,120,120s120-53.73,120-120S186.27,0,120,0z M177.36,78.13l-20.52,97.21
                      c-1.55,6.99-5.61,8.71-11.36,5.42l-31.41-23.15l-15.15,14.59c-1.67,1.67-3.07,3.07-6.28,3.07l2.24-31.78l57.87-52.26
                      c2.51-2.24-0.55-3.49-3.89-1.26l-71.48,45.05l-30.78-9.61c-6.69-2.07-6.84-6.69,1.39-9.89l120.44-46.44
                      C173.26,66.55,179.35,70.1,177.36,78.13z`})}),children:"\u0412\u043E\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 Telegram"})]}),e.jsx(l,{sx:{textAlign:"center",mt:4},children:e.jsxs(a,{variant:"body2",children:["\u0415\u0449\u0451 \u043D\u0435\u0442 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430?"," ",e.jsx(W,{component:y,to:"/register",sx:{color:"#D0BCFF",fontWeight:500,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C\u0441\u044F"})]})})]})]})})]})};export{K as default};

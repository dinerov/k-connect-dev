import{r as ie,a as ne,b as os,g as ls,j as e,h as cs,s as I,T as i,i as o,l as j,v as ds,t as ae,a0 as Q,A as V,I as Te,w as Fe,o as D,G as m,p as oe,E as ye,H as ve,m as Y,J as He,P as Oe,d as f,O as xs,a7 as ms,k as us,U as ps,af as hs,C as bs,q as js,D as Ue,Q as gs}from"./vendor-mui.08p3AH88.js";import{r as c}from"./vendor-router.BRqU_Zs2.js";import{r as le,A as fs,G as Ee,h as ys,d as _e}from"./index.CdVNWeFt.js";import{a as k,h as vs}from"./vendor.CL98q8z6.js";import{T as H}from"./Tag.-0_LtIDs.js";import{g as ce}from"./vendor-react.DF-_cTkv.js";import{P as M}from"./Person.B_G_dVGx.js";import{H as Le}from"./History.BL_2VNvs.js";import{A as Ne}from"./Add.BKfOzMjp.js";import{C as _s}from"./Clear.ONWxSfjH.js";import{C as ws}from"./Close.BG2YHWMj.js";import{r as Ss}from"./ru.CTk8yEGX.js";var Ge,q={};function Is(){if(Ge)return q;Ge=1;var r=ie();Object.defineProperty(q,"__esModule",{value:!0}),q.default=void 0;var u=r(le()),p=ne();return q.default=(0,u.default)((0,p.jsx)("path",{d:"m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42M5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7"}),"LocalOffer"),q}const we=ce(Is());var Qe,J={};function ks(){if(Qe)return J;Qe=1;var r=ie();Object.defineProperty(J,"__esModule",{value:!0}),J.default=void 0;var u=r(le()),p=ne();return J.default=(0,u.default)([(0,p.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,p.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"Schedule"),J}const C=ce(ks());var Ve,K={};function Cs(){if(Ve)return K;Ve=1;var r=ie();Object.defineProperty(K,"__esModule",{value:!0}),K.default=void 0;var u=r(le()),p=ne();return K.default=(0,u.default)((0,p.jsx)("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward"),K}const Ws=ce(Cs());var Ye,X={};function zs(){if(Ye)return X;Ye=1;var r=ie();Object.defineProperty(X,"__esModule",{value:!0}),X.default=void 0;var u=r(le()),p=ne();return X.default=(0,u.default)((0,p.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined"),X}const Rs=ce(zs()),$s=I(o)(({theme:r})=>({display:"flex",flexDirection:"column",alignItems:"center",marginBottom:r.spacing(4),textAlign:"center"})),de=I(bs)(({theme:r})=>({borderRadius:16,marginBottom:r.spacing(2),overflow:"hidden",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out",background:r.palette.mode==="dark"?f(r.palette.background.paper,.8):f(r.palette.background.paper,.9),backdropFilter:"blur(10px)",border:r.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.1)":"1px solid rgba(208, 188, 255, 0.3)","&:hover":{transform:"translateY(-5px)",boxShadow:"0 12px 40px -12px rgba(0,0,0,0.3)"}})),Ds=I(Y)(({theme:r})=>({marginBottom:r.spacing(3),"& .MuiOutlinedInput-root":{borderRadius:30,backgroundColor:r.palette.mode==="dark"?f(r.palette.background.paper,.6):f(r.palette.background.paper,.7),backdropFilter:"blur(10px)",transition:"all 0.3s","&:hover":{boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},"&.Mui-focused":{boxShadow:"0 4px 20px rgba(0,0,0,0.12)"}}})),xe=I(o)(({theme:r})=>({textAlign:"center",padding:r.spacing(6,2),background:r.palette.mode==="dark"?f(r.palette.background.paper,.4):f(r.palette.background.paper,.7),backdropFilter:"blur(10px)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.03)",border:r.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.08)":"1px solid rgba(208, 188, 255, 0.2)"})),O=I(js)(({theme:r,status:u})=>{let p=r.palette.primary.main;return u==="active"?p=r.palette.success.main:u==="cancelled"?p=r.palette.error.main:u==="completed"&&(p=r.palette.primary.main),{borderRadius:12,fontWeight:600,fontSize:"0.75rem",backgroundColor:f(p,.15),color:p,border:`1px solid ${f(p,.3)}`,"& .MuiChip-label":{padding:"0 8px"}}}),me=({children:r,value:u,index:p,...ue})=>e.jsx("div",{role:"tabpanel",hidden:u!==p,id:`tabpanel-${p}`,"aria-labelledby":`tab-${p}`,...ue,children:u===p&&e.jsx(o,{sx:{pt:3},children:r})}),qe=I(Ue)(({theme:r})=>({"& .MuiDialog-paper":{borderRadius:16,background:r.palette.mode==="dark"?"rgba(18, 18, 18, 0.8)":"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(10px)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",border:r.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.1)":"1px solid rgba(208, 188, 255, 0.3)"}})),Ms=I(Ue)(({theme:r})=>({"& .MuiDialog-paper":{borderRadius:r.shape.borderRadius,[r.breakpoints.down("sm")]:{margin:0,width:"100%",maxHeight:"100%",height:"100%",maxWidth:"100%",borderRadius:0},background:(r.palette.mode,f(r.palette.background.paper,.95)),backdropFilter:"blur(8px)"}})),Ps=I(gs)(({theme:r,isWinning:u})=>({borderRadius:r.shape.borderRadius,marginBottom:r.spacing(1),background:u?f(r.palette.success.main,.1):f(r.palette.background.paper,.5),border:u?`1px solid ${f(r.palette.success.main,.3)}`:`1px solid ${f(r.palette.divider,.1)}`})),Bs=()=>{const{user:r}=c.useContext(fs),u=os(),p=ls(u.breakpoints.down("sm")),[ue,Se]=c.useState(!0),[Z,Ie]=c.useState([]),[ke,U]=c.useState([]),[Ce,pe]=c.useState([]),[We,ze]=c.useState([]),[Re,Je]=c.useState([]),[$e,Ke]=c.useState([]),[P,he]=c.useState(0),[Xe,E]=c.useState(!1),[Ze,W]=c.useState(!1),[x,ee]=c.useState(null),[es,be]=c.useState(!1),[n,je]=c.useState(null),[ss,De]=c.useState(!1),[h,v]=c.useState({bid:!1,buy:null,accept:null,cancel:null,create:!1}),[g,se]=c.useState({username:"",min_price:"",duration_hours:24}),[S,Me]=c.useState(""),[w,b]=c.useState({open:!1,message:"",severity:"info"}),[B,te]=c.useState({}),[z,Pe]=c.useState(""),[Be,ts]=c.useState(null),[A,rs]=c.useState(!0),[ge,is]=c.useState(!1),ns=c.useRef(Date.now()),T=c.useRef(null),_=c.useRef(null),F=c.useRef(null);c.useEffect(()=>(typeof BroadcastChannel<"u"&&(T.current=new BroadcastChannel("username_auction_channel"),T.current.onmessage=s=>{const{type:t,data:a,timestamp:d}=s.data;if(!_.current||d>_.current)if(_.current=d,t==="auctions"){const l=(a.auctions||[]).filter(fe=>fe.status!=="completed"),y=(a.auctions||[]).filter(fe=>fe.status==="completed");Ie(l),U(l),pe(y)}else t==="user_auctions"?ze(a.active_auctions||[]):t==="transaction_complete"&&(a.type!=="buy_now"&&a.type!=="accept_bid"&&a.type!=="place_bid"||(R(!0),$(!0),n&&n.id===a.auctionId&&N(n),a.source!=="current_tab"&&b({open:!0,message:"\u0414\u0430\u043D\u043D\u044B\u0435 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u043E\u0432 \u0431\u044B\u043B\u0438 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u044B",severity:"info"})))}),()=>{T.current&&T.current.close()}),[]),c.useEffect(()=>{const s=setInterval(()=>{Date.now()-ns.current>=36e5&&!ge&&(is(!0),rs(!1),b({open:!0,message:"\u0421\u0435\u0441\u0441\u0438\u044F \u0443\u0441\u0442\u0430\u0440\u0435\u043B\u0430. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443 \u0434\u043B\u044F \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0430\u043A\u0442\u0443\u0430\u043B\u044C\u043D\u044B\u0445 \u0434\u0430\u043D\u043D\u044B\u0445.",severity:"warning"}),F.current&&(clearInterval(F.current),F.current=null))},6e4);return()=>clearInterval(s)},[ge]),c.useEffect(()=>{if(r&&A)return R(),$(),as(),F.current=setInterval(()=>{if(A&&document.visibilityState==="visible"){const s=Date.now();(!_.current||s-_.current>15e3)&&(R(!0),$(!0))}},3e4),()=>{F.current&&clearInterval(F.current)}},[r,A]),c.useEffect(()=>{Be&&clearTimeout(Be);const s=setTimeout(()=>{if(z.trim()==="")U(Z);else{const t=z.toLowerCase(),a=Z.filter(d=>d.username.toLowerCase().includes(t)||d.seller&&d.seller.username.toLowerCase().includes(t));U(a)}},1500);return ts(s),()=>{s&&clearTimeout(s)}},[z,Z]);const L=(s,t)=>{if(T.current)try{const a={type:s,data:{...t,source:"current_tab"},timestamp:Date.now()};T.current.postMessage(a)}catch{}},R=async(s=!1)=>{if(A)try{s||Se(!0);const t=await k.get("/api/username/auctions");_.current=Date.now();const a=t.data.auctions||[],d=a.filter(y=>y.status!=="completed"),l=a.filter(y=>y.status==="completed");Ie(d),U(d),pe(l),L("auctions",t.data)}catch{s||b({open:!0,message:"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u044B",severity:"error"})}finally{s||Se(!1)}},$=async(s=!1)=>{if(A)try{const t=await k.get("/api/username/my-auctions");_.current=Date.now(),ze(t.data.active_auctions||[]),Je(t.data.my_bids||[]);const a=[...t.data.completed_auctions||[],...t.data.completed_bids||[]];pe(d=>{const l=new Map(d.map(y=>[y.id,y]));return a.forEach(y=>{l.has(y.id)||l.set(y.id,y)}),Array.from(l.values())}),L("user_auctions",t.data)}catch{s||b({open:!0,message:"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044E \u043E \u0432\u0430\u0448\u0438\u0445 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430\u0445",severity:"error"})}},as=async(s=!1)=>{if(A)try{const t=await k.get("/api/username/purchased");_.current=Date.now(),Ke(t.data.usernames||[]),L("usernames",t.data)}catch{s||b({open:!0,message:"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0432\u0430\u0448\u0438 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C\u044B",severity:"error"})}},re=s=>{const t=new Date(s)-new Date;if(t<=0)return"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D";const a=Math.floor(t/864e5),d=Math.floor(t%864e5/36e5),l=Math.floor(t%36e5/6e4);return a>0?`${a} \u0434 ${d} \u0447`:d>0?`${d} \u0447 ${l} \u043C\u0438\u043D`:`${l} \u043C\u0438\u043D`},N=async s=>{je({...s,bids:[]}),be(!0),De(!0);try{const t=await k.get(`/api/username/auctions/${s.id}`);t.data.success&&je(t.data.auction)}catch{b({open:!0,message:"\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0434\u0435\u0442\u0430\u043B\u0438 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430",severity:"error"})}finally{De(!1)}},Ae=()=>{be(!1),setTimeout(()=>je(null),300)},G=s=>{try{const t=new Date(s);return vs(t,"dd MMM yyyy, HH:mm",{locale:Ss})}catch{return s}};return e.jsxs(cs,{maxWidth:"md",sx:{py:4,mb:10},children:[e.jsxs($s,{children:[e.jsx(i,{variant:"h4",component:"h1",gutterBottom:!0,fontWeight:"bold",children:"\u0410\u0443\u043A\u0446\u0438\u043E\u043D \u042E\u0437\u0435\u0440\u043D\u0435\u0439\u043C\u043E\u0432"}),e.jsx(i,{variant:"body1",color:"textSecondary",sx:{mb:2,maxWidth:600},children:"\u0423\u0447\u0430\u0441\u0442\u0432\u0443\u0439\u0442\u0435 \u0432 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430\u0445 \u043D\u0430 \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u044B\u0435 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C\u044B \u0438\u043B\u0438 \u0432\u044B\u0441\u0442\u0430\u0432\u043B\u044F\u0439\u0442\u0435 \u0441\u0432\u043E\u0438 \u0441\u043E\u0431\u0441\u0442\u0432\u0435\u043D\u043D\u044B\u0435"})]}),e.jsx(o,{sx:{mb:3,display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:2},children:e.jsx(j,{variant:"contained",color:"primary",startIcon:e.jsx(Ne,{}),onClick:()=>E(!0),sx:{borderRadius:2,px:2},children:"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C \u043D\u0430 \u0430\u0443\u043A\u0446\u0438\u043E\u043D"})}),e.jsx(o,{sx:{mb:2},children:e.jsxs(ds,{value:P,onChange:(s,t)=>{he(t)},variant:"fullWidth",sx:{"& .MuiTab-root":{textTransform:"none",fontWeight:600,fontSize:"1rem"}},children:[e.jsx(ae,{icon:e.jsx(Ee,{}),iconPosition:"start",label:"\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0435 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u044B"}),e.jsx(ae,{icon:e.jsx(M,{}),iconPosition:"start",label:"\u041C\u043E\u0438 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u044B"}),e.jsx(ae,{icon:e.jsx(Le,{}),iconPosition:"start",label:"\u041C\u043E\u0438 \u0441\u0442\u0430\u0432\u043A\u0438"}),e.jsx(ae,{icon:e.jsx(Le,{}),iconPosition:"start",label:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044B\u0435"})]})}),e.jsxs(me,{value:P,index:0,children:[P===0&&e.jsx(Q,{in:!0,timeout:500,children:e.jsxs(o,{children:[e.jsxs(V,{severity:"info",sx:{mb:3,borderRadius:2,"& .MuiAlert-message":{width:"100%"}},children:[e.jsx(i,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043C\u044B \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u043E\u0432"}),e.jsx(i,{variant:"body2",children:"\u0422\u0435\u043F\u0435\u0440\u044C \u043F\u0440\u0438 \u0440\u0430\u0437\u043C\u0435\u0449\u0435\u043D\u0438\u0438 \u0441\u0442\u0430\u0432\u043A\u0438 \u0431\u0430\u043B\u043B\u044B \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u0443\u044E\u0442\u0441\u044F, \u0430 \u043F\u0440\u0438 \u043F\u0435\u0440\u0435\u0431\u0438\u0442\u0438\u0438 \u0432\u043E\u0437\u0432\u0440\u0430\u0449\u0430\u044E\u0442\u0441\u044F \u0430\u0432\u0442\u043E\u043C\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u0438. \u0422\u0430\u043A\u0436\u0435 \u043F\u043E\u044F\u0432\u0438\u043B\u0430\u0441\u044C \u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E\u0441\u0442\u044C \u0434\u043E\u0441\u0440\u043E\u0447\u043D\u043E\u0433\u043E \u043F\u0440\u0438\u043D\u044F\u0442\u0438\u044F \u0441\u0442\u0430\u0432\u043A\u0438 \u043F\u0440\u043E\u0434\u0430\u0432\u0446\u043E\u043C!"})]}),e.jsx(Ds,{fullWidth:!0,variant:"outlined",placeholder:"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C\u0443 \u0438\u043B\u0438 \u043F\u0440\u043E\u0434\u0430\u0432\u0446\u0443...",value:z,onChange:s=>{Pe(s.target.value)},InputProps:{startAdornment:e.jsx(Te,{position:"start",children:e.jsx(ys,{color:"action"})}),endAdornment:z&&e.jsx(Te,{position:"end",children:e.jsx(Fe,{size:"small",onClick:()=>{Pe(""),U(Z)},children:e.jsx(_s,{fontSize:"small"})})})}})]})}),ue?e.jsx(o,{display:"flex",justifyContent:"center",my:4,children:e.jsx(D,{})}):ke.length===0?e.jsxs(xe,{children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:z?"\u041F\u043E \u0432\u0430\u0448\u0435\u043C\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0443 \u043D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E":"\u0412 \u0434\u0430\u043D\u043D\u044B\u0439 \u043C\u043E\u043C\u0435\u043D\u0442 \u043D\u0435\u0442 \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0445 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u043E\u0432"}),e.jsx(i,{variant:"body2",color:"textSecondary",children:z?"\u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u043F\u043E\u0438\u0441\u043A\u0430":"\u0411\u0443\u0434\u044C\u0442\u0435 \u043F\u0435\u0440\u0432\u044B\u043C, \u043A\u0442\u043E \u0432\u044B\u0441\u0442\u0430\u0432\u0438\u0442 \u0441\u0432\u043E\u0439 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C \u043D\u0430 \u0430\u0443\u043A\u0446\u0438\u043E\u043D!"})]}):e.jsx(m,{container:!0,spacing:2,children:ke.map(s=>e.jsx(m,{item:!0,xs:12,children:e.jsx(Q,{in:!0,timeout:300,children:e.jsx(de,{elevation:2,onClick:()=>N(s),sx:{cursor:"pointer"},children:e.jsx(oe,{sx:{p:3},children:e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,sm:8,children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(H,{sx:{mr:1,color:"primary.main"}}),e.jsxs(i,{variant:"h5",component:"h2",fontWeight:"bold",children:["@",s.username]}),e.jsx(O,{label:s.status||"active",status:s.status||"active",size:"small",sx:{ml:2}})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(M,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u041F\u0440\u043E\u0434\u0430\u0432\u0435\u0446: ",s.seller?s.seller.username:"Unknown"]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(C,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C: ",s.remaining_time_formatted||re(s.end_time)]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(we,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u0421\u0442\u0430\u0432\u043E\u043A: ",s.bids_count||(s.bids?s.bids.length:0)]})]})]}),e.jsxs(m,{item:!0,xs:12,sm:4,sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},children:[e.jsxs(i,{variant:"h6",color:"primary",fontWeight:"bold",sx:{mb:1},children:[s.current_price||s.highest_bid||s.min_price," \u0431\u0430\u043B\u043B\u043E\u0432"]}),s.status==="completed"?e.jsx(j,{variant:"outlined",disabled:!0,fullWidth:!0,sx:{borderRadius:2},children:"\u0410\u0443\u043A\u0446\u0438\u043E\u043D \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D"}):e.jsx(j,{variant:"contained",color:"primary",fullWidth:!0,onClick:t=>{t.stopPropagation(),ee(s),W(!0)},disabled:s.seller_id===r?.id||s.seller?.id===r?.id||h.buy===s.id,sx:{borderRadius:2},startIcon:h.buy===s.id?e.jsx(D,{size:20}):null,children:h.buy===s.id?"\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430...":"\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u0441\u0442\u0430\u0432\u043A\u0443"})]})]})})})})},s.id))})]}),e.jsx(me,{value:P,index:1,children:We.length===0?e.jsxs(xe,{children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"\u0423 \u0432\u0430\u0441 \u043D\u0435\u0442 \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0445 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u043E\u0432"}),e.jsx(i,{variant:"body2",color:"textSecondary",sx:{mb:3},children:"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u0435 \u0441\u0432\u043E\u0439 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C \u043D\u0430 \u0430\u0443\u043A\u0446\u0438\u043E\u043D \u0438 \u0437\u0430\u0440\u0430\u0431\u043E\u0442\u0430\u0439\u0442\u0435 \u0431\u0430\u043B\u043B\u044B!"}),e.jsx(j,{variant:"contained",color:"primary",startIcon:e.jsx(Ne,{}),onClick:()=>E(!0),sx:{borderRadius:2,px:2},children:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0430\u0443\u043A\u0446\u0438\u043E\u043D"})]}):e.jsx(m,{container:!0,spacing:2,children:We.map(s=>e.jsx(m,{item:!0,xs:12,children:e.jsx(Q,{in:!0,timeout:300,children:e.jsx(de,{elevation:2,onClick:()=>N(s),sx:{cursor:"pointer"},children:e.jsx(oe,{sx:{p:3},children:e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,sm:8,children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(H,{sx:{mr:1,color:"primary.main"}}),e.jsxs(i,{variant:"h5",component:"h2",fontWeight:"bold",children:["@",s.username]}),e.jsx(O,{label:s.status||"active",status:s.status||"active",size:"small",sx:{ml:2}})]}),(s.status==="active"||!s.status)&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(C,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C: ",s.remaining_time_formatted||re(s.end_time)]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(we,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u0421\u0442\u0430\u0432\u043E\u043A: ",s.bids_count||(s.bids?s.bids.length:0)]})]}),s.status==="completed"&&s.winner_id&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(M,{sx:{mr:1,fontSize:"0.875rem",color:"success.main"}}),e.jsxs(i,{variant:"body2",color:"success.main",fontWeight:"medium",children:["\u041F\u043E\u0431\u0435\u0434\u0438\u0442\u0435\u043B\u044C: ",s.winner?s.winner.username:"Unknown"]})]})]}),e.jsxs(m,{item:!0,xs:12,sm:4,sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},children:[e.jsx(i,{variant:"h6",color:"primary",fontWeight:"bold",sx:{mb:1},children:s.status==="completed"&&s.final_price?`${s.final_price} \u0431\u0430\u043B\u043B\u043E\u0432`:`${s.current_price||s.highest_bid||s.min_price} \u0431\u0430\u043B\u043B\u043E\u0432`}),(s.status==="active"||!s.status)&&e.jsxs(e.Fragment,{children:[s.bids_count>0&&e.jsx(j,{variant:"contained",color:"success",sx:{borderRadius:2,mb:1},onClick:t=>{t.stopPropagation(),(async a=>{if(!a||!a.id)return;if(v(l=>({...l,accept:a.id})),!a.id)return b({open:!0,message:"\u041D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D \u0430\u0443\u043A\u0446\u0438\u043E\u043D, \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443",severity:"warning"}),void v(l=>({...l,accept:null}));const d=`accept-bid-${a.id}-${Date.now()}`;if(localStorage.getItem(d))v(l=>({...l,accept:null}));else{localStorage.setItem(d,"pending");try{const l=await k.post(`/api/username/auctions/${a.id}/accept-bid`,{transaction_id:d});l.data.success&&(localStorage.removeItem(d),_.current=Date.now(),L("transaction_complete",{type:"accept_bid",auctionId:a.id,result:l.data}),b({open:!0,message:l.data.message||"\u0421\u0442\u0430\u0432\u043A\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043F\u0440\u0438\u043D\u044F\u0442\u0430!",severity:"success"}),R(),$())}catch(l){localStorage.removeItem(d),b({open:!0,message:l.response?.data?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043F\u0440\u0438\u043D\u044F\u0442\u0438\u0438 \u0441\u0442\u0430\u0432\u043A\u0438",severity:"error"})}finally{v(l=>({...l,accept:null}))}}})(s)},disabled:h.accept===s.id,startIcon:h.accept===s.id?e.jsx(D,{size:20,color:"inherit"}):null,children:h.accept===s.id?"\u041F\u0440\u0438\u043D\u044F\u0442\u0438\u0435...":"\u041F\u0440\u0438\u043D\u044F\u0442\u044C \u0441\u0442\u0430\u0432\u043A\u0443"}),e.jsx(j,{variant:"outlined",color:"error",sx:{borderRadius:2},onClick:t=>{t.stopPropagation(),(async a=>{v(d=>({...d,cancel:a}));try{(await k.post(`/api/username/auctions/${a}/cancel`)).data.success&&(b({open:!0,message:"\u0410\u0443\u043A\u0446\u0438\u043E\u043D \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0442\u043C\u0435\u043D\u0435\u043D",severity:"success"}),R(),$())}catch(d){b({open:!0,message:d.response?.data?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0442\u043C\u0435\u043D\u0435 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430",severity:"error"})}finally{v(d=>({...d,cancel:null}))}})(s.id)},disabled:h.cancel===s.id,startIcon:h.cancel===s.id?e.jsx(D,{size:20,color:"error"}):null,children:h.cancel===s.id?"\u041E\u0442\u043C\u0435\u043D\u0430...":"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C"})]})]})]})})})})},s.id))})}),e.jsx(me,{value:P,index:2,children:Re.length===0?e.jsxs(xe,{children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"\u0423 \u0432\u0430\u0441 \u043D\u0435\u0442 \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0445 \u0441\u0442\u0430\u0432\u043E\u043A"}),e.jsx(i,{variant:"body2",color:"textSecondary",sx:{mb:3},children:"\u041F\u043E\u0443\u0447\u0430\u0441\u0442\u0432\u0443\u0439\u0442\u0435 \u0432 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430\u0445, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u044B\u0439 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C!"}),e.jsx(j,{variant:"contained",color:"primary",onClick:()=>he(0),sx:{borderRadius:2,px:2},children:"\u0421\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u044B"})]}):e.jsx(m,{container:!0,spacing:2,children:Re.map(s=>e.jsx(m,{item:!0,xs:12,children:e.jsx(Q,{in:!0,timeout:300,children:e.jsx(de,{elevation:2,onClick:()=>{const t={id:s.id,username:s.username,min_price:0,highest_bid:s.highest_bid,status:s.status};N(t)},sx:{cursor:"pointer"},children:e.jsx(oe,{sx:{p:3},children:e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,sm:8,children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(H,{sx:{mr:1,color:"primary.main"}}),e.jsxs(i,{variant:"h5",component:"h2",fontWeight:"bold",children:["@",s.username]}),e.jsx(O,{label:s.status||"active",status:s.status||"active",size:"small",sx:{ml:2}})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(_e,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u0412\u0430\u0448\u0430 \u0441\u0442\u0430\u0432\u043A\u0430: ",e.jsxs("b",{children:[s.my_bid," \u0431\u0430\u043B\u043B\u043E\u0432"]})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(C,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C: ",s.remaining_time_formatted||re(s.end_time)]})]}),s.am_winning&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(Ee,{sx:{mr:1,fontSize:"0.875rem",color:"success.main"}}),e.jsx(i,{variant:"body2",color:"success.main",fontWeight:"bold",children:"\u0412\u044B \u043B\u0438\u0434\u0438\u0440\u0443\u0435\u0442\u0435!"})]})]}),e.jsxs(m,{item:!0,xs:12,sm:4,sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},children:[e.jsxs(i,{variant:"h6",color:"primary",fontWeight:"bold",sx:{mb:1},children:["\u0422\u0435\u043A\u0443\u0449\u0430\u044F: ",s.highest_bid," \u0431\u0430\u043B\u043B\u043E\u0432"]}),s.status==="completed"?e.jsx(j,{variant:"outlined",disabled:!0,fullWidth:!0,sx:{borderRadius:2},children:"\u0410\u0443\u043A\u0446\u0438\u043E\u043D \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D"}):e.jsx(j,{variant:"contained",color:"primary",fullWidth:!0,onClick:t=>{t.stopPropagation();const a={id:s.id,username:s.username,min_price:0,highest_bid:s.highest_bid,status:s.status};ee(a),W(!0)},disabled:h.bid,sx:{borderRadius:2},children:"\u041F\u043E\u0432\u044B\u0441\u0438\u0442\u044C \u0441\u0442\u0430\u0432\u043A\u0443"})]})]})})})})},s.id))})}),e.jsx(me,{value:P,index:3,children:Ce.length===0?e.jsxs(xe,{children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"\u041D\u0435\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044B\u0445 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u043E\u0432"}),e.jsx(i,{variant:"body2",color:"textSecondary",sx:{mb:3},children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044B\u0435 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u044B \u0431\u0443\u0434\u0443\u0442 \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C\u0441\u044F \u0437\u0434\u0435\u0441\u044C."}),e.jsx(j,{variant:"contained",color:"primary",onClick:()=>he(0),sx:{borderRadius:2,px:2},children:"\u041A \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u043C \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430\u043C"})]}):e.jsx(m,{container:!0,spacing:2,children:Ce.map(s=>e.jsx(m,{item:!0,xs:12,children:e.jsx(Q,{in:!0,timeout:300,children:e.jsx(de,{elevation:2,onClick:()=>N(s),sx:{cursor:"pointer"},children:e.jsx(oe,{sx:{p:3},children:e.jsxs(m,{container:!0,spacing:2,children:[e.jsxs(m,{item:!0,xs:12,sm:8,children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(H,{sx:{mr:1,color:"primary.main"}}),e.jsxs(i,{variant:"h5",component:"h2",fontWeight:"bold",children:["@",s.username]}),e.jsx(O,{label:"completed",status:"completed",size:"small",sx:{ml:2}})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(M,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u041F\u0440\u043E\u0434\u0430\u0432\u0435\u0446: ",s.seller?s.seller.username:"Unknown"]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(C,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D: ",G(s.completed_at||s.end_time)]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(we,{sx:{mr:1,fontSize:"0.875rem",color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["\u0421\u0442\u0430\u0432\u043E\u043A: ",s.bids_count||(s.bids?s.bids.length:0)]})]}),s.winner_id&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(M,{sx:{mr:1,fontSize:"0.875rem",color:"success.main"}}),e.jsxs(i,{variant:"body2",color:"success.main",fontWeight:"medium",children:["\u041F\u043E\u0431\u0435\u0434\u0438\u0442\u0435\u043B\u044C: ",s.winner?s.winner.username:"Unknown"]})]})]}),e.jsx(m,{item:!0,xs:12,sm:4,sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"center"},children:e.jsxs(i,{variant:"h6",color:"primary",fontWeight:"bold",children:[s.final_price||s.current_price||s.highest_bid||s.min_price," \u0431\u0430\u043B\u043B\u043E\u0432"]})})]})})})})},s.id))})}),e.jsxs(qe,{open:Xe,onClose:()=>E(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ye,{children:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043D\u043E\u0432\u044B\u0439 \u0430\u0443\u043A\u0446\u0438\u043E\u043D"}),e.jsx(ve,{sx:{pb:4},children:e.jsxs(o,{sx:{mb:3,mt:2},children:[e.jsx(i,{variant:"body1",gutterBottom:!0,children:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C \u0434\u043B\u044F \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430:"}),e.jsxs(Y,{select:!0,fullWidth:!0,label:"\u042E\u0437\u0435\u0440\u043D\u0435\u0439\u043C",value:g.username,onChange:s=>se({...g,username:s.target.value}),error:!!B.username,helperText:B.username,margin:"normal",variant:"outlined",SelectProps:{native:!0},children:[e.jsx("option",{value:"",children:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C"}),$e.filter(s=>!s.is_active).map(s=>e.jsxs("option",{value:s.username,children:["@",s.username]},s.id))]}),$e.filter(s=>!s.is_active).length===0&&e.jsx(V,{severity:"info",sx:{mt:2},children:"\u0423 \u0432\u0430\u0441 \u043D\u0435\u0442 \u043D\u0435\u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0445 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C\u043E\u0432 \u0434\u043B\u044F \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430. \u0412\u044B \u043D\u0435 \u043C\u043E\u0436\u0435\u0442\u0435 \u0432\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0439 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C."}),e.jsx(Y,{fullWidth:!0,label:"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (\u0431\u0430\u043B\u043B\u044B)",type:"number",value:g.min_price,onChange:s=>se({...g,min_price:s.target.value}),error:!!B.min_price,helperText:B.min_price||"\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u043D\u0430\u0447\u0430\u043B\u044C\u043D\u0430\u044F \u0446\u0435\u043D\u0430: 15 000 000 \u0431\u0430\u043B\u043B\u043E\u0432",margin:"normal",variant:"outlined",InputProps:{inputProps:{min:1,max:15e3}}}),e.jsxs(Y,{select:!0,fullWidth:!0,label:"\u0414\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430",value:g.duration_hours,onChange:s=>se({...g,duration_hours:parseFloat(s.target.value)}),margin:"normal",variant:"outlined",SelectProps:{native:!0},children:[e.jsx("option",{value:.5,children:"30 \u043C\u0438\u043D\u0443\u0442"}),e.jsx("option",{value:24,children:"24 \u0447\u0430\u0441\u0430"}),e.jsx("option",{value:48,children:"2 \u0434\u043D\u044F"}),e.jsx("option",{value:72,children:"3 \u0434\u043D\u044F"}),e.jsx("option",{value:168,children:"1 \u043D\u0435\u0434\u0435\u043B\u044F"})]})]})}),e.jsxs(He,{sx:{px:3,pb:3},children:[e.jsx(j,{onClick:()=>E(!1),disabled:h.create,children:"\u041E\u0442\u043C\u0435\u043D\u0430"}),e.jsx(j,{variant:"contained",onClick:async()=>{const s={};if(g.username||(s.username="\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u044E\u0437\u0435\u0440\u043D\u0435\u0439\u043C"),g.min_price?isNaN(g.min_price)||parseInt(g.min_price)<=0?s.min_price="\u0426\u0435\u043D\u0430 \u0434\u043E\u043B\u0436\u043D\u0430 \u0431\u044B\u0442\u044C \u043F\u043E\u043B\u043E\u0436\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u043C \u0447\u0438\u0441\u043B\u043E\u043C":parseInt(g.min_price)>15e6&&(s.min_price="\u041C\u0430\u043A\u0441\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u043D\u0430\u0447\u0430\u043B\u044C\u043D\u0430\u044F \u0446\u0435\u043D\u0430: 15 000 000 \u0431\u0430\u043B\u043B\u043E\u0432"):s.min_price="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u0443\u044E \u0446\u0435\u043D\u0443",Object.keys(s).length>0)te(s);else{te({}),v(t=>({...t,create:!0}));try{(await k.post("/api/username/create-auction",{username:g.username,min_price:parseInt(g.min_price),duration_hours:parseFloat(g.duration_hours)})).data.success&&(b({open:!0,message:"\u0410\u0443\u043A\u0446\u0438\u043E\u043D \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u043D!",severity:"success"}),R(),$(),E(!1),se({username:"",min_price:"",duration_hours:24}))}catch(t){b({open:!0,message:t.response?.data?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430",severity:"error"})}finally{v(t=>({...t,create:!1}))}}},disabled:!g.username||!g.min_price||h.create,startIcon:h.create?e.jsx(D,{size:20}):null,children:h.create?"\u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435...":"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0430\u0443\u043A\u0446\u0438\u043E\u043D"})]})]}),e.jsxs(qe,{open:Ze,onClose:()=>!h.bid&&W(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ye,{children:"\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u0441\u0442\u0430\u0432\u043A\u0443"}),e.jsx(ve,{sx:{pb:4},children:x&&e.jsxs(o,{sx:{mb:3,mt:2},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(H,{sx:{mr:1,color:"primary.main"}}),e.jsxs(i,{variant:"h6",component:"h2",children:["@",x.username]}),x.status&&e.jsx(O,{label:x.status,status:x.status,size:"small",sx:{ml:2}})]}),e.jsxs(i,{variant:"body2",gutterBottom:!0,sx:{mb:2},children:["\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u0441\u0442\u0430\u0432\u043A\u0430: ",e.jsxs("b",{children:[x.current_price||x.highest_bid||x.min_price," \u0431\u0430\u043B\u043B\u043E\u0432"]})]}),x.status==="completed"?e.jsx(V,{severity:"info",sx:{mb:2},children:"\u042D\u0442\u043E\u0442 \u0430\u0443\u043A\u0446\u0438\u043E\u043D \u0443\u0436\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D, \u0441\u0442\u0430\u0432\u043A\u0438 \u0431\u043E\u043B\u044C\u0448\u0435 \u043D\u0435 \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E\u0442\u0441\u044F."}):e.jsx(Y,{fullWidth:!0,label:"\u0412\u0430\u0448\u0430 \u0441\u0442\u0430\u0432\u043A\u0430 (\u0431\u0430\u043B\u043B\u044B)",type:"number",value:S,onChange:s=>Me(s.target.value),error:!!B.bidAmount,helperText:B.bidAmount||`\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u0441\u0442\u0430\u0432\u043A\u0430: ${parseInt(x.current_price||x.highest_bid||x.min_price)+1} \u0431\u0430\u043B\u043B\u043E\u0432`,margin:"normal",variant:"outlined",disabled:h.bid||x.status==="completed",InputProps:{inputProps:{min:parseInt(x.current_price||x.highest_bid||x.min_price)+1}}})]})}),e.jsxs(He,{sx:{px:3,pb:3},children:[e.jsx(j,{onClick:()=>W(!1),disabled:h.bid,children:"\u041E\u0442\u043C\u0435\u043D\u0430"}),x&&x.status!=="completed"&&e.jsx(j,{variant:"contained",onClick:async()=>{if(!S||isNaN(S)||parseInt(S)<=0)return void te({bidAmount:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u0443\u044E \u0441\u0443\u043C\u043C\u0443 \u0441\u0442\u0430\u0432\u043A\u0438"});if(v(t=>({...t,bid:!0})),!x)return b({open:!0,message:"\u041D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D \u0430\u0443\u043A\u0446\u0438\u043E\u043D, \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443",severity:"warning"}),void v(t=>({...t,bid:!1}));if(x.status==="completed")return b({open:!0,message:"\u0410\u0443\u043A\u0446\u0438\u043E\u043D \u0443\u0436\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D, \u0441\u0442\u0430\u0432\u043A\u0438 \u0431\u043E\u043B\u044C\u0448\u0435 \u043D\u0435 \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E\u0442\u0441\u044F",severity:"warning"}),v(t=>({...t,bid:!1})),void W(!1);const s=`bid-${x.id}-${Date.now()}`;if(localStorage.getItem(s))v(t=>({...t,bid:!1}));else{localStorage.setItem(s,"pending"),te({});try{const t=await k.post(`/api/username/auctions/${x.id}/bid`,{amount:parseInt(S),transaction_id:s});t.data.success&&(localStorage.removeItem(s),_.current=Date.now(),L("transaction_complete",{type:"place_bid",auctionId:x.id,result:t.data}),b({open:!0,message:"\u0421\u0442\u0430\u0432\u043A\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0440\u0430\u0437\u043C\u0435\u0449\u0435\u043D\u0430!",severity:"success"}),R(),$(),W(!1),Me(""),ee(null))}catch(t){localStorage.removeItem(s),b({open:!0,message:t.response?.data?.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0440\u0430\u0437\u043C\u0435\u0449\u0435\u043D\u0438\u0438 \u0441\u0442\u0430\u0432\u043A\u0438",severity:"error"})}finally{v(t=>({...t,bid:!1}))}}},disabled:!S||isNaN(S)||parseInt(S)<=parseInt(x?.current_price||x?.highest_bid||x?.min_price)||h.bid,startIcon:h.bid?e.jsx(D,{size:20}):null,children:h.bid?"\u041E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0430...":"\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u0441\u0442\u0430\u0432\u043A\u0443"})]})]}),e.jsx(Ms,{open:es,onClose:Ae,fullWidth:!0,maxWidth:"md",fullScreen:p,children:n&&e.jsxs(e.Fragment,{children:[e.jsxs(ye,{sx:{borderBottom:`1px solid ${u.palette.divider}`,position:"relative",pb:2},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(H,{sx:{mr:1.5,color:"primary.main",fontSize:"1.75rem"}}),e.jsxs(i,{variant:"h5",component:"h2",fontWeight:"bold",children:["@",n.username]}),e.jsx(O,{label:n.status||"active",status:n.status||"active",size:"small",sx:{ml:2}})]}),e.jsx(Fe,{"aria-label":"close",onClick:Ae,sx:{position:"absolute",right:8,top:8},disabled:h.bid,children:e.jsx(ws,{})})]}),e.jsx(ve,{sx:{p:3},children:ss?e.jsx(o,{display:"flex",justifyContent:"center",my:4,children:e.jsx(D,{})}):e.jsxs(m,{container:!0,spacing:3,children:[e.jsxs(m,{item:!0,xs:12,md:7,children:[e.jsxs(Oe,{elevation:0,sx:{p:2,mb:3,borderRadius:2,bgcolor:f(u.palette.background.paper,.7)},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u043E\u0431 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0435"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(M,{sx:{mr:1.5,color:"text.secondary",fontSize:"1.2rem"}}),e.jsxs(i,{variant:"body1",children:["\u041F\u0440\u043E\u0434\u0430\u0432\u0435\u0446: ",e.jsx("strong",{children:n.seller?n.seller.username:"Unknown"})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(_e,{sx:{mr:1.5,color:"text.secondary",fontSize:"1.2rem"}}),e.jsxs(i,{variant:"body1",children:["\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u0446\u0435\u043D\u0430: ",e.jsxs("strong",{children:[n.min_price," \u0431\u0430\u043B\u043B\u043E\u0432"]})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(_e,{sx:{mr:1.5,color:"primary.main",fontSize:"1.2rem"}}),e.jsxs(i,{variant:"body1",children:[n.status==="completed"?"\u0424\u0438\u043D\u0430\u043B\u044C\u043D\u0430\u044F \u0446\u0435\u043D\u0430:":"\u0422\u0435\u043A\u0443\u0449\u0430\u044F \u0446\u0435\u043D\u0430:"," ",e.jsxs("strong",{children:[n.status==="completed"?n.final_price||n.current_price||n.highest_bid||n.min_price:n.current_price||n.min_price," \u0431\u0430\u043B\u043B\u043E\u0432"]})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(C,{sx:{mr:1.5,color:"text.secondary",fontSize:"1.2rem"}}),e.jsxs(i,{variant:"body1",children:["\u0421\u043E\u0437\u0434\u0430\u043D: ",e.jsx("strong",{children:G(n.created_at)})]})]}),n.status==="completed"?e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(C,{sx:{mr:1.5,color:"success.main",fontSize:"1.2rem"}}),e.jsxs(i,{variant:"body1",children:["\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D: ",e.jsx("strong",{children:G(n.completed_at||n.end_time)})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(C,{sx:{mr:1.5,color:"warning.main",fontSize:"1.2rem"}}),e.jsxs(i,{variant:"body1",children:["\u0417\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u0442\u0441\u044F: ",e.jsx("strong",{children:G(n.end_time)})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(C,{sx:{mr:1.5,color:"info.main",fontSize:"1.2rem"}}),e.jsxs(i,{variant:"body1",children:["\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C: ",e.jsx("strong",{children:n.remaining_time_formatted||re(n.end_time)})]})]})]}),n.status==="completed"&&n.winner_id&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(M,{sx:{mr:1.5,color:"success.main",fontSize:"1.2rem"}}),e.jsxs(i,{variant:"body1",color:"success.main",children:["\u041F\u043E\u0431\u0435\u0434\u0438\u0442\u0435\u043B\u044C: ",e.jsx("strong",{children:n.winner?n.winner.username:"Unknown"})]})]})]})]}),n.status==="completed"?e.jsx(j,{variant:"outlined",fullWidth:!0,size:"large",disabled:!0,sx:{mt:1,borderRadius:2,py:1.25},children:"\u0410\u0443\u043A\u0446\u0438\u043E\u043D \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D"}):n.seller_id!==r?.id&&e.jsx(j,{variant:"contained",color:"primary",fullWidth:!0,size:"large",onClick:()=>{be(!1),ee(n),W(!0)},disabled:n.seller_id===r?.id||h.bid,sx:{mt:1,borderRadius:2,py:1.25},children:"\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u0441\u0442\u0430\u0432\u043A\u0443"})]}),e.jsx(m,{item:!0,xs:12,md:5,children:e.jsxs(Oe,{elevation:0,sx:{p:2,borderRadius:2,bgcolor:f(u.palette.background.paper,.7)},children:[e.jsxs(i,{variant:"h6",gutterBottom:!0,children:["\u0418\u0441\u0442\u043E\u0440\u0438\u044F \u0441\u0442\u0430\u0432\u043E\u043A ",n.bids&&n.bids.length>0?`(${n.bids.length})`:""]}),n.bids&&n.bids.length!==0?e.jsx(xs,{sx:{maxHeight:"400px",overflowY:"auto",pr:1},children:n.bids.sort((s,t)=>new Date(t.time)-new Date(s.time)).map((s,t)=>{const a=t===0,d=s.bidder.id===r?.id,l=n.status==="completed"&&n.winner_id===s.bidder.id;return e.jsxs(Ps,{isWinning:a||l,children:[e.jsx(ms,{children:e.jsxs(us,{alt:s.bidder.username,src:s.bidder.avatar_url||(s.bidder.photo?s.bidder.photo.startsWith("/")||s.bidder.photo.startsWith("http")?s.bidder.photo:`/static/uploads/avatar/${s.bidder.id}/${s.bidder.photo}`:null),sx:a||l?{bgcolor:"success.main",color:"white"}:{},onError:y=>{y.target.src="/static/uploads/avatar/system/avatar.png"},children:[(a||l)&&e.jsx(Ws,{}),!(a||l)&&s.bidder.username.charAt(0)]})}),e.jsx(ps,{primary:e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[e.jsxs(i,{variant:"body1",fontWeight:a||l?"bold":"normal",children:[s.bidder.username," ",d&&"(\u0412\u044B)"]}),e.jsxs(i,{variant:"body1",fontWeight:"bold",color:a||l?"success.main":"inherit",children:[s.amount," \u0431\u0430\u043B\u043B\u043E\u0432"]})]}),secondary:e.jsxs(i,{variant:"body2",color:"text.secondary",children:[G(s.time),n.status==="completed"&&l&&e.jsx(i,{component:"span",variant:"body2",color:"success.main",sx:{display:"block",fontWeight:"bold"},children:"\u041F\u043E\u0431\u0435\u0434\u043D\u0430\u044F \u0441\u0442\u0430\u0432\u043A\u0430"}),n.status!=="completed"&&a&&e.jsx(i,{component:"span",variant:"body2",color:"success.main",sx:{display:"block",fontWeight:"bold"},children:"\u041B\u0438\u0434\u0438\u0440\u0443\u044E\u0449\u0430\u044F \u0441\u0442\u0430\u0432\u043A\u0430"})]})})]},`${s.bidder.id}-${s.time}`)})}):e.jsxs(o,{sx:{py:4,textAlign:"center"},children:[e.jsx(Rs,{sx:{fontSize:"3rem",color:"text.secondary",mb:1,opacity:.5}}),e.jsx(i,{variant:"body1",color:"text.secondary",children:n.status==="completed"?"\u0410\u0443\u043A\u0446\u0438\u043E\u043D \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D \u0431\u0435\u0437 \u0441\u0442\u0430\u0432\u043E\u043A":"\u041F\u043E\u043A\u0430 \u043D\u0435\u0442 \u0441\u0442\u0430\u0432\u043E\u043A"}),n.status!=="completed"&&e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"\u0411\u0443\u0434\u044C\u0442\u0435 \u043F\u0435\u0440\u0432\u044B\u043C, \u043A\u0442\u043E \u0441\u0434\u0435\u043B\u0430\u0435\u0442 \u0441\u0442\u0430\u0432\u043A\u0443!"})]})]})})]})})]})}),ge&&e.jsxs(V,{severity:"warning",sx:{mb:3,borderRadius:2,"& .MuiAlert-message":{width:"100%"}},action:e.jsx(j,{color:"inherit",size:"small",onClick:()=>window.location.reload(),children:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C"}),children:[e.jsx(i,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044F \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435"}),e.jsx(i,{variant:"body2",children:"\u0414\u0430\u043D\u043D\u044B\u0435 \u043C\u043E\u0433\u0443\u0442 \u0431\u044B\u0442\u044C \u0443\u0441\u0442\u0430\u0440\u0435\u0432\u0448\u0438\u043C\u0438. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443 \u0434\u043B\u044F \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0430\u043A\u0442\u0443\u0430\u043B\u044C\u043D\u043E\u0439 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438."})]}),e.jsx(hs,{open:w.open,autoHideDuration:w.severity==="warning"?null:6e3,onClose:()=>w.severity!=="warning"&&b({...w,open:!1}),children:e.jsx(V,{onClose:()=>w.severity!=="warning"&&b({...w,open:!1}),severity:w.severity,sx:{width:"100%"},action:w.severity==="warning"&&e.jsx(j,{color:"inherit",size:"small",onClick:()=>window.location.reload(),children:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C"}),children:w.message})})]})};export{Bs as default};

import{r as Re,a as _e,j as t,h as Te,s as B,m as Ee,I as de,w as W,i as s,v as Pe,t as M,o as A,T as n,l as w,P as ce,O as pe,k as R,C as xe}from"./vendor-mui.08p3AH88.js";import{d as Oe,u as Le,r as l,L as c}from"./vendor-router.BRqU_Zs2.js";import{r as qe,T as Me,A as Ae,h as Ne,P as me,n as N}from"./index.CdVNWeFt.js";import{P as he}from"./PersonRemove.3f-UhM3t.js";import{V as ue}from"./thumbnails.CEJMDkxh.js";import{T as ge}from"./ThumbUpOutlined.Dgqwey59.js";import{C as fe,S as He}from"./SimpleImageViewer.DCWkQqHX.js";import{g as Ue}from"./vendor-react.DF-_cTkv.js";import{a as H,m as U}from"./vendor.CL98q8z6.js";var je,z={};function Ye(){if(je)return z;je=1;var o=Re();Object.defineProperty(z,"__esModule",{value:!0}),z.default=void 0;var d=o(qe()),j=_e();return z.default=(0,d.default)((0,j.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreHoriz"),z}const Ve=Ue(Ye()),Ge=B(s)(({theme:o})=>({position:"sticky",top:70,zIndex:10,padding:o.spacing(2),marginBottom:o.spacing(2),borderRadius:o.shape.borderRadius,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",backgroundColor:o.palette.background.paper})),Y=B(s)(({theme:o})=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:o.spacing(4),textAlign:"center",marginTop:o.spacing(2)})),V=o=>{const{children:d,value:j,index:v,...b}=o;return t.jsx("div",{role:"tabpanel",hidden:j!==v,id:`search-tabpanel-${v}`,"aria-labelledby":`search-tab-${v}`,...b,children:j===v&&t.jsx(s,{sx:{pt:2},children:d})})},be=B(U.div)(({theme:o,decoration:d})=>{const j=d?.background?.includes("linear-gradient"),v=d?.background?.includes("/"),b=d?.background?.startsWith("#"),k=b&&Je(d?.background);return{display:"flex",alignItems:"center",padding:o.spacing(2),borderRadius:o.spacing(2),marginBottom:o.spacing(1.5),backgroundColor:o.palette.background.paper,boxShadow:o.shadows[2],transition:"transform 0.3s ease, box-shadow 0.3s ease",position:"relative",overflow:"hidden",background:d?.background?v?`url(${d.background})`:d.background:o.palette.background.paper,backgroundSize:v?"cover":"auto",backgroundPosition:v?"center":"auto",color:k?"rgba(0, 0, 0, 0.87)":o.palette.text.primary,"& .MuiTypography-root":{color:k?"rgba(0, 0, 0, 0.87)":"inherit"},"& .MuiTypography-colorTextSecondary":{color:k?"rgba(0, 0, 0, 0.6)":o.palette.text.secondary},"&:hover":{transform:"translateY(-3px)",boxShadow:o.shadows[6]},"&::before":j?{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:d.background,opacity:.15,zIndex:0}:{}}}),ve=B("img")({position:"absolute",right:0,height:"max-content",maxHeight:120,opacity:1,pointerEvents:"none",zIndex:1}),Je=o=>{if(!o||!o.startsWith("#"))return!1;const d=o.replace("#","");return(299*parseInt(d.substr(0,2),16)+587*parseInt(d.substr(2,2),16)+114*parseInt(d.substr(4,2),16))/1e3>128},Ke=()=>{const o=Oe(),d=Le(),{themeSettings:j}=l.useContext(Me),{user:v,isAuthenticated:b}=l.useContext(Ae),k=new URLSearchParams(o.search),G=k.get("q")||"",J=k.get("type")||"all",[g,_]=l.useState(G),[m,K]=l.useState(J==="users"?1:J==="posts"?2:0),[S,T]=l.useState([]),[D,E]=l.useState([]),[y,Q]=l.useState({}),[I,X]=l.useState(!1),[ye,P]=l.useState(1),[Ce,O]=l.useState(1),[Z,ke]=l.useState(!1),[ee,$e]=l.useState(!1),[te,we]=l.useState(!0),ae=l.useRef(null),[Se,se]=l.useState(!1),[Qe,De]=l.useState(""),[Ie,Fe]=l.useState(0),[We,ze]=l.useState([]),[re,Be]=l.useState(null),L=(e,a)=>{const r=new URLSearchParams;e&&r.set("q",e),a===1?r.set("type","users"):a===2?r.set("type","posts"):r.set("type","all"),d(`/search?${r.toString()}`)},$=async(e,a,r=1,u=!1)=>{if(!I){X(!0);try{let i;const f=e.trim();if(a===1){if(i=await((p="",x=1,h=10)=>H.get("/api/search",{params:{q:p,type:"users",page:x,per_page:h}}))(f,r),i.data&&i.data.users){const p=F(i.data.users,"id");T(u?x=>{const h=[...x,...p];return F(h,"id")}:p),ke(i.data.has_next),b&&p.length>0&&oe(p)}}else if(a===2){if(i=await((p,x=1,h=10)=>H.get("/api/search",{params:{q:p,type:"posts",page:x,per_page:h}}))(f,r),i.data&&i.data.posts){const p=F(i.data.posts,"id");E(u?x=>{const h=[...x,...p];return F(h,"id")}:p),$e(i.data.has_next)}}else i=await((p,x=1,h=10)=>H.get("/api/search",{params:{q:p,type:"all",page:x,per_page:h}}))(f),!u&&i.data&&(i.data.users?T(F(i.data.users,"id")):T([]),i.data.posts?E(F(i.data.posts,"id")):E([]),b&&i.data.users&&i.data.users.length>0&&oe(i.data.users))}catch{}finally{X(!1)}}},F=(e,a)=>e.filter((r,u,i)=>u===i.findIndex(f=>f[a]===r[a])),oe=async e=>{if(b&&e&&e.length!==0)try{const a={};for(const r of e)if(r.id!==r?.id)try{const u=await N.checkFollowing(r.id);a[r.id]=u.data.following}catch{a[r.id]=!1}Q(r=>({...r,...a}))}catch{}},ie=async e=>{if(b)try{y[e]?await N.unfollowUser(e):await N.followUser(e),Q(a=>({...a,[e]:!a[e]}))}catch{}else d("/login")},q=(e,a)=>{K(a),L(g,a),P(1),O(1),$(g,a)},ne=()=>{if(m===1&&Z){const e=ye+1;P(e),$(g,m,e,!0)}else if(m===2&&ee){const e=Ce+1;O(e),$(g,m,e,!0)}};l.useEffect(()=>{const e=k.get("q")||"",a=k.get("type")||"all";_(e),K(a==="users"?1:a==="posts"?2:0),te&&!e||$(e,a==="users"?1:a==="posts"?2:0),we(!1)},[o.search]),l.useEffect(()=>{te&&!G&&$("",1)},[]);const le=(e,a,r)=>{De(e),ze(a),Fe(0),se(!0)};return l.useEffect(()=>{const e=g.trim();if(e){re&&clearTimeout(re);const a=setTimeout(()=>{e.length>=2&&(L(e,m),$(e,m))},1e3);return Be(a),()=>{a&&clearTimeout(a)}}},[g,m]),t.jsxs(Te,{maxWidth:"lg",sx:{pt:2,pb:8},children:[t.jsxs(Ge,{sx:{background:"unset"},children:[t.jsx("form",{onSubmit:e=>{e.preventDefault();const a=g.trim();a||m!==1?(L(a,m),P(1),O(1),$(a,m)):$("",m)},children:t.jsx(Ee,{fullWidth:!0,variant:"outlined",placeholder:"\u041F\u043E\u0438\u0441\u043A \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0435\u0439, \u043F\u043E\u0441\u0442\u043E\u0432...",value:g,onChange:e=>_(e.target.value),inputRef:ae,InputProps:{startAdornment:t.jsx(de,{position:"start",children:t.jsx(Ne,{color:"action"})}),endAdornment:g&&t.jsx(de,{position:"end",children:t.jsx(W,{size:"small",onClick:()=>{_(""),ae.current?.focus()},children:t.jsx(Ve,{})})}),sx:{borderRadius:6,backgroundColor:"rgba(255, 255, 255, 0.05)","& fieldset":{borderColor:"rgba(255, 255, 255, 0.1)"}}}})}),t.jsx(s,{sx:{borderBottom:1,borderColor:"divider",mt:2},children:t.jsxs(Pe,{value:m,onChange:q,variant:"fullWidth",sx:{"& .MuiTabs-indicator":{backgroundColor:"#D0BCFF",height:3}},children:[t.jsx(M,{label:"\u0412\u0441\u0435"}),t.jsx(M,{label:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438"}),t.jsx(M,{label:"\u041F\u043E\u0441\u0442\u044B"})]})})]}),!I||S.length||D.length?t.jsxs(t.Fragment,{children:[t.jsx(V,{value:m,index:0,children:S.length===0&&D.length===0?t.jsxs(Y,{children:[t.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E"}),t.jsx(n,{variant:"body2",color:"text.secondary",children:"\u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043F\u043E\u0438\u0441\u043A\u043E\u0432\u044B\u0439 \u0437\u0430\u043F\u0440\u043E\u0441"})]}):t.jsxs(t.Fragment,{children:[S.length>0&&t.jsxs(s,{sx:{mb:4},children:[t.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[t.jsx(n,{variant:"h6",children:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438"}),S.length>4&&t.jsx(w,{variant:"text",color:"primary",onClick:()=>q(0,1),children:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0441\u0435"})]}),t.jsx(ce,{sx:{borderRadius:2,background:"unset",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:t.jsx(pe,{children:S.slice(0,4).map((e,a)=>t.jsxs(be,{decoration:e.decoration,component:U.div,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*a},onClick:()=>d(`/profile/${e.username}`),children:[e.decoration?.item_path&&(()=>{const[r,...u]=e.decoration.item_path.split(";"),i=u.reduce((f,p)=>{const[x,h]=p.split(":").map(C=>C.trim());if(x==="height"){const C=parseInt(h);if(!isNaN(C))return{...f,[x]:C/2+"px"}}return{...f,[x]:h}},{});return t.jsx(ve,{src:r,style:i,alt:""})})(),t.jsxs(s,{sx:{position:"relative",zIndex:2,display:"flex",alignItems:"center",width:"100%"},children:[t.jsx(R,{src:e.photo&&e.photo!=="avatar.png"?e.photo.startsWith("/")?e.photo:`/static/uploads/avatar/${e.id}/${e.photo}`:"/static/uploads/avatar/system/avatar.png",alt:e.name,component:c,to:`/profile/${e.username}`,sx:{width:50,height:50,marginRight:2,border:"2px solid #D0BCFF"},onError:r=>{r.target.onerror=null,r.target.src="/static/uploads/avatar/system/avatar.png"}}),t.jsxs(s,{sx:{flex:1},children:[t.jsxs(s,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(n,{component:c,to:`/profile/${e.username}`,variant:"subtitle1",sx:{fontWeight:"bold",textDecoration:"none",color:"text.primary","&:hover":{textDecoration:"underline"}},children:e.name}),e.verification_status==="verified"&&t.jsx(ue,{sx:{fontSize:16,ml:.5,color:"#D0BCFF"}})]}),t.jsxs(n,{variant:"body2",color:"text.secondary",children:["@",e.username]})]}),b&&e.id!==e?.id&&t.jsx(w,{variant:"outlined",size:"small",color:"primary",onClick:r=>{r.stopPropagation(),ie(e.id)},startIcon:y[e.id]?t.jsx(he,{}):t.jsx(me,{}),sx:{borderRadius:6,textTransform:"none",borderColor:y[e.id]?"rgba(255, 255, 255, 0.2)":"#D0BCFF",color:y[e.id]?"text.secondary":"#D0BCFF",zIndex:2},children:y[e.id]?"\u041E\u0442\u043F\u0438\u0441\u0430\u0442\u044C\u0441\u044F":"\u041F\u043E\u0434\u043F\u0438\u0441\u0430\u0442\u044C\u0441\u044F"})]})]},e.id))})})]}),D.length>0&&t.jsxs(s,{children:[t.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[t.jsx(n,{variant:"h6",children:"\u041F\u043E\u0441\u0442\u044B"}),D.length>3&&t.jsx(w,{variant:"text",color:"primary",onClick:()=>q(0,2),children:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0441\u0435"})]}),t.jsx(s,{sx:{display:"flex",flexDirection:"column",gap:2},children:D.slice(0,3).map(e=>t.jsxs(xe,{sx:{display:"flex",flexDirection:"column",borderRadius:2,overflow:"hidden",textDecoration:"none",background:`linear-gradient(145deg, ${j.paperColor} 0%, rgba(26, 26, 26, 0.9) 100%)`,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",transition:"transform 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"}},children:[t.jsxs(s,{sx:{display:"flex",alignItems:"center",pt:2,px:2},children:[t.jsx(R,{src:e.user.photo&&e.user.photo!=="avatar.png"?e.user.photo.startsWith("/")?e.user.photo:`/static/uploads/avatar/${e.user.id}/${e.user.photo}`:"/static/uploads/avatar/system/avatar.png",alt:e.user.name,component:c,to:`/profile/${e.user.username}`,sx:{width:40,height:40,mr:1.5,border:"2px solid #D0BCFF"},onError:a=>{a.target.onerror=null,a.target.src="/static/uploads/avatar/system/avatar.png"}}),t.jsxs(s,{children:[t.jsx(n,{variant:"subtitle1",component:c,to:`/profile/${e.user.username}`,sx:{fontWeight:"bold",textDecoration:"none",color:"text.primary","&:hover":{textDecoration:"underline"}},children:e.user.name}),t.jsxs(n,{variant:"caption",color:"text.secondary",component:c,to:`/profile/${e.user.username}`,sx:{textDecoration:"none"},children:["@",e.user.username]})]}),t.jsx(s,{sx:{ml:"auto"},children:t.jsx(n,{variant:"caption",color:"text.secondary",children:new Date(e.timestamp).toLocaleDateString()})})]}),t.jsx(s,{sx:{px:2,pt:1.5,pb:e.image||e.video?0:1},children:t.jsx(n,{variant:"body2",component:c,to:`/post/${e.id}`,sx:{mb:1.5,display:"block",textDecoration:"none",color:"text.primary",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:3,WebkitBoxOrient:"vertical"},children:e.content})}),e.image&&t.jsx(s,{sx:{position:"relative",mt:1,cursor:"pointer"},component:c,to:`/post/${e.id}`,children:t.jsx("img",{src:e.image.startsWith("/")?e.image:`/static/uploads/post/${e.id}/${e.image}`,alt:"Post image",style:{width:"100%",height:"250px",objectFit:"cover",backgroundColor:"#111"},onClick:a=>{a.preventDefault(),le(e.image.startsWith("/")?e.image:`/static/uploads/post/${e.id}/${e.image}`,[e.image.startsWith("/")?e.image:`/static/uploads/post/${e.id}/${e.image}`])},onError:a=>{a.target.src="/static/uploads/avatar/system/avatar.png"}})}),e.video&&t.jsx(s,{sx:{height:250,mt:1,backgroundColor:"#111",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},component:c,to:`/post/${e.id}`,children:t.jsx("video",{src:e.video.startsWith("/")?e.video:`/static/uploads/post/${e.id}/${e.video}`,style:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"},onError:a=>{a.target.src="/static/uploads/avatar/system/avatar.png"}})}),t.jsxs(s,{sx:{display:"flex",alignItems:"center",p:2,gap:2},children:[t.jsxs(s,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(W,{size:"small",sx:{mr:.5},children:t.jsx(ge,{fontSize:"small"})}),t.jsx(n,{variant:"body2",children:e.likes||e.likes_count||0})]}),t.jsxs(s,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(W,{size:"small",sx:{mr:.5},children:t.jsx(fe,{fontSize:"small"})}),t.jsx(n,{variant:"body2",children:e.comments||e.comments_count||e.total_comments||0})]}),t.jsx(w,{variant:"text",size:"small",component:c,to:`/post/${e.id}`,sx:{ml:"auto",textTransform:"none",borderRadius:"20px"},children:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C"})]})]},e.id))})]})]})}),t.jsx(V,{value:m,index:1,children:S.length===0?t.jsxs(Y,{children:[t.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:g?"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u044B":"\u0420\u0435\u043A\u043E\u043C\u0435\u043D\u0434\u0443\u0435\u043C\u044B\u0435 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438"}),g&&t.jsx(n,{variant:"body2",color:"text.secondary",children:"\u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043F\u043E\u0438\u0441\u043A\u043E\u0432\u044B\u0439 \u0437\u0430\u043F\u0440\u043E\u0441"})]}):t.jsxs(ce,{sx:{borderRadius:2,background:`linear-gradient(145deg, ${j.paperColor} 0%, rgba(26, 26, 26, 0.9) 100%)`,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},children:[t.jsx(pe,{children:S.map((e,a)=>t.jsxs(be,{decoration:e.decoration,component:U.div,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*a},onClick:()=>d(`/profile/${e.username}`),children:[e.decoration?.item_path&&(()=>{const[r,...u]=e.decoration.item_path.split(";"),i=u.reduce((f,p)=>{const[x,h]=p.split(":").map(C=>C.trim());if(x==="height"){const C=parseInt(h);if(!isNaN(C))return{...f,[x]:C/2+"px"}}return{...f,[x]:h}},{});return t.jsx(ve,{src:r,style:i,alt:""})})(),t.jsxs(s,{sx:{position:"relative",zIndex:2,display:"flex",alignItems:"center",width:"100%"},children:[t.jsx(R,{src:e.photo&&e.photo!=="avatar.png"?e.photo.startsWith("/")?e.photo:`/static/uploads/avatar/${e.id}/${e.photo}`:"/static/uploads/avatar/system/avatar.png",alt:e.name,component:c,to:`/profile/${e.username}`,sx:{width:50,height:50,marginRight:2,border:"2px solid #D0BCFF"},onError:r=>{r.target.onerror=null,r.target.src="/static/uploads/avatar/system/avatar.png"}}),t.jsxs(s,{sx:{flex:1},children:[t.jsxs(s,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(n,{component:c,to:`/profile/${e.username}`,variant:"subtitle1",sx:{fontWeight:"bold",textDecoration:"none",color:"text.primary","&:hover":{textDecoration:"underline"}},children:e.name}),e.verification_status==="verified"&&t.jsx(ue,{sx:{fontSize:16,ml:.5,color:"#D0BCFF"}})]}),t.jsxs(n,{variant:"body2",color:"text.secondary",children:["@",e.username]})]}),b&&e.id!==e?.id&&t.jsx(w,{variant:"outlined",size:"small",color:"primary",onClick:r=>{r.stopPropagation(),ie(e.id)},startIcon:y[e.id]?t.jsx(he,{}):t.jsx(me,{}),sx:{borderRadius:6,textTransform:"none",borderColor:y[e.id]?"rgba(255, 255, 255, 0.2)":"#D0BCFF",color:y[e.id]?"text.secondary":"#D0BCFF",zIndex:2},children:y[e.id]?"\u041E\u0442\u043F\u0438\u0441\u0430\u0442\u044C\u0441\u044F":"\u041F\u043E\u0434\u043F\u0438\u0441\u0430\u0442\u044C\u0441\u044F"})]})]},e.id))}),Z&&t.jsx(s,{sx:{display:"flex",justifyContent:"center",p:2},children:t.jsx(w,{variant:"outlined",color:"primary",onClick:ne,disabled:I,sx:{borderRadius:6,textTransform:"none"},children:I?t.jsx(A,{size:24}):"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0435\u0449\u0435"})})]})}),t.jsx(V,{value:m,index:2,children:D.length===0?t.jsxs(Y,{children:[t.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"\u041F\u043E\u0441\u0442\u044B \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u044B"}),t.jsx(n,{variant:"body2",color:"text.secondary",children:"\u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043F\u043E\u0438\u0441\u043A\u043E\u0432\u044B\u0439 \u0437\u0430\u043F\u0440\u043E\u0441"})]}):t.jsxs(s,{sx:{display:"flex",flexDirection:"column",gap:2},children:[D.map(e=>t.jsxs(xe,{sx:{display:"flex",flexDirection:"column",borderRadius:2,overflow:"hidden",textDecoration:"none",background:`linear-gradient(145deg, ${j.paperColor} 0%, rgba(26, 26, 26, 0.9) 100%)`,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",transition:"transform 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"}},children:[t.jsxs(s,{sx:{display:"flex",alignItems:"center",pt:2,px:2},children:[t.jsx(R,{src:e.user.photo&&e.user.photo!=="avatar.png"?e.user.photo.startsWith("/")?e.user.photo:`/static/uploads/avatar/${e.user.id}/${e.user.photo}`:"/static/uploads/avatar/system/avatar.png",alt:e.user.name,component:c,to:`/profile/${e.user.username}`,sx:{width:40,height:40,mr:1.5,border:"2px solid #D0BCFF"},onError:a=>{a.target.onerror=null,a.target.src="/static/uploads/avatar/system/avatar.png"}}),t.jsxs(s,{children:[t.jsx(n,{variant:"subtitle1",component:c,to:`/profile/${e.user.username}`,sx:{fontWeight:"bold",textDecoration:"none",color:"text.primary","&:hover":{textDecoration:"underline"}},children:e.user.name}),t.jsxs(n,{variant:"caption",color:"text.secondary",component:c,to:`/profile/${e.user.username}`,sx:{textDecoration:"none"},children:["@",e.user.username]})]}),t.jsx(s,{sx:{ml:"auto"},children:t.jsx(n,{variant:"caption",color:"text.secondary",children:new Date(e.timestamp).toLocaleDateString()})})]}),t.jsx(s,{sx:{px:2,pt:1.5,pb:e.image||e.video?0:1},children:t.jsx(n,{variant:"body2",component:c,to:`/post/${e.id}`,sx:{mb:1.5,display:"block",textDecoration:"none",color:"text.primary",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:3,WebkitBoxOrient:"vertical"},children:e.content})}),e.image&&t.jsx(s,{sx:{position:"relative",mt:1,cursor:"pointer"},component:c,to:`/post/${e.id}`,children:t.jsx("img",{src:e.image.startsWith("/")?e.image:`/static/uploads/post/${e.id}/${e.image}`,alt:"Post image",style:{width:"100%",height:"250px",objectFit:"cover",backgroundColor:"#111"},onClick:a=>{a.preventDefault(),le(e.image.startsWith("/")?e.image:`/static/uploads/post/${e.id}/${e.image}`,[e.image.startsWith("/")?e.image:`/static/uploads/post/${e.id}/${e.image}`])},onError:a=>{a.target.src="/static/uploads/avatar/system/avatar.png"}})}),e.video&&t.jsx(s,{sx:{height:250,mt:1,backgroundColor:"#111",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},component:c,to:`/post/${e.id}`,children:t.jsx("video",{src:e.video.startsWith("/")?e.video:`/static/uploads/post/${e.id}/${e.video}`,style:{maxHeight:"100%",maxWidth:"100%",objectFit:"contain"},onError:a=>{a.target.src="/static/uploads/avatar/system/avatar.png"}})}),t.jsxs(s,{sx:{display:"flex",alignItems:"center",p:2,gap:2},children:[t.jsxs(s,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(W,{size:"small",sx:{mr:.5},children:t.jsx(ge,{fontSize:"small"})}),t.jsx(n,{variant:"body2",children:e.likes||e.likes_count||0})]}),t.jsxs(s,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(W,{size:"small",sx:{mr:.5},children:t.jsx(fe,{fontSize:"small"})}),t.jsx(n,{variant:"body2",children:e.comments||e.comments_count||e.total_comments||0})]}),t.jsx(w,{variant:"text",size:"small",component:c,to:`/post/${e.id}`,sx:{ml:"auto",textTransform:"none",borderRadius:"20px"},children:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C"})]})]},e.id)),ee&&t.jsx(s,{sx:{display:"flex",justifyContent:"center",p:2},children:t.jsx(w,{variant:"outlined",color:"primary",onClick:ne,disabled:I,sx:{borderRadius:6,textTransform:"none"},children:I?t.jsx(A,{size:24}):"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0435\u0449\u0435"})})]})})]}):t.jsx(s,{sx:{display:"flex",justifyContent:"center",mt:4},children:t.jsx(A,{})}),t.jsx(He,{isOpen:Se,onClose:()=>{se(!1)},images:We,initialIndex:Ie})]})};export{Ke as default};

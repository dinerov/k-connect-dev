import{b as I,g as R,j as e,h as z,i as d,T as l,P as M,A,k as O,l as m,m as p,F,n as C,o as q}from"./vendor-mui.08p3AH88.js";import{u as T,d as U,r as c}from"./vendor-router.BRqU_Zs2.js";import{C as E,a as L}from"./index.CdVNWeFt.js";import{m as g}from"./vendor.CL98q8z6.js";import"./vendor-react.DF-_cTkv.js";const P=({setUser:k})=>{const D=I(),i=R(D.breakpoints.down("sm")),w=T(),b=U(),[n,f]=c.useState({name:"",interests:"",about:"",agree_terms:!1,agree_privacy:!1,chat_id:""}),[y,B]=c.useState(null),[_,S]=c.useState(null),[j,v]=c.useState(!1),[u,a]=c.useState("");c.useEffect(()=>{const s=new URLSearchParams(b.search).get("chat_id"),t=localStorage.getItem("k-connect-chat-id"),r=s||t||"";r&&f(o=>({...o,chat_id:r}))},[b.search]);const h=s=>{const{name:t,value:r,checked:o}=s.target,x=t==="agree_terms"||t==="agree_privacy"?o:r;f(W=>({...W,[t]:x})),a("")};return e.jsxs(z,{disableGutters:!0,maxWidth:!1,sx:{display:"flex",minHeight:"100vh",width:"100%",overflow:"hidden",position:"relative"},children:[!i&&e.jsxs(d,{sx:{flex:"0 0 45%",background:"linear-gradient(135deg, rgba(20, 20, 30, 1) 0%, rgba(40, 40, 60, 0.95) 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",p:6},children:[e.jsx(d,{sx:{position:"absolute",width:"200%",height:"200%",top:"-50%",left:"-50%",background:"radial-gradient(circle, rgba(208, 188, 255, 0.05) 0%, rgba(208, 188, 255, 0) 70%)",zIndex:0}}),e.jsx(g.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.7,delay:.2},style:{position:"relative",zIndex:1},children:e.jsx("img",{src:"/static/icons/clear-logonew.svg",alt:"\u041A-\u041A\u043E\u043D\u043D\u0435\u043A\u0442 \u041B\u043E\u0433\u043E",style:{width:180,marginBottom:40}})}),e.jsxs(g.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.5},style:{position:"relative",zIndex:1,textAlign:"center"},children:[e.jsxs(l,{variant:"h3",sx:{fontWeight:700,mb:2},children:[e.jsx("span",{style:{color:"#D0BCFF"},children:"\u041A"}),"-\u041A\u041E\u041D\u041D\u0415\u041A\u0422"]}),e.jsx(l,{variant:"h6",color:"text.secondary",sx:{maxWidth:400},children:"\u0420\u0430\u0441\u0441\u043A\u0430\u0436\u0438\u0442\u0435 \u043E \u0441\u0435\u0431\u0435 \u0438 \u0441\u0442\u0430\u043D\u044C\u0442\u0435 \u0447\u0430\u0441\u0442\u044C\u044E \u043D\u0430\u0448\u0435\u0433\u043E \u0441\u043E\u043E\u0431\u0449\u0435\u0441\u0442\u0432\u0430"})]}),e.jsx(d,{sx:{position:"absolute",bottom:40,left:0,right:0,display:"flex",justifyContent:"center",gap:2},children:[...Array(3)].map((s,t)=>e.jsx(g.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.4,delay:.8+.2*t},children:e.jsx(d,{sx:{width:12+4*t,height:12+4*t,borderRadius:"50%",background:`rgba(208, 188, 255, ${.6-.15*t})`}})},t))})]}),e.jsx(d,{sx:{flex:i?1:"0 0 55%",display:"flex",alignItems:"center",justifyContent:"center",p:0,background:i?"linear-gradient(135deg, rgba(20, 20, 30, 1) 0%, rgba(40, 40, 60, 0.95) 100%)":"transparent"},children:e.jsxs(g.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",padding:i?"16px":"40px"},children:[i&&e.jsxs(d,{sx:{position:"absolute",top:"24px",left:0,width:"100%",textAlign:"center"},children:[e.jsx("img",{src:"/static/icons/clear-logonew.svg",alt:"\u041A-\u041A\u043E\u043D\u043D\u0435\u043A\u0442 \u041B\u043E\u0433\u043E",style:{width:80,marginBottom:12}}),e.jsxs(l,{variant:"h5",component:"h1",sx:{fontWeight:700},children:[e.jsx("span",{style:{color:"#D0BCFF"},children:"\u041A"}),"-\u041A\u041E\u041D\u041D\u0415\u041A\u0422"]})]}),e.jsxs(M,{elevation:i?0:6,sx:{p:i?3:4,width:"100%",maxWidth:"480px",borderRadius:4,background:i?"transparent":"rgba(30, 30, 40, 0.85)",backdropFilter:"blur(10px)",border:i?"none":"1px solid rgba(255, 255, 255, 0.1)",mt:i?"140px":0,overflowY:"auto",maxHeight:i?"calc(100vh - 200px)":"80vh",display:"flex",flexDirection:"column"},children:[e.jsx(l,{variant:"h5",component:"h2",sx:{mb:1,fontWeight:600},children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0438\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"\u0420\u0430\u0441\u0441\u043A\u0430\u0436\u0438\u0442\u0435 \u043E \u0441\u0435\u0431\u0435 \u0438 \u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u0441\u0432\u043E\u0439 \u043F\u0440\u043E\u0444\u0438\u043B\u044C"}),u&&e.jsx(A,{severity:"error",sx:{mb:3,borderRadius:2,"& .MuiAlert-icon":{alignItems:"center"}},children:u?u.toString():"\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u0430"}),e.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),n.name?n.agree_terms&&n.agree_privacy||(a("\u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0441\u043E\u0433\u043B\u0430\u0441\u0438\u0442\u044C\u0441\u044F \u0441 \u043F\u0440\u0430\u0432\u0438\u043B\u0430\u043C\u0438 \u0438 \u043F\u043E\u043B\u0438\u0442\u0438\u043A\u043E\u0439 \u043A\u043E\u043D\u0444\u0438\u0434\u0435\u043D\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u0438"),0):(a("\u0418\u043C\u044F \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C"),0)){v(!0),a("");try{const t=localStorage.getItem("k-connect-chat-id"),r=new FormData;Object.keys(n).forEach(x=>{r.append(x,n[x])}),t&&!n.chat_id&&r.append("chat_id",t),y&&r.append("photo",y);for(let x of r.entries());const o=await L.registerProfile(r);o.success&&o.user?(k(o.user),localStorage.removeItem("k-connect-chat-id"),w("/",{replace:!0})):o.error&&a(o.error)}catch(t){if(t.response&&t.response.data&&t.response.data.error){const r=t.response.data.error;r.includes("chat_id is required")?a("\u041E\u0448\u0438\u0431\u043A\u0430 \u0438\u0434\u0435\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u043F\u0435\u0440\u0435\u0439\u0442\u0438 \u043F\u043E \u0441\u0441\u044B\u043B\u043A\u0435 \u0438\u0437 \u043F\u0438\u0441\u044C\u043C\u0430 \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E \u0438\u043B\u0438 \u043E\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044C \u0432 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0443."):r.includes("\u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442")?a("\u041F\u0440\u043E\u0444\u0438\u043B\u044C \u0441 \u044D\u0442\u0438\u043C\u0438 \u0434\u0430\u043D\u043D\u044B\u043C\u0438 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0432\u043E\u0439\u0442\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043C\u0443."):a(r)}else a("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438 \u043F\u0440\u043E\u0444\u0438\u043B\u044F. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u043F\u043E\u0437\u0436\u0435.")}finally{v(!1)}}},style:{width:"100%"},children:[e.jsxs(d,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mb:3},children:[e.jsx(O,{src:_,sx:{width:100,height:100,mb:2,border:"2px solid #D0BCFF"}}),e.jsxs(m,{variant:"outlined",component:"label",startIcon:e.jsx(E,{}),sx:{borderColor:"#D0BCFF",color:"#D0BCFF",borderRadius:2,"&:hover":{borderColor:"#B69DF8",backgroundColor:"rgba(208, 188, 255, 0.04)"}},children:["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0430\u0432\u0430\u0442\u0430\u0440",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:s=>{const t=s.target.files[0];t&&(t.size>5242880?a("\u0420\u0430\u0437\u043C\u0435\u0440 \u0444\u0430\u0439\u043B\u0430 \u043D\u0435 \u0434\u043E\u043B\u0436\u0435\u043D \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 5MB"):t.type.startsWith("image/")?(B(t),S(URL.createObjectURL(t)),a(null)):a("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435"))}})]})]}),e.jsx(p,{margin:"normal",required:!0,fullWidth:!0,id:"name",label:"\u0412\u0430\u0448\u0435 \u0438\u043C\u044F",name:"name",autoFocus:!0,value:n.name,onChange:h,variant:"outlined",sx:{mb:2.5,"& .MuiOutlinedInput-root":{borderRadius:2}}}),e.jsx(p,{margin:"normal",fullWidth:!0,id:"interests",label:"\u0418\u043D\u0442\u0435\u0440\u0435\u0441\u044B",name:"interests",value:n.interests,onChange:h,variant:"outlined",placeholder:"\u041C\u0443\u0437\u044B\u043A\u0430, \u0441\u043F\u043E\u0440\u0442, \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435...",sx:{mb:2.5,"& .MuiOutlinedInput-root":{borderRadius:2}}}),e.jsx(p,{margin:"normal",fullWidth:!0,id:"about",label:"\u041E \u0441\u0435\u0431\u0435",name:"about",value:n.about,onChange:h,variant:"outlined",multiline:!0,rows:4,placeholder:"\u0420\u0430\u0441\u0441\u043A\u0430\u0436\u0438\u0442\u0435 \u043D\u0435\u043C\u043D\u043E\u0433\u043E \u043E \u0441\u0435\u0431\u0435...",sx:{mb:3,"& .MuiOutlinedInput-root":{borderRadius:2}}}),e.jsx(l,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"\u041F\u0440\u0430\u0432\u043E\u0432\u044B\u0435 \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"}),e.jsx(F,{control:e.jsx(C,{name:"agree_terms",checked:n.agree_terms,onChange:h,color:"primary",required:!0,sx:{color:"#D0BCFF","&.Mui-checked":{color:"#D0BCFF"}}}),label:e.jsxs(l,{variant:"body2",children:["\u042F \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E"," ",e.jsx(m,{href:"/terms-of-service",target:"_blank",sx:{color:"#D0BCFF",p:0,minWidth:"auto",fontWeight:"normal",textTransform:"none",fontSize:"inherit","&:hover":{background:"transparent",textDecoration:"underline"}},children:"\u041F\u0440\u0430\u0432\u0438\u043B\u0430 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u044F"})]}),sx:{mb:1}}),e.jsx(F,{control:e.jsx(C,{name:"agree_privacy",checked:n.agree_privacy,onChange:h,color:"primary",required:!0,sx:{color:"#D0BCFF","&.Mui-checked":{color:"#D0BCFF"}}}),label:e.jsxs(l,{variant:"body2",children:["\u042F \u0441\u043E\u0433\u043B\u0430\u0441\u0435\u043D \u0441"," ",e.jsx(m,{href:"/privacy",target:"_blank",sx:{color:"#D0BCFF",p:0,minWidth:"auto",fontWeight:"normal",textTransform:"none",fontSize:"inherit","&:hover":{background:"transparent",textDecoration:"underline"}},children:"\u041F\u043E\u043B\u0438\u0442\u0438\u043A\u043E\u0439 \u043A\u043E\u043D\u0444\u0438\u0434\u0435\u043D\u0446\u0438\u0430\u043B\u044C\u043D\u043E\u0441\u0442\u0438"})]}),sx:{mb:3}}),e.jsx(m,{type:"submit",fullWidth:!0,variant:"contained",size:"large",sx:{py:1.5,borderRadius:2,fontSize:"1rem",textTransform:"none",background:"linear-gradient(90deg, #B69DF8 0%, #D0BCFF 100%)",boxShadow:"0 4px 12px rgba(182, 157, 248, 0.3)","&:hover":{background:"linear-gradient(90deg, #D0BCFF 0%, #E9DDFF 100%)",boxShadow:"0 6px 16px rgba(182, 157, 248, 0.4)"},mb:2},disabled:j,children:j?e.jsx(q,{size:24,color:"inherit"}):"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u0440\u043E\u0444\u0438\u043B\u044C"})]})]})]})})]})};export{P as default};
